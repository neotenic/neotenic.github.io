protobowl_app_build = 'Sun Nov 17 2013 18:56:11 GMT-0500 (EST)';

function E(e){"\n"==e[e.length-1]&&(e=e.substring(0,e.length-1)),console.log((performance.now()/1e3).toFixed(3)+": "+e)}var io="undefined"==typeof module?{}:module.exports;!function(){if(function(e,t){var o=e;o.version="0.9.11",o.protocol=1,o.transports=[],o.j=[],o.sockets={},o.connect=function(e,n){var i,r,a=o.util.parseUri(e);t&&t.location&&(a.protocol=a.protocol||t.location.protocol.slice(0,-1),a.host=a.host||(t.document?t.document.domain:t.location.hostname),a.port=a.port||t.location.port),i=o.util.uniqueUri(a);var s={host:a.host,secure:"https"==a.protocol,port:a.port||("https"==a.protocol?443:80),query:a.query||""};return o.util.merge(s,n),(s["force new connection"]||!o.sockets[i])&&(r=new o.Socket(s)),!s["force new connection"]&&r&&(o.sockets[i]=r),r=r||o.sockets[i],r.of(a.path.length>1?a.path:"")}}("object"==typeof module?module.exports:io,this),function(e,t){var o=e.util={},n=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,i=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];o.parseUri=function(e){for(var t=n.exec(e||""),o={},r=14;r--;)o[i[r]]=t[r]||"";return o},o.uniqueUri=function(e){var o=e.protocol,n=e.host,i=e.port;return"document"in t?(n=n||document.domain,i=i||("https"==o&&"https:"!==document.location.protocol?443:document.location.port)):(n=n||"localhost",i||"https"!=o||(i=443)),(o||"http")+"://"+n+":"+(i||80)},o.query=function(e,t){var n=o.chunkQuery(e||""),i=[];o.merge(n,o.chunkQuery(t||""));for(var r in n)n.hasOwnProperty(r)&&i.push(r+"="+n[r]);return i.length?"?"+i.join("&"):""},o.chunkQuery=function(e){for(var t,o={},n=e.split("&"),i=0,r=n.length;r>i;++i)t=n[i].split("="),t[0]&&(o[t[0]]=t[1]);return o};var r=!1;o.load=function(e){return"document"in t&&"complete"===document.readyState||r?e():(o.on(t,"load",e,!1),void 0)},o.on=function(e,t,o,n){e.attachEvent?e.attachEvent("on"+t,o):e.addEventListener&&e.addEventListener(t,o,n)},o.request=function(e){if(e&&"undefined"!=typeof XDomainRequest&&!o.ua.hasCORS)return new XDomainRequest;if("undefined"!=typeof XMLHttpRequest&&(!e||o.ua.hasCORS))return new XMLHttpRequest;if(!e)try{return new(window[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}return null},"undefined"!=typeof window&&o.load(function(){r=!0}),o.defer=function(e){return o.ua.webkit&&"undefined"==typeof importScripts?(o.load(function(){setTimeout(e,100)}),void 0):e()},o.merge=function(e,t,n,i){var r,a=i||[],s="undefined"==typeof n?2:n;for(r in t)t.hasOwnProperty(r)&&o.indexOf(a,r)<0&&("object"==typeof e[r]&&s?o.merge(e[r],t[r],s-1,a):(e[r]=t[r],a.push(t[r])));return e},o.mixin=function(e,t){o.merge(e.prototype,t.prototype)},o.inherit=function(e,t){function o(){}o.prototype=t.prototype,e.prototype=new o},o.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},o.intersect=function(e,t){for(var n=[],i=e.length>t.length?e:t,r=e.length>t.length?t:e,a=0,s=r.length;s>a;a++)~o.indexOf(i,r[a])&&n.push(r[a]);return n},o.indexOf=function(e,t,o){for(var n=e.length,o=0>o?0>o+n?0:o+n:o||0;n>o&&e[o]!==t;o++);return o>=n?-1:o},o.toArray=function(e){for(var t=[],o=0,n=e.length;n>o;o++)t.push(e[o]);return t},o.ua={},o.ua.hasCORS="undefined"!=typeof XMLHttpRequest&&function(){try{var e=new XMLHttpRequest}catch(t){return!1}return void 0!=e.withCredentials}(),o.ua.webkit="undefined"!=typeof navigator&&/webkit/i.test(navigator.userAgent),o.ua.iDevice="undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)}("undefined"!=typeof io?io:module.exports,this),function(e,t){function o(){}e.EventEmitter=o,o.prototype.on=function(e,o){return this.$events||(this.$events={}),this.$events[e]?t.util.isArray(this.$events[e])?this.$events[e].push(o):this.$events[e]=[this.$events[e],o]:this.$events[e]=o,this},o.prototype.addListener=o.prototype.on,o.prototype.once=function(e,t){function o(){n.removeListener(e,o),t.apply(this,arguments)}var n=this;return o.listener=t,this.on(e,o),this},o.prototype.removeListener=function(e,o){if(this.$events&&this.$events[e]){var n=this.$events[e];if(t.util.isArray(n)){for(var i=-1,r=0,a=n.length;a>r;r++)if(n[r]===o||n[r].listener&&n[r].listener===o){i=r;break}if(0>i)return this;n.splice(i,1),n.length||delete this.$events[e]}else(n===o||n.listener&&n.listener===o)&&delete this.$events[e]}return this},o.prototype.removeAllListeners=function(e){return void 0===e?(this.$events={},this):(this.$events&&this.$events[e]&&(this.$events[e]=null),this)},o.prototype.listeners=function(e){return this.$events||(this.$events={}),this.$events[e]||(this.$events[e]=[]),t.util.isArray(this.$events[e])||(this.$events[e]=[this.$events[e]]),this.$events[e]},o.prototype.emit=function(e){if(!this.$events)return!1;var o=this.$events[e];if(!o)return!1;var n=Array.prototype.slice.call(arguments,1);if("function"==typeof o)o.apply(this,n);else{if(!t.util.isArray(o))return!1;for(var i=o.slice(),r=0,a=i.length;a>r;r++)i[r].apply(this,n)}return!0}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(exports,nativeJSON){"use strict";function f(e){return 10>e?"0"+e:e}function date(e){return isFinite(e.valueOf())?e.getUTCFullYear()+"-"+f(e.getUTCMonth()+1)+"-"+f(e.getUTCDate())+"T"+f(e.getUTCHours())+":"+f(e.getUTCMinutes())+":"+f(e.getUTCSeconds())+"Z":null}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var o,n,i,r,a,s=gap,u=t[e];switch(u instanceof Date&&(u=date(e)),"function"==typeof rep&&(u=rep.call(t,e,u)),typeof u){case"string":return quote(u);case"number":return isFinite(u)?String(u):"null";case"boolean":case"null":return String(u);case"object":if(!u)return"null";if(gap+=indent,a=[],"[object Array]"===Object.prototype.toString.apply(u)){for(r=u.length,o=0;r>o;o+=1)a[o]=str(o,u)||"null";return i=0===a.length?"[]":gap?"[\n"+gap+a.join(",\n"+gap)+"\n"+s+"]":"["+a.join(",")+"]",gap=s,i}if(rep&&"object"==typeof rep)for(r=rep.length,o=0;r>o;o+=1)"string"==typeof rep[o]&&(n=rep[o],i=str(n,u),i&&a.push(quote(n)+(gap?": ":":")+i));else for(n in u)Object.prototype.hasOwnProperty.call(u,n)&&(i=str(n,u),i&&a.push(quote(n)+(gap?": ":":")+i));return i=0===a.length?"{}":gap?"{\n"+gap+a.join(",\n"+gap)+"\n"+s+"}":"{"+a.join(",")+"}",gap=s,i}}if(nativeJSON&&nativeJSON.parse)return exports.JSON={parse:nativeJSON.parse,stringify:nativeJSON.stringify};var JSON=exports.JSON={},cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;JSON.stringify=function(e,t,o){var n;if(gap="",indent="","number"==typeof o)for(n=0;o>n;n+=1)indent+=" ";else"string"==typeof o&&(indent=o);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})},JSON.parse=function(text,reviver){function walk(e,t){var o,n,i=e[t];if(i&&"object"==typeof i)for(o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n=walk(i,o),void 0!==n?i[o]=n:delete i[o]);return reviver.call(e,t,i)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof JSON?JSON:void 0),function(e,t){var o=e.parser={},n=o.packets=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],i=o.reasons=["transport not supported","client not handshaken","unauthorized"],r=o.advice=["reconnect"],a=t.JSON,s=t.util.indexOf;o.encodePacket=function(e){var t=s(n,e.type),o=e.id||"",u=e.endpoint||"",l=e.ack,c=null;switch(e.type){case"error":var h=e.reason?s(i,e.reason):"",d=e.advice?s(r,e.advice):"";(""!==h||""!==d)&&(c=h+(""!==d?"+"+d:""));break;case"message":""!==e.data&&(c=e.data);break;case"event":var f={name:e.name};e.args&&e.args.length&&(f.args=e.args),c=a.stringify(f);break;case"json":c=a.stringify(e.data);break;case"connect":e.qs&&(c=e.qs);break;case"ack":c=e.ackId+(e.args&&e.args.length?"+"+a.stringify(e.args):"")}var p=[t,o+("data"==l?"+":""),u];return null!==c&&void 0!==c&&p.push(c),p.join(":")},o.encodePayload=function(e){var t="";if(1==e.length)return e[0];for(var o=0,n=e.length;n>o;o++){var i=e[o];t+="�"+i.length+"�"+e[o]}return t};var u=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;o.decodePacket=function(e){var t=e.match(u);if(!t)return{};var o=t[2]||"",e=t[5]||"",s={type:n[t[1]],endpoint:t[4]||""};switch(o&&(s.id=o,s.ack=t[3]?"data":!0),s.type){case"error":var t=e.split("+");s.reason=i[t[0]]||"",s.advice=r[t[1]]||"";break;case"message":s.data=e||"";break;case"event":try{var l=a.parse(e);s.name=l.name,s.args=l.args}catch(c){}s.args=s.args||[];break;case"json":try{s.data=a.parse(e)}catch(c){}break;case"connect":s.qs=e||"";break;case"ack":var t=e.match(/^([0-9]+)(\+)?(.*)/);if(t&&(s.ackId=t[1],s.args=[],t[3]))try{s.args=t[3]?a.parse(t[3]):[]}catch(c){}break;case"disconnect":case"heartbeat":}return s},o.decodePayload=function(e){if("�"==e.charAt(0)){for(var t=[],n=1,i="";n<e.length;n++)"�"==e.charAt(n)?(t.push(o.decodePacket(e.substr(n+1).substr(0,i))),n+=Number(i)+1,i=""):i+=e.charAt(n);return t}return[o.decodePacket(e)]}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t){function o(e,t){this.socket=e,this.sessid=t}e.Transport=o,t.util.mixin(o,t.EventEmitter),o.prototype.heartbeats=function(){return!0},o.prototype.onData=function(e){if(this.clearCloseTimeout(),(this.socket.connected||this.socket.connecting||this.socket.reconnecting)&&this.setCloseTimeout(),""!==e){var o=t.parser.decodePayload(e);if(o&&o.length)for(var n=0,i=o.length;i>n;n++)this.onPacket(o[n])}return this},o.prototype.onPacket=function(e){return this.socket.setHeartbeatTimeout(),"heartbeat"==e.type?this.onHeartbeat():("connect"==e.type&&""==e.endpoint&&this.onConnect(),"error"==e.type&&"reconnect"==e.advice&&(this.isOpen=!1),this.socket.onPacket(e),this)},o.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var e=this;this.closeTimeout=setTimeout(function(){e.onDisconnect()},this.socket.closeTimeout)}},o.prototype.onDisconnect=function(){return this.isOpen&&this.close(),this.clearTimeouts(),this.socket.onDisconnect(),this},o.prototype.onConnect=function(){return this.socket.onConnect(),this},o.prototype.clearCloseTimeout=function(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null)},o.prototype.clearTimeouts=function(){this.clearCloseTimeout(),this.reopenTimeout&&clearTimeout(this.reopenTimeout)},o.prototype.packet=function(e){this.send(t.parser.encodePacket(e))},o.prototype.onHeartbeat=function(){this.packet({type:"heartbeat"})},o.prototype.onOpen=function(){this.isOpen=!0,this.clearCloseTimeout(),this.socket.onOpen()},o.prototype.onClose=function(){this.isOpen=!1,this.socket.onClose(),this.onDisconnect()},o.prototype.prepareUrl=function(){var e=this.socket.options;return this.scheme()+"://"+e.host+":"+e.port+"/"+e.resource+"/"+t.protocol+"/"+this.name+"/"+this.sessid},o.prototype.ready=function(e,t){t.call(this)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t,o){function n(e){if(this.options={port:80,secure:!1,document:"document"in o?document:!1,resource:"socket.io",transports:t.transports,"connect timeout":1e4,"try multiple transports":!0,reconnect:!0,"reconnection delay":500,"reconnection limit":1/0,"reopen delay":3e3,"max reconnection attempts":10,"sync disconnect on unload":!1,"auto connect":!0,"flash policy port":10843,manualFlush:!1},t.util.merge(this.options,e),this.connected=!1,this.open=!1,this.connecting=!1,this.reconnecting=!1,this.namespaces={},this.buffer=[],this.doBuffer=!1,this.options["sync disconnect on unload"]&&(!this.isXDomain()||t.util.ua.hasCORS)){var n=this;t.util.on(o,"beforeunload",function(){n.disconnectSync()},!1)}this.options["auto connect"]&&this.connect()}function i(){}e.Socket=n,t.util.mixin(n,t.EventEmitter),n.prototype.of=function(e){return this.namespaces[e]||(this.namespaces[e]=new t.SocketNamespace(this,e),""!==e&&this.namespaces[e].packet({type:"connect"})),this.namespaces[e]},n.prototype.publish=function(){this.emit.apply(this,arguments);var e;for(var t in this.namespaces)this.namespaces.hasOwnProperty(t)&&(e=this.of(t),e.$emit.apply(e,arguments))},n.prototype.handshake=function(e){function o(t){t instanceof Error?(n.connecting=!1,n.onError(t.message)):e.apply(null,t.split(":"))}var n=this,r=this.options,a=["http"+(r.secure?"s":"")+":/",r.host+":"+r.port,r.resource,t.protocol,t.util.query(this.options.query,"t="+ +new Date)].join("/");if(this.isXDomain()&&!t.util.ua.hasCORS){var s=document.getElementsByTagName("script")[0],u=document.createElement("script");u.src=a+"&jsonp="+t.j.length,s.parentNode.insertBefore(u,s),t.j.push(function(e){o(e),u.parentNode.removeChild(u)})}else{var l=t.util.request();l.open("GET",a,!0),this.isXDomain()&&(l.withCredentials=!0),l.onreadystatechange=function(){4==l.readyState&&(l.onreadystatechange=i,200==l.status?o(l.responseText):403==l.status?n.onError(l.responseText):(n.connecting=!1,!n.reconnecting&&n.onError(l.responseText)))},l.send(null)}},n.prototype.getTransport=function(e){for(var o,n=e||this.transports,i=0;o=n[i];i++)if(t.Transport[o]&&t.Transport[o].check(this)&&(!this.isXDomain()||t.Transport[o].xdomainCheck(this)))return new t.Transport[o](this,this.sessionid);return null},n.prototype.connect=function(e){if(this.connecting)return this;var o=this;return o.connecting=!0,this.handshake(function(n,i,r,a){function s(e){return o.transport&&o.transport.clearTimeouts(),o.transport=o.getTransport(e),o.transport?(o.transport.ready(o,function(){o.connecting=!0,o.publish("connecting",o.transport.name),o.transport.open(),o.options["connect timeout"]&&(o.connectTimeoutTimer=setTimeout(function(){if(!o.connected&&(o.connecting=!1,o.options["try multiple transports"])){for(var e=o.transports;e.length>0&&e.splice(0,1)[0]!=o.transport.name;);e.length?s(e):o.publish("connect_failed")}},o.options["connect timeout"]))}),void 0):o.publish("connect_failed")}o.sessionid=n,o.closeTimeout=1e3*r,o.heartbeatTimeout=1e3*i,o.transports||(o.transports=o.origTransports=a?t.util.intersect(a.split(","),o.options.transports):o.options.transports),o.setHeartbeatTimeout(),s(o.transports),o.once("connect",function(){clearTimeout(o.connectTimeoutTimer),e&&"function"==typeof e&&e()})}),this},n.prototype.setHeartbeatTimeout=function(){if(clearTimeout(this.heartbeatTimeoutTimer),!this.transport||this.transport.heartbeats()){var e=this;this.heartbeatTimeoutTimer=setTimeout(function(){e.transport.onClose()},this.heartbeatTimeout)}},n.prototype.packet=function(e){return this.connected&&!this.doBuffer?this.transport.packet(e):this.buffer.push(e),this},n.prototype.setBuffer=function(e){this.doBuffer=e,!e&&this.connected&&this.buffer.length&&(this.options.manualFlush||this.flushBuffer())},n.prototype.flushBuffer=function(){this.transport.payload(this.buffer),this.buffer=[]},n.prototype.disconnect=function(){return(this.connected||this.connecting)&&(this.open&&this.of("").packet({type:"disconnect"}),this.onDisconnect("booted")),this},n.prototype.disconnectSync=function(){var e=t.util.request(),o=["http"+(this.options.secure?"s":"")+":/",this.options.host+":"+this.options.port,this.options.resource,t.protocol,"",this.sessionid].join("/")+"/?disconnect=1";e.open("GET",o,!1),e.send(null),this.onDisconnect("booted")},n.prototype.isXDomain=function(){var e=o.location.port||("https:"==o.location.protocol?443:80);return this.options.host!==o.location.hostname||this.options.port!=e},n.prototype.onConnect=function(){this.connected||(this.connected=!0,this.connecting=!1,this.doBuffer||this.setBuffer(!1),this.emit("connect"))},n.prototype.onOpen=function(){this.open=!0},n.prototype.onClose=function(){this.open=!1,clearTimeout(this.heartbeatTimeoutTimer)},n.prototype.onPacket=function(e){this.of(e.endpoint).onPacket(e)},n.prototype.onError=function(e){e&&e.advice&&"reconnect"===e.advice&&(this.connected||this.connecting)&&(this.disconnect(),this.options.reconnect&&this.reconnect()),this.publish("error",e&&e.reason?e.reason:e)},n.prototype.onDisconnect=function(e){var t=this.connected,o=this.connecting;this.connected=!1,this.connecting=!1,this.open=!1,(t||o)&&(this.transport.close(),this.transport.clearTimeouts(),t&&(this.publish("disconnect",e),"booted"!=e&&this.options.reconnect&&!this.reconnecting&&this.reconnect()))},n.prototype.reconnect=function(){function e(){if(o.connected){for(var e in o.namespaces)o.namespaces.hasOwnProperty(e)&&""!==e&&o.namespaces[e].packet({type:"connect"});o.publish("reconnect",o.transport.name,o.reconnectionAttempts)}clearTimeout(o.reconnectionTimer),o.removeListener("connect_failed",t),o.removeListener("connect",t),o.reconnecting=!1,delete o.reconnectionAttempts,delete o.reconnectionDelay,delete o.reconnectionTimer,delete o.redoTransports,o.options["try multiple transports"]=i}function t(){return o.reconnecting?o.connected?e():o.connecting&&o.reconnecting?o.reconnectionTimer=setTimeout(t,1e3):(o.reconnectionAttempts++>=n?o.redoTransports?(o.publish("reconnect_failed"),e()):(o.on("connect_failed",t),o.options["try multiple transports"]=!0,o.transports=o.origTransports,o.transport=o.getTransport(),o.redoTransports=!0,o.connect()):(o.reconnectionDelay<r&&(o.reconnectionDelay*=2),o.connect(),o.publish("reconnecting",o.reconnectionDelay,o.reconnectionAttempts),o.reconnectionTimer=setTimeout(t,o.reconnectionDelay)),void 0):void 0}this.reconnecting=!0,this.reconnectionAttempts=0,this.reconnectionDelay=this.options["reconnection delay"];var o=this,n=this.options["max reconnection attempts"],i=this.options["try multiple transports"],r=this.options["reconnection limit"];this.options["try multiple transports"]=!1,this.reconnectionTimer=setTimeout(t,this.reconnectionDelay),this.on("connect",t)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t){function o(e,t){this.socket=e,this.name=t||"",this.flags={},this.json=new n(this,"json"),this.ackPackets=0,this.acks={}}function n(e,t){this.namespace=e,this.name=t}e.SocketNamespace=o,t.util.mixin(o,t.EventEmitter),o.prototype.$emit=t.EventEmitter.prototype.emit,o.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)},o.prototype.packet=function(e){return e.endpoint=this.name,this.socket.packet(e),this.flags={},this},o.prototype.send=function(e,t){var o={type:this.flags.json?"json":"message",data:e};return"function"==typeof t&&(o.id=++this.ackPackets,o.ack=!0,this.acks[o.id]=t),this.packet(o)},o.prototype.emit=function(e){var t=Array.prototype.slice.call(arguments,1),o=t[t.length-1],n={type:"event",name:e};return"function"==typeof o&&(n.id=++this.ackPackets,n.ack="data",this.acks[n.id]=o,t=t.slice(0,t.length-1)),n.args=t,this.packet(n)},o.prototype.disconnect=function(){return""===this.name?this.socket.disconnect():(this.packet({type:"disconnect"}),this.$emit("disconnect")),this},o.prototype.onPacket=function(e){function o(){n.packet({type:"ack",args:t.util.toArray(arguments),ackId:e.id})}var n=this;switch(e.type){case"connect":this.$emit("connect");break;case"disconnect":""===this.name?this.socket.onDisconnect(e.reason||"booted"):this.$emit("disconnect",e.reason);break;case"message":case"json":var i=["message",e.data];"data"==e.ack?i.push(o):e.ack&&this.packet({type:"ack",ackId:e.id}),this.$emit.apply(this,i);break;case"event":var i=[e.name].concat(e.args);"data"==e.ack&&i.push(o),this.$emit.apply(this,i);break;case"ack":this.acks[e.ackId]&&(this.acks[e.ackId].apply(this,e.args),delete this.acks[e.ackId]);break;case"error":e.advice?this.socket.onError(e):"unauthorized"==e.reason?this.$emit("connect_failed",e.reason):this.$emit("error",e.reason)}},n.prototype.send=function(){this.namespace.flags[this.name]=!0,this.namespace.send.apply(this.namespace,arguments)},n.prototype.emit=function(){this.namespace.flags[this.name]=!0,this.namespace.emit.apply(this.namespace,arguments)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t,o){function n(){t.Transport.apply(this,arguments)}e.websocket=n,t.util.inherit(n,t.Transport),n.prototype.name="websocket",n.prototype.open=function(){var e,n=t.util.query(this.socket.options.query),i=this;return e||(e=o.MozWebSocket||o.WebSocket),this.websocket=new e(this.prepareUrl()+n),this.websocket.onopen=function(){i.onOpen(),i.socket.setBuffer(!1)},this.websocket.onmessage=function(e){i.onData(e.data)},this.websocket.onclose=function(){i.onClose(),i.socket.setBuffer(!0)},this.websocket.onerror=function(e){i.onError(e)},this},n.prototype.send=t.util.ua.iDevice?function(e){var t=this;return setTimeout(function(){t.websocket.send(e)},0),this}:function(e){return this.websocket.send(e),this},n.prototype.payload=function(e){for(var t=0,o=e.length;o>t;t++)this.packet(e[t]);return this},n.prototype.close=function(){return this.websocket.close(),this},n.prototype.onError=function(e){this.socket.onError(e)},n.prototype.scheme=function(){return this.socket.options.secure?"wss":"ws"},n.check=function(){return"WebSocket"in o&&!("__addTask"in WebSocket)||"MozWebSocket"in o},n.xdomainCheck=function(){return!0},t.transports.push("websocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t){function o(){t.Transport.websocket.apply(this,arguments)}e.flashsocket=o,t.util.inherit(o,t.Transport.websocket),o.prototype.name="flashsocket",o.prototype.open=function(){var e=this,o=arguments;return WebSocket.__addTask(function(){t.Transport.websocket.prototype.open.apply(e,o)}),this},o.prototype.send=function(){var e=this,o=arguments;return WebSocket.__addTask(function(){t.Transport.websocket.prototype.send.apply(e,o)}),this},o.prototype.close=function(){return WebSocket.__tasks.length=0,t.Transport.websocket.prototype.close.call(this),this},o.prototype.ready=function(e,n){function i(){var t=e.options,i=t["flash policy port"],a=["http"+(t.secure?"s":"")+":/",t.host+":"+t.port,t.resource,"static/flashsocket","WebSocketMain"+(e.isXDomain()?"Insecure":"")+".swf"];o.loaded||("undefined"==typeof WEB_SOCKET_SWF_LOCATION&&(WEB_SOCKET_SWF_LOCATION=a.join("/")),843!==i&&WebSocket.loadFlashPolicyFile("xmlsocket://"+t.host+":"+i),WebSocket.__initialize(),o.loaded=!0),n.call(r)}var r=this;return document.body?i():(t.util.load(i),void 0)},o.check=function(){return"undefined"!=typeof WebSocket&&"__initialize"in WebSocket&&swfobject?swfobject.getFlashPlayerVersion().major>=10:!1},o.xdomainCheck=function(){return!0},"undefined"!=typeof window&&(WEB_SOCKET_DISABLE_AUTO_INITIALIZATION=!0),t.transports.push("flashsocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),"undefined"!=typeof window)var swfobject=function(){function e(){if(!H){try{var e=F.getElementsByTagName("body")[0].appendChild(y("span"));e.parentNode.removeChild(e)}catch(t){return}H=!0;for(var o=L.length,n=0;o>n;n++)L[n]()}}function t(e){H?e():L[L.length]=e}function o(e){if(typeof N.addEventListener!=A)N.addEventListener("load",e,!1);else if(typeof F.addEventListener!=A)F.addEventListener("load",e,!1);else if(typeof N.attachEvent!=A)g(N,"onload",e);else if("function"==typeof N.onload){var t=N.onload;N.onload=function(){t(),e()}}else N.onload=e}function n(){M?i():r()}function i(){var e=F.getElementsByTagName("body")[0],t=y(D);t.setAttribute("type",z);var o=e.appendChild(t);if(o){var n=0;!function(){if(typeof o.GetVariable!=A){var i=o.GetVariable("$version");i&&(i=i.split(" ")[1].split(","),Y.pv=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)])}else if(10>n)return n++,setTimeout(arguments.callee,10),void 0;e.removeChild(t),o=null,r()}()}else r()}function r(){var e=R.length;if(e>0)for(var t=0;e>t;t++){var o=R[t].id,n=R[t].callbackFn,i={success:!1,id:o};if(Y.pv[0]>0){var r=m(o);if(r)if(!b(R[t].swfVersion)||Y.wk&&Y.wk<312)if(R[t].expressInstall&&s()){var c={};c.data=R[t].expressInstall,c.width=r.getAttribute("width")||"0",c.height=r.getAttribute("height")||"0",r.getAttribute("class")&&(c.styleclass=r.getAttribute("class")),r.getAttribute("align")&&(c.align=r.getAttribute("align"));for(var h={},d=r.getElementsByTagName("param"),f=d.length,p=0;f>p;p++)"movie"!=d[p].getAttribute("name").toLowerCase()&&(h[d[p].getAttribute("name")]=d[p].getAttribute("value"));u(c,h,o,n)}else l(r),n&&n(i);else v(o,!0),n&&(i.success=!0,i.ref=a(o),n(i))}else if(v(o,!0),n){var y=a(o);y&&typeof y.SetVariable!=A&&(i.success=!0,i.ref=y),n(i)}}}function a(e){var t=null,o=m(e);if(o&&"OBJECT"==o.nodeName)if(typeof o.SetVariable!=A)t=o;else{var n=o.getElementsByTagName(D)[0];n&&(t=n)}return t}function s(){return!P&&b("6.0.65")&&(Y.win||Y.mac)&&!(Y.wk&&Y.wk<312)}function u(e,t,o,n){P=!0,C=n||null,E={success:!1,id:o};var i=m(o);if(i){"OBJECT"==i.nodeName?(_=c(i),$=null):(_=i,$=o),e.id=I,(typeof e.width==A||!/%$/.test(e.width)&&parseInt(e.width,10)<310)&&(e.width="310"),(typeof e.height==A||!/%$/.test(e.height)&&parseInt(e.height,10)<137)&&(e.height="137"),F.title=F.title.slice(0,47)+" - Flash Player Installation";var r=Y.ie&&Y.win?["Active"].concat("").join("X"):"PlugIn",a="MMredirectURL="+N.location.toString().replace(/&/g,"%26")+"&MMplayerType="+r+"&MMdoctitle="+F.title;if(typeof t.flashvars!=A?t.flashvars+="&"+a:t.flashvars=a,Y.ie&&Y.win&&4!=i.readyState){var s=y("div");o+="SWFObjectNew",s.setAttribute("id",o),i.parentNode.insertBefore(s,i),i.style.display="none",function(){4==i.readyState?i.parentNode.removeChild(i):setTimeout(arguments.callee,10)}()}h(e,t,o)}}function l(e){if(Y.ie&&Y.win&&4!=e.readyState){var t=y("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(c(e),t),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}else e.parentNode.replaceChild(c(e),e)}function c(e){var t=y("div");if(Y.win&&Y.ie)t.innerHTML=e.innerHTML;else{var o=e.getElementsByTagName(D)[0];if(o){var n=o.childNodes;if(n)for(var i=n.length,r=0;i>r;r++)1==n[r].nodeType&&"PARAM"==n[r].nodeName||8==n[r].nodeType||t.appendChild(n[r].cloneNode(!0))}}return t}function h(e,t,o){var n,i=m(o);if(Y.wk&&Y.wk<312)return n;if(i)if(typeof e.id==A&&(e.id=o),Y.ie&&Y.win){var r="";for(var a in e)e[a]!=Object.prototype[a]&&("data"==a.toLowerCase()?t.movie=e[a]:"styleclass"==a.toLowerCase()?r+=' class="'+e[a]+'"':"classid"!=a.toLowerCase()&&(r+=" "+a+'="'+e[a]+'"'));var s="";for(var u in t)t[u]!=Object.prototype[u]&&(s+='<param name="'+u+'" value="'+t[u]+'" />');i.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+r+">"+s+"</object>",U[U.length]=e.id,n=m(e.id)}else{var l=y(D);l.setAttribute("type",z);for(var c in e)e[c]!=Object.prototype[c]&&("styleclass"==c.toLowerCase()?l.setAttribute("class",e[c]):"classid"!=c.toLowerCase()&&l.setAttribute(c,e[c]));for(var h in t)t[h]!=Object.prototype[h]&&"movie"!=h.toLowerCase()&&d(l,h,t[h]);i.parentNode.replaceChild(l,i),n=l}return n}function d(e,t,o){var n=y("param");n.setAttribute("name",t),n.setAttribute("value",o),e.appendChild(n)}function f(e){var t=m(e);t&&"OBJECT"==t.nodeName&&(Y.ie&&Y.win?(t.style.display="none",function(){4==t.readyState?p(e):setTimeout(arguments.callee,10)}()):t.parentNode.removeChild(t))}function p(e){var t=m(e);if(t){for(var o in t)"function"==typeof t[o]&&(t[o]=null);t.parentNode.removeChild(t)}}function m(e){var t=null;try{t=F.getElementById(e)}catch(o){}return t}function y(e){return F.createElement(e)}function g(e,t,o){e.attachEvent(t,o),B[B.length]=[e,t,o]}function b(e){var t=Y.pv,o=e.split(".");return o[0]=parseInt(o[0],10),o[1]=parseInt(o[1],10)||0,o[2]=parseInt(o[2],10)||0,t[0]>o[0]||t[0]==o[0]&&t[1]>o[1]||t[0]==o[0]&&t[1]==o[1]&&t[2]>=o[2]?!0:!1}function w(e,t,o,n){if(!Y.ie||!Y.mac){var i=F.getElementsByTagName("head")[0];if(i){var r=o&&"string"==typeof o?o:"screen";if(n&&(x=null,T=null),!x||T!=r){var a=y("style");a.setAttribute("type","text/css"),a.setAttribute("media",r),x=i.appendChild(a),Y.ie&&Y.win&&typeof F.styleSheets!=A&&F.styleSheets.length>0&&(x=F.styleSheets[F.styleSheets.length-1]),T=r}Y.ie&&Y.win?x&&typeof x.addRule==D&&x.addRule(e,t):x&&typeof F.createTextNode!=A&&x.appendChild(F.createTextNode(e+" {"+t+"}"))}}}function v(e,t){if(W){var o=t?"visible":"hidden";H&&m(e)?m(e).style.visibility=o:w("#"+e,"visibility:"+o)}}function k(e){var t=/[\\\"<>\.;]/,o=null!=t.exec(e);return o&&typeof encodeURIComponent!=A?encodeURIComponent(e):e}var _,$,C,E,x,T,A="undefined",D="object",S="Shockwave Flash",O="ShockwaveFlash.ShockwaveFlash",z="application/x-shockwave-flash",I="SWFObjectExprInst",j="onreadystatechange",N=window,F=document,q=navigator,M=!1,L=[n],R=[],U=[],B=[],H=!1,P=!1,W=!0,Y=function(){var e=typeof F.getElementById!=A&&typeof F.getElementsByTagName!=A&&typeof F.createElement!=A,t=q.userAgent.toLowerCase(),o=q.platform.toLowerCase(),n=o?/win/.test(o):/win/.test(t),i=o?/mac/.test(o):/mac/.test(t),r=/webkit/.test(t)?parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,a=!1,s=[0,0,0],u=null;if(typeof q.plugins!=A&&typeof q.plugins[S]==D)u=q.plugins[S].description,!u||typeof q.mimeTypes!=A&&q.mimeTypes[z]&&!q.mimeTypes[z].enabledPlugin||(M=!0,a=!1,u=u.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),s[0]=parseInt(u.replace(/^(.*)\..*$/,"$1"),10),s[1]=parseInt(u.replace(/^.*\.(.*)\s.*$/,"$1"),10),s[2]=/[a-zA-Z]/.test(u)?parseInt(u.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof N[["Active"].concat("Object").join("X")]!=A)try{var l=new(window[["Active"].concat("Object").join("X")])(O);l&&(u=l.GetVariable("$version"),u&&(a=!0,u=u.split(" ")[1].split(","),s=[parseInt(u[0],10),parseInt(u[1],10),parseInt(u[2],10)]))}catch(c){}return{w3:e,pv:s,wk:r,ie:a,win:n,mac:i}}();return function(){Y.w3&&((typeof F.readyState!=A&&"complete"==F.readyState||typeof F.readyState==A&&(F.getElementsByTagName("body")[0]||F.body))&&e(),H||(typeof F.addEventListener!=A&&F.addEventListener("DOMContentLoaded",e,!1),Y.ie&&Y.win&&(F.attachEvent(j,function(){"complete"==F.readyState&&(F.detachEvent(j,arguments.callee),e())}),N==top&&function(){if(!H){try{F.documentElement.doScroll("left")}catch(t){return setTimeout(arguments.callee,0),void 0}e()}}()),Y.wk&&function(){return H?void 0:/loaded|complete/.test(F.readyState)?(e(),void 0):(setTimeout(arguments.callee,0),void 0)}(),o(e)))}(),function(){Y.ie&&Y.win&&window.attachEvent("onunload",function(){for(var e=B.length,t=0;e>t;t++)B[t][0].detachEvent(B[t][1],B[t][2]);for(var o=U.length,n=0;o>n;n++)f(U[n]);for(var i in Y)Y[i]=null;Y=null;for(var r in swfobject)swfobject[r]=null;swfobject=null})}(),{registerObject:function(e,t,o,n){if(Y.w3&&e&&t){var i={};i.id=e,i.swfVersion=t,i.expressInstall=o,i.callbackFn=n,R[R.length]=i,v(e,!1)}else n&&n({success:!1,id:e})},getObjectById:function(e){return Y.w3?a(e):void 0},embedSWF:function(e,o,n,i,r,a,l,c,d,f){var p={success:!1,id:o};Y.w3&&!(Y.wk&&Y.wk<312)&&e&&o&&n&&i&&r?(v(o,!1),t(function(){n+="",i+="";var t={};if(d&&typeof d===D)for(var m in d)t[m]=d[m];t.data=e,t.width=n,t.height=i;var y={};if(c&&typeof c===D)for(var g in c)y[g]=c[g];if(l&&typeof l===D)for(var w in l)typeof y.flashvars!=A?y.flashvars+="&"+w+"="+l[w]:y.flashvars=w+"="+l[w];if(b(r)){var k=h(t,y,o);
t.id==o&&v(o,!0),p.success=!0,p.ref=k}else{if(a&&s())return t.data=a,u(t,y,o,f),void 0;v(o,!0)}f&&f(p)})):f&&f(p)},switchOffAutoHideShow:function(){W=!1},ua:Y,getFlashPlayerVersion:function(){return{major:Y.pv[0],minor:Y.pv[1],release:Y.pv[2]}},hasFlashPlayerVersion:b,createSWF:function(e,t,o){return Y.w3?h(e,t,o):void 0},showExpressInstall:function(e,t,o,n){Y.w3&&s()&&u(e,t,o,n)},removeSWF:function(e){Y.w3&&f(e)},createCSS:function(e,t,o,n){Y.w3&&w(e,t,o,n)},addDomLoadEvent:t,addLoadEvent:o,getQueryParamValue:function(e){var t=F.location.search||F.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),null==e)return k(t);for(var o=t.split("&"),n=0;n<o.length;n++)if(o[n].substring(0,o[n].indexOf("="))==e)return k(o[n].substring(o[n].indexOf("=")+1))}return""},expressInstallCallback:function(){if(P){var e=m(I);e&&_&&(e.parentNode.replaceChild(_,e),$&&(v($,!0),Y.ie&&Y.win&&(_.style.display="block")),C&&C(E)),P=!1}}}}();!function(){if("undefined"!=typeof window&&!window.WebSocket){var e=window.console;if(e&&e.log&&e.error||(e={log:function(){},error:function(){}}),!swfobject.hasFlashPlayerVersion("10.0.0"))return e.error("Flash Player >= 10.0.0 is required."),void 0;"file:"==location.protocol&&e.error("WARNING: web-socket-js doesn't work in file:///... URL unless you set Flash Security Settings properly. Open the page via Web server i.e. http://..."),WebSocket=function(e,t,o,n,i){var r=this;r.__id=WebSocket.__nextId++,WebSocket.__instances[r.__id]=r,r.readyState=WebSocket.CONNECTING,r.bufferedAmount=0,r.__events={},t?"string"==typeof t&&(t=[t]):t=[],setTimeout(function(){WebSocket.__addTask(function(){WebSocket.__flash.create(r.__id,e,t,o||null,n||0,i||null)})},0)},WebSocket.prototype.send=function(e){if(this.readyState==WebSocket.CONNECTING)throw"INVALID_STATE_ERR: Web Socket connection has not been established";var t=WebSocket.__flash.send(this.__id,encodeURIComponent(e));return 0>t?!0:(this.bufferedAmount+=t,!1)},WebSocket.prototype.close=function(){this.readyState!=WebSocket.CLOSED&&this.readyState!=WebSocket.CLOSING&&(this.readyState=WebSocket.CLOSING,WebSocket.__flash.close(this.__id))},WebSocket.prototype.addEventListener=function(e,t){e in this.__events||(this.__events[e]=[]),this.__events[e].push(t)},WebSocket.prototype.removeEventListener=function(e,t){if(e in this.__events)for(var o=this.__events[e],n=o.length-1;n>=0;--n)if(o[n]===t){o.splice(n,1);break}},WebSocket.prototype.dispatchEvent=function(e){for(var t=this.__events[e.type]||[],o=0;o<t.length;++o)t[o](e);var n=this["on"+e.type];n&&n(e)},WebSocket.prototype.__handleEvent=function(e){"readyState"in e&&(this.readyState=e.readyState),"protocol"in e&&(this.protocol=e.protocol);var t;if("open"==e.type||"error"==e.type)t=this.__createSimpleEvent(e.type);else if("close"==e.type)t=this.__createSimpleEvent("close");else{if("message"!=e.type)throw"unknown event type: "+e.type;var o=decodeURIComponent(e.message);t=this.__createMessageEvent("message",o)}this.dispatchEvent(t)},WebSocket.prototype.__createSimpleEvent=function(e){if(document.createEvent&&window.Event){var t=document.createEvent("Event");return t.initEvent(e,!1,!1),t}return{type:e,bubbles:!1,cancelable:!1}},WebSocket.prototype.__createMessageEvent=function(e,t){if(document.createEvent&&window.MessageEvent&&!window.opera){var o=document.createEvent("MessageEvent");return o.initMessageEvent("message",!1,!1,t,null,null,window,null),o}return{type:e,data:t,bubbles:!1,cancelable:!1}},WebSocket.CONNECTING=0,WebSocket.OPEN=1,WebSocket.CLOSING=2,WebSocket.CLOSED=3,WebSocket.__flash=null,WebSocket.__instances={},WebSocket.__tasks=[],WebSocket.__nextId=0,WebSocket.loadFlashPolicyFile=function(e){WebSocket.__addTask(function(){WebSocket.__flash.loadManualPolicyFile(e)})},WebSocket.__initialize=function(){if(!WebSocket.__flash){if(WebSocket.__swfLocation&&(window.WEB_SOCKET_SWF_LOCATION=WebSocket.__swfLocation),!window.WEB_SOCKET_SWF_LOCATION)return e.error("[WebSocket] set WEB_SOCKET_SWF_LOCATION to location of WebSocketMain.swf"),void 0;var t=document.createElement("div");t.id="webSocketContainer",t.style.position="absolute",WebSocket.__isFlashLite()?(t.style.left="0px",t.style.top="0px"):(t.style.left="-100px",t.style.top="-100px");var o=document.createElement("div");o.id="webSocketFlash",t.appendChild(o),document.body.appendChild(t),swfobject.embedSWF(WEB_SOCKET_SWF_LOCATION,"webSocketFlash","1","1","10.0.0",null,null,{hasPriority:!0,swliveconnect:!0,allowScriptAccess:"always"},null,function(t){t.success||e.error("[WebSocket] swfobject.embedSWF failed")})}},WebSocket.__onFlashInitialized=function(){setTimeout(function(){WebSocket.__flash=document.getElementById("webSocketFlash"),WebSocket.__flash.setCallerUrl(location.href),WebSocket.__flash.setDebug(!!window.WEB_SOCKET_DEBUG);for(var e=0;e<WebSocket.__tasks.length;++e)WebSocket.__tasks[e]();WebSocket.__tasks=[]},0)},WebSocket.__onFlashEvent=function(){return setTimeout(function(){try{for(var t=WebSocket.__flash.receiveEvents(),o=0;o<t.length;++o)WebSocket.__instances[t[o].webSocketId].__handleEvent(t[o])}catch(n){e.error(n)}},0),!0},WebSocket.__log=function(t){e.log(decodeURIComponent(t))},WebSocket.__error=function(t){e.error(decodeURIComponent(t))},WebSocket.__addTask=function(e){WebSocket.__flash?e():WebSocket.__tasks.push(e)},WebSocket.__isFlashLite=function(){if(!window.navigator||!window.navigator.mimeTypes)return!1;var e=window.navigator.mimeTypes["application/x-shockwave-flash"];return e&&e.enabledPlugin&&e.enabledPlugin.filename?e.enabledPlugin.filename.match(/flashlite/i)?!0:!1:!1},window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION||(window.addEventListener?window.addEventListener("load",function(){WebSocket.__initialize()},!1):window.attachEvent("onload",function(){WebSocket.__initialize()}))}}(),function(e,t,o){function n(e){e&&(t.Transport.apply(this,arguments),this.sendBuffer=[])}function i(){}e.XHR=n,t.util.inherit(n,t.Transport),n.prototype.open=function(){return this.socket.setBuffer(!1),this.onOpen(),this.get(),this.setCloseTimeout(),this},n.prototype.payload=function(e){for(var o=[],n=0,i=e.length;i>n;n++)o.push(t.parser.encodePacket(e[n]));this.send(t.parser.encodePayload(o))},n.prototype.send=function(e){return this.post(e),this},n.prototype.post=function(e){function t(){4==this.readyState&&(this.onreadystatechange=i,r.posting=!1,200==this.status?r.socket.setBuffer(!1):r.onClose())}function n(){this.onload=i,r.socket.setBuffer(!1)}var r=this;this.socket.setBuffer(!0),this.sendXHR=this.request("POST"),o.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=n:this.sendXHR.onreadystatechange=t,this.sendXHR.send(e)},n.prototype.close=function(){return this.onClose(),this},n.prototype.request=function(e){var o=t.util.request(this.socket.isXDomain()),n=t.util.query(this.socket.options.query,"t="+ +new Date);if(o.open(e||"GET",this.prepareUrl()+n,!0),"POST"==e)try{o.setRequestHeader?o.setRequestHeader("Content-type","text/plain;charset=UTF-8"):o.contentType="text/plain"}catch(i){}return o},n.prototype.scheme=function(){return this.socket.options.secure?"https":"http"},n.check=function(e,n){try{var i=t.util.request(n),r=o.XDomainRequest&&i instanceof XDomainRequest,a=e&&e.options&&e.options.secure?"https:":"http:",s=o.location&&a!=o.location.protocol;if(i&&(!r||!s))return!0}catch(u){}return!1},n.xdomainCheck=function(e){return n.check(e,!0)}}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t){function o(){t.Transport.XHR.apply(this,arguments)}e.htmlfile=o,t.util.inherit(o,t.Transport.XHR),o.prototype.name="htmlfile",o.prototype.get=function(){this.doc=new(window[["Active"].concat("Object").join("X")])("htmlfile"),this.doc.open(),this.doc.write("<html></html>"),this.doc.close(),this.doc.parentWindow.s=this;var e=this.doc.createElement("div");e.className="socketio",this.doc.body.appendChild(e),this.iframe=this.doc.createElement("iframe"),e.appendChild(this.iframe);var o=this,n=t.util.query(this.socket.options.query,"t="+ +new Date);this.iframe.src=this.prepareUrl()+n,t.util.on(window,"unload",function(){o.destroy()})},o.prototype._=function(e,t){this.onData(e);try{var o=t.getElementsByTagName("script")[0];o.parentNode.removeChild(o)}catch(n){}},o.prototype.destroy=function(){if(this.iframe){try{this.iframe.src="about:blank"}catch(e){}this.doc=null,this.iframe.parentNode.removeChild(this.iframe),this.iframe=null,CollectGarbage()}},o.prototype.close=function(){return this.destroy(),t.Transport.XHR.prototype.close.call(this)},o.check=function(e){if("undefined"!=typeof window&&["Active"].concat("Object").join("X")in window)try{var o=new(window[["Active"].concat("Object").join("X")])("htmlfile");return o&&t.Transport.XHR.check(e)}catch(n){}return!1},o.xdomainCheck=function(){return!1},t.transports.push("htmlfile")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t,o){function n(){t.Transport.XHR.apply(this,arguments)}function i(){}e["xhr-polling"]=n,t.util.inherit(n,t.Transport.XHR),t.util.merge(n,t.Transport.XHR),n.prototype.name="xhr-polling",n.prototype.heartbeats=function(){return!1},n.prototype.open=function(){var e=this;return t.Transport.XHR.prototype.open.call(e),!1},n.prototype.get=function(){function e(){4==this.readyState&&(this.onreadystatechange=i,200==this.status?(r.onData(this.responseText),r.get()):r.onClose())}function t(){this.onload=i,this.onerror=i,r.retryCounter=1,r.onData(this.responseText),r.get()}function n(){r.retryCounter++,!r.retryCounter||r.retryCounter>3?r.onClose():r.get()}if(this.isOpen){var r=this;this.xhr=this.request(),o.XDomainRequest&&this.xhr instanceof XDomainRequest?(this.xhr.onload=t,this.xhr.onerror=n):this.xhr.onreadystatechange=e,this.xhr.send(null)}},n.prototype.onClose=function(){if(t.Transport.XHR.prototype.onClose.call(this),this.xhr){this.xhr.onreadystatechange=this.xhr.onload=this.xhr.onerror=i;try{this.xhr.abort()}catch(e){}this.xhr=null}},n.prototype.ready=function(e,o){var n=this;t.util.defer(function(){o.call(n)})},t.transports.push("xhr-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t,o){function n(){t.Transport["xhr-polling"].apply(this,arguments),this.index=t.j.length;var e=this;t.j.push(function(t){e._(t)})}var i=o.document&&"MozAppearance"in o.document.documentElement.style;e["jsonp-polling"]=n,t.util.inherit(n,t.Transport["xhr-polling"]),n.prototype.name="jsonp-polling",n.prototype.post=function(e){function o(){n(),i.socket.setBuffer(!1)}function n(){i.iframe&&i.form.removeChild(i.iframe);try{a=document.createElement('<iframe name="'+i.iframeId+'">')}catch(e){a=document.createElement("iframe"),a.name=i.iframeId}a.id=i.iframeId,i.form.appendChild(a),i.iframe=a}var i=this,r=t.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);if(!this.form){var a,s=document.createElement("form"),u=document.createElement("textarea"),l=this.iframeId="socketio_iframe_"+this.index;s.className="socketio",s.style.position="absolute",s.style.top="0px",s.style.left="0px",s.style.display="none",s.target=l,s.method="POST",s.setAttribute("accept-charset","utf-8"),u.name="d",s.appendChild(u),document.body.appendChild(s),this.form=s,this.area=u}this.form.action=this.prepareUrl()+r,n(),this.area.value=t.JSON.stringify(e);try{this.form.submit()}catch(c){}this.iframe.attachEvent?a.onreadystatechange=function(){"complete"==i.iframe.readyState&&o()}:this.iframe.onload=o,this.socket.setBuffer(!0)},n.prototype.get=function(){var e=this,o=document.createElement("script"),n=t.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),o.async=!0,o.src=this.prepareUrl()+n,o.onerror=function(){e.onClose()};var r=document.getElementsByTagName("script")[0];r.parentNode.insertBefore(o,r),this.script=o,i&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},n.prototype._=function(e){return this.onData(e),this.isOpen&&this.get(),this},n.prototype.ready=function(e,o){var n=this;return i?(t.util.load(function(){o.call(n)}),void 0):o.call(this)},n.check=function(){return"document"in o},n.xdomainCheck=function(){return!0},t.transports.push("jsonp-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),"function"==typeof define&&define.amd&&define([],function(){return io})}(),jade=function(e){function t(e){return null!=e}return Array.isArray||(Array.isArray=function(e){return"[object Array]"==Object.prototype.toString.call(e)}),Object.keys||(Object.keys=function(e){var t=[];for(var o in e)e.hasOwnProperty(o)&&t.push(o);return t}),e.merge=function(e,o){var n=e["class"],i=o["class"];(n||i)&&(n=n||[],i=i||[],Array.isArray(n)||(n=[n]),Array.isArray(i)||(i=[i]),n=n.filter(t),i=i.filter(t),e["class"]=n.concat(i).join(" "));for(var r in o)"class"!=r&&(e[r]=o[r]);return e},e.attrs=function(t,o){var n=[],i=t.terse;delete t.terse;var r=Object.keys(t),a=r.length;if(a){n.push("");for(var s=0;a>s;++s){var u=r[s],l=t[u];"boolean"==typeof l||null==l?l&&(i?n.push(u):n.push(u+'="'+u+'"')):0==u.indexOf("data")&&"string"!=typeof l?n.push(u+"='"+JSON.stringify(l)+"'"):"class"==u&&Array.isArray(l)?n.push(u+'="'+e.escape(l.join(" "))+'"'):o&&o[u]?n.push(u+'="'+e.escape(l)+'"'):n.push(u+'="'+l+'"')}}return n.join(" ")},e.escape=function(e){return String(e).replace(/&(?!(\w+|\#\d+);)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},e.rethrow=function(e,t,o){if(!t)throw e;throw e.path=t,e.message=(t||"Jade")+":"+o+"\n"+e.message,e},e}({}),jade.settings=function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{})buf.push('<div class="span3 thumbnail"><h5><i class="icon-wrench"></i>Settings</h5><div style="text-align: center; padding-right: 4px; padding-left: 4px; padding-top: 4px"><div class="localsettings"><div class="expando"><div class="input-prepend"><span style="width:21px" title="Public name" rel="tooltip" class="generate-name add-on"><i class="icon-user"></i></span><input id="username" type="text" value="" disabled="disabled"/></div></div><div style="display:none" class="expando set-team"><div class="input-prepend"><span style="width:21px" title="Teams" rel="tooltip" class="add-on"><i class="icon-group"></i></span><select class="input teams"><option value="">Individual</option></select></div></div><div style="display:none" class="expando reset-score"><div class="input-prepend"><span style="width:21px" title="Reset my score" rel="tooltip" class="add-on"><i class="icon-trash"></i></span><button class="btn input score-reset">Reset My Score </button></div></div><div style="display:none" class="expando relinquish-command"><div class="input-prepend"><span style="width:21px" title="Relinquish dominance over this room" rel="tooltip" class="add-on"><i class="icon-eye-close"></i></span><button class="btn input lose-command">Relinquish Command</button></div></div><label class="checkbox"><input type="checkbox" class="movingwindow"/>Points earned in last 20 questions</label><label class="checkbox"><input type="checkbox" class="adhd"/>Enable distraction free mode</label><div class="microwave"><label class="checkbox"><input type="checkbox" checked="checked" class="livechat"/>Show chat messages while typing</label></div><label class="checkbox"><input type="checkbox" class="sounds"/>Play sound on successful buzz</label><div style="display:none;white-space:nowrap;" class="lockvote"><label class="checkbox"><input type="checkbox" class="lock"/>Lock settings <span class=\'electorate\'>0/1 votes</span><i style="padding-left: 5px" class="icon-unlock status_icon"></i></label></div></div><hr/><div class="globalsettings"><div class="expando"><div class="input-prepend"><span style="width:21px" title="Read speed" rel="tooltip" class="add-on"><i class="icon-step-forward"></i></span><input type="range" value="200" min="60" max="600" class="speed"/></div></div><div class="expando"><div class="input-prepend"><span style="width:21px" title="Difficulty/Category" rel="tooltip" class="add-on"><i class="icon-briefcase"></i></span><select style="width: 60px; border-right: 0" class="padd-on difficulties"></select><select style="border-left: 0" class="input categories"></select></div></div><div style="display:none" class="custom-category"></div><label class="checkbox"><input type="checkbox" class="showbonus"/>Show bonus questions</label><label class="checkbox"><input type="checkbox" checked="checked" class="multibuzz"/>Allow players to buzz multiple times</label><label class="checkbox"><input type="checkbox" checked="checked" class="allowskip"/>Allow players to skip questions</label><label style="display: none" class="checkbox"><input type="checkbox" checked="checked" class="allowpause"/>Allow players to pause questions</label><div class="request-access"><button class="btn btn-large"><i class="icon-cog"></i>&nbsp; Request Access</button></div></div></div></div>');return buf.join("")},jade.update=function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{})buf.push('<div class="well"><a href="" class="btn btn-primary pull-right">Reload</a>A <strong>new version</strong> of this application has been downloaded. Please reload the application now.</div>');return buf.join("")},window.Modernizr=function(e,t,o){function n(e){p.cssText=e}function i(e,t){return typeof e===t}var r,a,s,u="2.6.1",l={},c=!0,h=t.documentElement,d="modernizr",f=t.createElement(d),p=f.style,m=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),y={},g=[],b=g.slice,w=function(e,o,n,i){var r,a,s,u=t.createElement("div"),l=t.body,c=l?l:t.createElement("body");if(parseInt(n,10))for(;n--;)s=t.createElement("div"),s.id=i?i[n]:d+(n+1),u.appendChild(s);return r=["&#173;",'<style id="s',d,'">',e,"</style>"].join(""),u.id=d,(l?u:c).innerHTML+=r,c.appendChild(u),l||(c.style.background="",h.appendChild(c)),a=o(u,e),l?u.parentNode.removeChild(u):c.parentNode.removeChild(c),!!a},v={}.hasOwnProperty;s=i(v,"undefined")||i(v.call,"undefined")?function(e,t){return t in e&&i(e.constructor.prototype[t],"undefined")}:function(e,t){return v.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var o=b.call(arguments,1),n=function(){if(this instanceof n){var i=function(){};i.prototype=t.prototype;var r=new i,a=t.apply(r,o.concat(b.call(arguments)));return Object(a)===a?a:r}return t.apply(e,o.concat(b.call(arguments)))};return n}),y.touch=function(){var o;return"ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch?o=!0:w(["@media (",m.join("touch-enabled),("),d,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(e){o=9===e.offsetTop}),o};for(var k in y)s(y,k)&&(a=k.toLowerCase(),l[a]=y[k](),g.push((l[a]?"":"no-")+a));return l.addTest=function(e,t){if("object"==typeof e)for(var n in e)s(e,n)&&l.addTest(n,e[n]);else{if(e=e.toLowerCase(),l[e]!==o)return l;t="function"==typeof t?t():t,c&&(h.className+=" "+(t?"":"no-")+e),l[e]=t}return l},n(""),f=r=null,function(e,t){function o(e,t){var o=e.createElement("p"),n=e.getElementsByTagName("head")[0]||e.documentElement;return o.innerHTML="x<style>"+t+"</style>",n.insertBefore(o.lastChild,n.firstChild)}function n(){var e=g.elements;return"string"==typeof e?e.split(" "):e}function i(e){var t=y[e[p]];return t||(t={},m++,e[p]=m,y[m]=t),t}function r(e,o,n){if(o||(o=t),c)return o.createElement(e);n||(n=i(o));var r;return r=n.cache[e]?n.cache[e].cloneNode():f.test(e)?(n.cache[e]=n.createElem(e)).cloneNode():n.createElem(e),r.canHaveChildren&&!d.test(e)?n.frag.appendChild(r):r}function a(e,o){if(e||(e=t),c)return e.createDocumentFragment();o=o||i(e);for(var r=o.frag.cloneNode(),a=0,s=n(),u=s.length;u>a;a++)r.createElement(s[a]);return r}function s(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(o){return g.shivMethods?r(o,e,t):t.createElem(o)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+n().join().replace(/\w+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(g,t.frag)}function u(e){e||(e=t);var n=i(e);return g.shivCSS&&!l&&!n.hasCSS&&(n.hasCSS=!!o(e,"article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")),c||s(e,n),e}var l,c,h=e.html5||{},d=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,f=/^<|^(?:a|b|button|code|div|fieldset|form|h1|h2|h3|h4|h5|h6|i|iframe|img|input|label|li|link|ol|option|p|param|q|script|select|span|strong|style|table|tbody|td|textarea|tfoot|th|thead|tr|ul)$/i,p="_html5shiv",m=0,y={};!function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",l="hidden"in e,c=1==e.childNodes.length||function(){t.createElement("a");var e=t.createDocumentFragment();return"undefined"==typeof e.cloneNode||"undefined"==typeof e.createDocumentFragment||"undefined"==typeof e.createElement}()}catch(o){l=!0,c=!0}}();var g={elements:h.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:h.shivCSS!==!1,supportsUnknownElements:c,shivMethods:h.shivMethods!==!1,type:"default",shivDocument:u,createElement:r,createDocumentFragment:a};e.html5=g,u(t)}(this,t),l._version=u,l._prefixes=m,l.testStyles=w,h.className=h.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(c?" js "+g.join(" "):""),l}(this,this.document),function(e,t,o){function n(e){return"[object Function]"==y.call(e)}function i(e){return"string"==typeof e}function r(){}function a(e){return!e||"loaded"==e||"complete"==e||"uninitialized"==e}function s(){var e=g.shift();b=1,e?e.t?p(function(){("c"==e.t?d.injectCss:d.injectJs)(e.s,0,e.a,e.x,e.e,1)},0):(e(),s()):b=0}function u(e,o,n,i,r,u,l){function c(t){if(!f&&a(h.readyState)&&(w.r=f=1,!b&&s(),h.onload=h.onreadystatechange=null,t)){"img"!=e&&p(function(){k.removeChild(h)},50);for(var n in x[o])x[o].hasOwnProperty(n)&&x[o][n].onload()}}var l=l||d.errorTimeout,h=t.createElement(e),f=0,y=0,w={t:n,s:o,e:r,a:u,x:l};1===x[o]&&(y=1,x[o]=[]),"object"==e?h.data=o:(h.src=o,h.type=e),h.width=h.height="0",h.onerror=h.onload=h.onreadystatechange=function(){c.call(this,y)},g.splice(i,0,w),"img"!=e&&(y||2===x[o]?(k.insertBefore(h,v?null:m),p(c,l)):x[o].push(h))}function l(e,t,o,n,r){return b=0,t=t||"j",i(e)?u("c"==t?$:_,e,t,this.i++,o,n,r):(g.splice(this.i++,0,e),1==g.length&&s()),this}function c(){var e=d;return e.loader={load:l,i:0},e}var h,d,f=t.documentElement,p=e.setTimeout,m=t.getElementsByTagName("script")[0],y={}.toString,g=[],b=0,w="MozAppearance"in f.style,v=w&&!!t.createRange().compareNode,k=v?f:m.parentNode,f=e.opera&&"[object Opera]"==y.call(e.opera),f=!!t.attachEvent&&!f,_=w?"object":f?"script":"img",$=f?"script":_,C=Array.isArray||function(e){return"[object Array]"==y.call(e)},E=[],x={},T={timeout:function(e,t){return t.length&&(e.timeout=t[0]),e}};d=function(e){function t(e){var t,o,n,e=e.split("!"),i=E.length,r=e.pop(),a=e.length,r={url:r,origUrl:r,prefixes:e};for(o=0;a>o;o++)n=e[o].split("="),(t=T[n.shift()])&&(r=t(r,n));for(o=0;i>o;o++)r=E[o](r);return r}function a(e,i,r,a,s){var u=t(e),l=u.autoCallback;u.url.split(".").pop().split("?").shift(),u.bypass||(i&&(i=n(i)?i:i[e]||i[a]||i[e.split("/").pop().split("?")[0]]),u.instead?u.instead(e,i,r,a,s):(x[u.url]?u.noexec=!0:x[u.url]=1,r.load(u.url,u.forceCSS||!u.forceJS&&"css"==u.url.split(".").pop().split("?").shift()?"c":o,u.noexec,u.attrs,u.timeout),(n(i)||n(l))&&r.load(function(){c(),i&&i(u.origUrl,s,a),l&&l(u.origUrl,s,a),x[u.url]=2})))}function s(e,t){function o(e,o){if(e){if(i(e))o||(h=function(){var e=[].slice.call(arguments);d.apply(this,e),f()}),a(e,h,t,0,l);else if(Object(e)===e)for(u in s=function(){var t,o=0;for(t in e)e.hasOwnProperty(t)&&o++;return o}(),e)e.hasOwnProperty(u)&&(!o&&!--s&&(n(h)?h=function(){var e=[].slice.call(arguments);d.apply(this,e),f()}:h[u]=function(e){return function(){var t=[].slice.call(arguments);e&&e.apply(this,t),f()}}(d[u])),a(e[u],h,t,u,l))}else!o&&f()}var s,u,l=!!e.test,c=e.load||e.both,h=e.callback||r,d=h,f=e.complete||r;o(l?e.yep:e.nope,!!c),c&&o(c)}var u,l,h=this.yepnope.loader;if(i(e))a(e,0,h,0);else if(C(e))for(u=0;u<e.length;u++)l=e[u],i(l)?a(l,0,h,0):C(l)?d(l):Object(l)===l&&s(l,h);else Object(e)===e&&s(e,h)},d.addPrefix=function(e,t){T[e]=t},d.addFilter=function(e){E.push(e)},d.errorTimeout=1e4,null==t.readyState&&t.addEventListener&&(t.readyState="loading",t.addEventListener("DOMContentLoaded",h=function(){t.removeEventListener("DOMContentLoaded",h,0),t.readyState="complete"},0)),e.yepnope=c(),e.yepnope.executeStack=s,e.yepnope.injectJs=function(e,o,n,i,u,l){var c,h,f=t.createElement("script"),i=i||d.errorTimeout;f.src=e;for(h in n)f.setAttribute(h,n[h]);o=l?s:o||r,f.onreadystatechange=f.onload=function(){!c&&a(f.readyState)&&(c=1,o(),f.onload=f.onreadystatechange=null)},p(function(){c||(c=1,o(1))},i),u?f.onload():m.parentNode.insertBefore(f,m)},e.yepnope.injectCss=function(e,o,n,i,a,u){var l,i=t.createElement("link"),o=u?s:o||r;i.href=e,i.rel="stylesheet",i.type="text/css";for(l in n)i.setAttribute(l,n[l]);a||(m.parentNode.insertBefore(i,m),p(o,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))},Modernizr.addTest("csscalc",function(e,t,o){return t="width:",o="calc(10px);",e=document.createElement("div"),e.style.cssText=t+Modernizr._prefixes.join(o+t),!!e.style.length}),!function(e){e(function(){"use strict";e.support.transition=function(){var e=function(){var e,t=document.createElement("bootstrap"),o={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(e in o)if(void 0!==t.style[e])return o[e]}();return e&&{end:e}}()})}(window.jQuery),!function(e){"use strict";function t(){e(n).each(function(){o(e(this)).removeClass("open")})}function o(t){var o,n=t.attr("data-target");return n||(n=t.attr("href"),n=n&&/#/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,"")),o=n&&e(n),o&&o.length||(o=t.parent()),o}var n="[data-toggle=dropdown]",i=function(t){var o=e(t).on("click.dropdown.data-api",this.toggle);e("html").on("click.dropdown.data-api",function(){o.parent().removeClass("open")})};i.prototype={constructor:i,toggle:function(){var n,i,r=e(this);if(!r.is(".disabled, :disabled"))return n=o(r),i=n.hasClass("open"),t(),i||n.toggleClass("open"),r.focus(),!1},keydown:function(t){var i,r,a,s,u;if(/(38|40|27)/.test(t.keyCode)&&(i=e(this),t.preventDefault(),t.stopPropagation(),!i.is(".disabled, :disabled"))){if(a=o(i),s=a.hasClass("open"),!s||s&&27==t.keyCode)return 27==t.which&&a.find(n).focus(),i.click();r=e("[role=menu] li:not(.divider):visible a",a),r.length&&(u=r.index(r.filter(":focus")),38==t.keyCode&&u>0&&u--,40==t.keyCode&&u<r.length-1&&u++,~u||(u=0),r.eq(u).focus())}}};var r=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var o=e(this),n=o.data("dropdown");n||o.data("dropdown",n=new i(this)),"string"==typeof t&&n[t].call(o)})},e.fn.dropdown.Constructor=i,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=r,this},e(document).on("click.dropdown.data-api",t).on("click.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.dropdown-menu",function(e){e.stopPropagation()}).on("click.dropdown.data-api",n,i.prototype.toggle).on("keydown.dropdown.data-api",n+", [role=menu]",i.prototype.keydown)}(window.jQuery),!function(e){"use strict";var t=function(t,o){this.options=o,this.$element=e(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",e.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};t.prototype={constructor:t,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,o=e.Event("show");this.$element.trigger(o),this.isShown||o.isDefaultPrevented()||(e("body").addClass("modal-open"),this.isShown=!0,this.escape(),this.backdrop(function(){var o=e.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(document.body),t.$element.show(),o&&t.$element[0].offsetWidth,t.$element.addClass("in").attr("aria-hidden",!1).focus(),t.enforceFocus(),o?t.$element.one(e.support.transition.end,function(){t.$element.trigger("shown")}):t.$element.trigger("shown")}))},hide:function(t){t&&t.preventDefault(),t=e.Event("hide"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,e("body").removeClass("modal-open"),this.escape(),e(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),e.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal())},enforceFocus:function(){var t=this;e(document).on("focusin.modal",function(e){t.$element[0]===e.target||t.$element.has(e.target).length||t.$element.focus()})},escape:function(){var e=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(t){27==t.which&&e.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var t=this,o=setTimeout(function(){t.$element.off(e.support.transition.end),t.hideModal()},500);this.$element.one(e.support.transition.end,function(){clearTimeout(o),t.hideModal()})},hideModal:function(){this.$element.hide().trigger("hidden"),this.backdrop()},removeBackdrop:function(){this.$backdrop.remove(),this.$backdrop=null},backdrop:function(t){var o=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var n=e.support.transition&&o;this.$backdrop=e('<div class="modal-backdrop '+o+'" />').appendTo(document.body),"static"!=this.options.backdrop&&this.$backdrop.click(e.proxy(this.hide,this)),n&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),n?this.$backdrop.one(e.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,e.proxy(this.removeBackdrop,this)):this.removeBackdrop()):t&&t()}},e.fn.modal=function(o){return this.each(function(){var n=e(this),i=n.data("modal"),r=e.extend({},e.fn.modal.defaults,n.data(),"object"==typeof o&&o);i||n.data("modal",i=new t(this,r)),"string"==typeof o?i[o]():r.show&&i.show()})},e.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},e.fn.modal.Constructor=t,e(function(){e("body").on("click.modal.data-api",'[data-toggle="modal"]',function(t){var o=e(this),n=o.attr("href"),i=e(o.attr("data-target")||n&&n.replace(/.*(?=#[^\s]+$)/,"")),r=i.data("modal")?"toggle":e.extend({remote:!/#/.test(n)&&n},i.data(),o.data());t.preventDefault(),i.modal(r).one("hide",function(){o.focus()})})})}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("tooltip",e,t)};t.prototype={constructor:t,init:function(t,o,n){var i,r;this.type=t,this.$element=e(o),this.options=this.getOptions(n),this.enabled=!0,"click"==this.options.trigger?this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this)):"manual"!=this.options.trigger&&(i="hover"==this.options.trigger?"mouseenter":"focus",r="hover"==this.options.trigger?"mouseleave":"blur",this.$element.on(i+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(r+"."+this.type,this.options.selector,e.proxy(this.leave,this))),this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=e.extend({},e.fn[this.type].defaults,t,this.$element.data()),t.delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t
},enter:function(t){var o=e(t.currentTarget)[this.type](this._options).data(this.type);return o.options.delay&&o.options.delay.show?(clearTimeout(this.timeout),o.hoverState="in",this.timeout=setTimeout(function(){"in"==o.hoverState&&o.show()},o.options.delay.show),void 0):o.show()},leave:function(t){var o=e(t.currentTarget)[this.type](this._options).data(this.type);return this.timeout&&clearTimeout(this.timeout),o.options.delay&&o.options.delay.hide?(o.hoverState="out",this.timeout=setTimeout(function(){"out"==o.hoverState&&o.hide()},o.options.delay.hide),void 0):o.hide()},show:function(){var e,t,o,n,i,r,a;if(this.hasContent()&&this.enabled){switch(e=this.tip(),this.setContent(),this.options.animation&&e.addClass("fade"),r="function"==typeof this.options.placement?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,t=/in/.test(r),e.remove().css({top:0,left:0,display:"block"}).appendTo(t?this.$element:document.body),o=this.getPosition(t),n=e[0].offsetWidth,i=e[0].offsetHeight,t?r.split(" ")[1]:r){case"bottom":a={top:o.top+o.height,left:o.left+o.width/2-n/2};break;case"top":a={top:o.top-i,left:o.left+o.width/2-n/2};break;case"left":a={top:o.top+o.height/2-i/2,left:o.left-n};break;case"right":a={top:o.top+o.height/2-i/2,left:o.left+o.width}}e.css(a).addClass(r).addClass("in")}},setContent:function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},hide:function(){function t(){var t=setTimeout(function(){o.off(e.support.transition.end).remove()},500);o.one(e.support.transition.end,function(){clearTimeout(t),o.remove()})}var o=this.tip();return o.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?t():o.remove(),this},fixTitle:function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(t){return e.extend({},t?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var e,t=this.$element,o=this.options;return e=t.attr("data-original-title")||("function"==typeof o.title?o.title.call(t[0]):o.title)},tip:function(){return this.$tip=this.$tip||e(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}},e.fn.tooltip=function(o){return this.each(function(){var n=e(this),i=n.data("tooltip"),r="object"==typeof o&&o;i||n.data("tooltip",i=new t(this,r)),"string"==typeof o&&i[o]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0,html:!0}}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("popover",e,t)};t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype,{constructor:t,setContent:function(){var e=this.tip(),t=this.getTitle(),o=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content > *")[this.options.html?"html":"text"](o),e.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var e,t=this.$element,o=this.options;return e=t.attr("data-content")||("function"==typeof o.content?o.content.call(t[0]):o.content)},tip:function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}}),e.fn.popover=function(o){return this.each(function(){var n=e(this),i=n.data("popover"),r="object"==typeof o&&o;i||n.data("popover",i=new t(this,r)),"string"==typeof o&&i[o]()})},e.fn.popover.Constructor=t,e.fn.popover.defaults=e.extend({},e.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'})}(window.jQuery),!function(e){"use strict";var t='[data-dismiss="alert"]',o=function(o){e(o).on("click",t,this.close)};o.prototype.close=function(t){function o(){n.trigger("closed").remove()}var n,i=e(this),r=i.attr("data-target");r||(r=i.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,"")),n=e(r),t&&t.preventDefault(),n.length||(n=i.hasClass("alert")?i:i.parent()),n.trigger(t=e.Event("close")),t.isDefaultPrevented()||(n.removeClass("in"),e.support.transition&&n.hasClass("fade")?n.on(e.support.transition.end,o):n.slideUp("normal",function(){o()}))},e.fn.alert=function(t){return this.each(function(){var n=e(this),i=n.data("alert");i||n.data("alert",i=new o(this)),"string"==typeof t&&i[t].call(n)})},e.fn.alert.Constructor=o,e(function(){e("body").on("click.alert.data-api",t,o.prototype.close)})}(window.jQuery),!function(e){"use strict";var t=function(t,o){this.$element=e(t),this.options=e.extend({},e.fn.button.defaults,o)};t.prototype.setState=function(e){var t="disabled",o=this.$element,n=o.data(),i=o.is("input")?"val":"html";e+="Text",n.resetText||o.data("resetText",o[i]()),o[i](n[e]||this.options[e]),setTimeout(function(){"loadingText"==e?o.addClass(t).attr(t,t):o.removeClass(t).removeAttr(t)},0)},t.prototype.toggle=function(){var e=this.$element.closest('[data-toggle="buttons-radio"]');e&&e.find(".active").removeClass("active"),this.$element.toggleClass("active")},e.fn.button=function(o){return this.each(function(){var n=e(this),i=n.data("button"),r="object"==typeof o&&o;i||n.data("button",i=new t(this,r)),"toggle"==o?i.toggle():o&&i.setState(o)})},e.fn.button.defaults={loadingText:"loading..."},e.fn.button.Constructor=t,e(function(){e("body").on("click.button.data-api","[data-toggle^=button]",function(t){var o=e(t.target);o.hasClass("btn")||(o=o.closest(".btn")),o.button("toggle")})})}(window.jQuery),!function(e){"use strict";var t=function(t,o){this.$element=e(t),this.options=e.extend({},e.fn.typeahead.defaults,o),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.$menu=e(this.options.menu).appendTo("body"),this.source=this.options.source,this.shown=!1,this.listen()};t.prototype={constructor:t,select:function(){var e=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(e)).change(),this.hide()},updater:function(e){return e},show:function(){var t=e.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});return this.$menu.css({top:t.top+t.height,left:t.left}),this.$menu.show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(){var t;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(t=e.isFunction(this.source)?this.source(this.query,e.proxy(this.process,this)):this.source,t?this.process(t):this)},process:function(t){var o=this;return t=e.grep(t,function(e){return o.matcher(e)}),t=this.sorter(t),t.length?this.render(t.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(e){return~e.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){for(var t,o=[],n=[],i=[];t=e.shift();)t.toLowerCase().indexOf(this.query.toLowerCase())?~t.indexOf(this.query)?n.push(t):i.push(t):o.push(t);return o.concat(n,i)},highlighter:function(e){var t=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+t+")","ig"),function(e,t){return"<strong>"+t+"</strong>"})},render:function(t){var o=this;return t=e(t).map(function(t,n){return t=e(o.options.item).attr("data-value",n),t.find("a").html(o.highlighter(n)),t[0]}),t.first().addClass("active"),this.$menu.html(t),this},next:function(){var t=this.$menu.find(".active").removeClass("active"),o=t.next();o.length||(o=e(this.$menu.find("li")[0])),o.addClass("active")},prev:function(){var e=this.$menu.find(".active").removeClass("active"),t=e.prev();t.length||(t=this.$menu.find("li").last()),t.addClass("active")},listen:function(){this.$element.on("blur",e.proxy(this.blur,this)).on("keypress",e.proxy(this.keypress,this)).on("keyup",e.proxy(this.keyup,this)),(e.browser.chrome||e.browser.webkit||e.browser.msie)&&this.$element.on("keydown",e.proxy(this.keydown,this)),this.$menu.on("click",e.proxy(this.click,this)).on("mouseenter","li",e.proxy(this.mouseenter,this))},move:function(e){if(this.shown){switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:e.preventDefault(),this.prev();break;case 40:e.preventDefault(),this.next()}e.stopPropagation()}},keydown:function(t){this.suppressKeyPressRepeat=!~e.inArray(t.keyCode,[40,38,9,13,27]),this.move(t)},keypress:function(e){this.suppressKeyPressRepeat||this.move(e)},keyup:function(e){switch(e.keyCode){case 40:case 38:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}e.stopPropagation(),e.preventDefault()},blur:function(){var e=this;setTimeout(function(){e.hide()},150)},click:function(e){e.stopPropagation(),e.preventDefault(),this.select()},mouseenter:function(t){this.$menu.find(".active").removeClass("active"),e(t.currentTarget).addClass("active")}},e.fn.typeahead=function(o){return this.each(function(){var n=e(this),i=n.data("typeahead"),r="object"==typeof o&&o;i||n.data("typeahead",i=new t(this,r)),"string"==typeof o&&i[o]()})},e.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},e.fn.typeahead.Constructor=t,e(function(){e("body").on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var o=e(this);o.data("typeahead")||(t.preventDefault(),o.typeahead(o.data()))})})}(window.jQuery);var e,t,o;o=function(){var e,t,n,i,r,a,s,u,l;return r=1e3,e=5,n=60,t=60*n,i=["January","February","March","April","May","June","July","August","September","October","November","December"],a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],u=function(e){var t,o,n,i,r,a;return a=e.getMinutes(),r=e.getHours(),t=r>12?"pm":"am",o=0===r||12===r?"12":""+r%12,n=10>a?"0"+a:""+a,i=""+o+":"+n+t},s=function(e){return i[e.getMonth()]},l=function(e){return a[e.getDay()]},o=function(o){var i,a,c,h,d,f,p,m,y,g,b,w,v,k,_,$,C,E,x;return d=new Date,f=(d.getTime()-o.getTime())/r,h=new Date(d.getFullYear()+1,0,1),a=new Date(d.getFullYear(),d.getMonth(),d.getDate()+(7-d.getDay())),C=new Date(d.getFullYear(),d.getMonth(),d.getDate()+1),y=new Date(d.getFullYear(),d.getMonth(),d.getDate()+2),_=new Date(d.getFullYear(),d.getMonth(),d.getDate()),x=new Date(d.getFullYear(),d.getMonth(),d.getDate()-1),b=new Date(d.getFullYear(),d.getMonth(),d.getDate()-d.getDay()),v=new Date(d.getFullYear(),0,1),c=(d.getTime()-h.getTime())/r,i=(d.getTime()-a.getTime())/r,m=(d.getTime()-y.getTime())/r,$=(d.getTime()-C.getTime())/r,k=(d.getTime()-_.getTime())/r,E=(d.getTime()-x.getTime())/r,g=(d.getTime()-b.getTime())/r,w=(d.getTime()-v.getTime())/r,p=f>=0?e>f?"A few seconds ago":n>f?""+Math.floor(f)+" seconds ago":2*n>f?"About a minute ago":t>f?""+Math.floor(f/n)+" minutes ago":2*t>f?"About an hour ago":k>f?""+Math.floor(f/t)+" hours ago":E>f?"Yesterday at "+u(o):g>f?""+l(o)+" at "+u(o):w>f?""+s(o)+" "+o.getDate()+" at "+u(o):""+s(o)+" "+o.getDate()+", "+o.getFullYear()+" at "+u(o):f>-e?"In a few seconds":f>-n?"In "+Math.floor(-f)+" seconds":f>2*-n?"In about a minute":f>-t?"In "+Math.floor(-f/n)+" minutes":f>2*-t?"In about an hour":f>$?"In "+Math.floor(-f/t)+" hours":f>m?"Tomorrow at "+u(o):f>i?""+l(o)+" at "+u(o):f>c?""+s(o)+" "+o.getDate()+" at "+u(o):""+s(o)+" "+o.getDate()+", "+o.getFullYear()+" at "+u(o)}}(),e=function(e){var t;return t=new Date,t.setTime(e),o(t)},t=function(e){var t;return t=new Date,t.setTime(e),t.getHours()%12+":"+("0"+t.getMinutes()).substr(-2,2)+(t.getHours()>12?"pm":"am")},function(e,t,o){"function"==typeof define&&define.amd?define(["jquery"],function(n){return o(n,e,t),n.mobile}):o(e.jQuery,e,t)}(this,document,function(e,t,o){!function(e){var t={touch:"ontouchend"in o};e.mobile=e.mobile||{},e.mobile.support=e.mobile.support||{},e.extend(e.support,t),e.extend(e.mobile.support,t)}(e),function(e,t,o,n){function i(e){for(;e&&"undefined"!=typeof e.originalEvent;)e=e.originalEvent;return e}function r(t,o){var r,a,s,u,l,c,h,d,f,p=t.type;if(t=e.Event(t),t.type=o,r=t.originalEvent,a=e.event.props,p.search(/^(mouse|click)/)>-1&&(a=D),r)for(h=a.length,u;h;)u=a[--h],t[u]=r[u];if(p.search(/mouse(down|up)|click/)>-1&&!t.which&&(t.which=1),-1!==p.search(/^touch/)&&(s=i(r),p=s.touches,l=s.changedTouches,c=p&&p.length?p[0]:l&&l.length?l[0]:n))for(d=0,f=T.length;f>d;d++)u=T[d],t[u]=c[u];return t}function a(t){for(var o,n,i={};t;){o=e.data(t,C);for(n in o)o[n]&&(i[n]=i.hasVirtualBinding=!0);t=t.parentNode}return i}function s(t,o){for(var n;t;){if(n=e.data(t,C),n&&(!o||n[o]))return t;t=t.parentNode}return null}function u(){q=!1}function l(){q=!0}function c(){U=0,N.length=0,F=!1,l()}function h(){u()}function d(){f(),O=setTimeout(function(){O=0,c()},e.vmouse.resetTimerDuration)}function f(){O&&(clearTimeout(O),O=0)}function p(t,o,n){var i;return(n&&n[t]||!n&&s(o.target,t))&&(i=r(o,t),e(o.target).trigger(i)),i}function m(t){var o=e.data(t.target,E);if(!(F||U&&U===o)){var n=p("v"+t.type,t);n&&(n.isDefaultPrevented()&&t.preventDefault(),n.isPropagationStopped()&&t.stopPropagation(),n.isImmediatePropagationStopped()&&t.stopImmediatePropagation())}}function y(t){var o,n,r=i(t).touches;if(r&&1===r.length&&(o=t.target,n=a(o),n.hasVirtualBinding)){U=R++,e.data(o,E,U),f(),h(),j=!1;var s=i(t).touches[0];z=s.pageX,I=s.pageY,p("vmouseover",t,n),p("vmousedown",t,n)}}function g(e){q||(j||p("vmousecancel",e,a(e.target)),j=!0,d())}function b(t){if(!q){var o=i(t).touches[0],n=j,r=e.vmouse.moveDistanceThreshold,s=a(t.target);j=j||Math.abs(o.pageX-z)>r||Math.abs(o.pageY-I)>r,j&&!n&&p("vmousecancel",t,s),p("vmousemove",t,s),d()}}function w(e){if(!q){l();var t,o=a(e.target);if(p("vmouseup",e,o),!j){var n=p("vclick",e,o);n&&n.isDefaultPrevented()&&(t=i(e).changedTouches[0],N.push({touchID:U,x:t.clientX,y:t.clientY}),F=!0)}p("vmouseout",e,o),j=!1,d()}}function v(t){var o,n=e.data(t,C);if(n)for(o in n)if(n[o])return!0;return!1}function k(){}function _(t){var o=t.substr(1);return{setup:function(){v(this)||e.data(this,C,{});var n=e.data(this,C);n[t]=!0,S[t]=(S[t]||0)+1,1===S[t]&&L.bind(o,m),e(this).bind(o,k),M&&(S.touchstart=(S.touchstart||0)+1,1===S.touchstart&&L.bind("touchstart",y).bind("touchend",w).bind("touchmove",b).bind("scroll",g))},teardown:function(){--S[t],S[t]||L.unbind(o,m),M&&(--S.touchstart,S.touchstart||L.unbind("touchstart",y).unbind("touchmove",b).unbind("touchend",w).unbind("scroll",g));var n=e(this),i=e.data(this,C);i&&(i[t]=!1),n.unbind(o,k),v(this)||n.removeData(C)}}}var $,C="virtualMouseBindings",E="virtualTouchID",x="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),T="clientX clientY pageX pageY screenX screenY".split(" "),A=e.event.mouseHooks?e.event.mouseHooks.props:[],D=e.event.props.concat(A),S={},O=0,z=0,I=0,j=!1,N=[],F=!1,q=!1,M="addEventListener"in o,L=e(o),R=1,U=0;e.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500};for(var B=0;B<x.length;B++)e.event.special[x[B]]=_(x[B]);M&&o.addEventListener("click",function(t){var o,n,i,r,a,s,u=N.length,l=t.target;if(u)for(o=t.clientX,n=t.clientY,$=e.vmouse.clickDistanceThreshold,i=l;i;){for(r=0;u>r;r++)if(a=N[r],s=0,i===l&&Math.abs(a.x-o)<$&&Math.abs(a.y-n)<$||e.data(i,E)===a.touchID)return t.preventDefault(),t.stopPropagation(),void 0;i=i.parentNode}},!0)}(e,t,o),function(e,t,n){function i(t,o,n){var i=n.type;n.type=o,e.event.handle.call(t,n),n.type=i}e.each("touchstart touchmove touchend tap taphold swipe swipeleft swiperight scrollstart scrollstop".split(" "),function(t,o){e.fn[o]=function(e){return e?this.bind(o,e):this.trigger(o)},e.attrFn&&(e.attrFn[o]=!0)});var r=e.mobile.support.touch,a="touchmove scroll",s=r?"touchstart":"mousedown",u=r?"touchend":"mouseup",l=r?"touchmove":"mousemove";e.event.special.scrollstart={enabled:!0,setup:function(){function t(e,t){o=t,i(r,o?"scrollstart":"scrollstop",e)}var o,n,r=this,s=e(r);s.bind(a,function(i){e.event.special.scrollstart.enabled&&(o||t(i,!0),clearTimeout(n),n=setTimeout(function(){t(i,!1)},50))})}},e.event.special.tap={tapholdThreshold:750,setup:function(){var t=this,n=e(t);n.bind("vmousedown",function(r){function a(){clearTimeout(l)}function s(){a(),n.unbind("vclick",u).unbind("vmouseup",a),e(o).unbind("vmousecancel",s)}function u(e){s(),c===e.target&&i(t,"tap",e)}if(r.which&&1!==r.which)return!1;var l,c=r.target;r.originalEvent,n.bind("vmouseup",a).bind("vclick",u),e(o).bind("vmousecancel",s),l=setTimeout(function(){i(t,"taphold",e.Event("taphold",{target:c}))},e.event.special.tap.tapholdThreshold)})}},e.event.special.swipe={scrollSupressionThreshold:30,durationThreshold:1e3,horizontalDistanceThreshold:30,verticalDistanceThreshold:75,setup:function(){var t=this,o=e(t);o.bind(s,function(t){function i(t){if(s){var o=t.originalEvent.touches?t.originalEvent.touches[0]:t;r={time:(new Date).getTime(),coords:[o.pageX,o.pageY]},Math.abs(s.coords[0]-r.coords[0])>e.event.special.swipe.scrollSupressionThreshold&&t.preventDefault()}}var r,a=t.originalEvent.touches?t.originalEvent.touches[0]:t,s={time:(new Date).getTime(),coords:[a.pageX,a.pageY],origin:e(t.target)};o.bind(l,i).one(u,function(){o.unbind(l,i),s&&r&&r.time-s.time<e.event.special.swipe.durationThreshold&&Math.abs(s.coords[0]-r.coords[0])>e.event.special.swipe.horizontalDistanceThreshold&&Math.abs(s.coords[1]-r.coords[1])<e.event.special.swipe.verticalDistanceThreshold&&s.origin.trigger("swipe").trigger(s.coords[0]>r.coords[0]?"swipeleft":"swiperight"),s=r=n})})}},e.each({scrollstop:"scrollstart",taphold:"tap",swipeleft:"swipe",swiperight:"swipe"},function(t,o){e.event.special[t]={setup:function(){e(this).bind(o,e.noop)}}})}(e,this)});var n=window.bootbox||function(e,t){function o(e,t){return null==t&&(t=n),"string"==typeof h[t][e]?h[t][e]:t!=i?o(e,i):e}var n="en",i="en",r=!0,a="static",s="javascript:;",u="",l={},c={};c.setLocale=function(e){for(var t in h)if(t==e)return n=e,void 0;throw new Error("Invalid locale: "+e)},c.addLocale=function(e,t){"undefined"==typeof h[e]&&(h[e]={});for(var o in t)h[e][o]=t[o]},c.setIcons=function(e){l=e,("object"!=typeof l||null==l)&&(l={})},c.alert=function(){var e="",t=o("OK"),n=null;switch(arguments.length){case 1:e=arguments[0];break;case 2:e=arguments[0],"function"==typeof arguments[1]?n=arguments[1]:t=arguments[1];break;case 3:e=arguments[0],t=arguments[1],n=arguments[2];break;default:throw new Error("Incorrect number of arguments: expected 1-3")}return c.dialog(e,{label:t,icon:l.OK,callback:n},{onEscape:n||!0})},c.confirm=function(){var e="",t=o("CANCEL"),n=o("CONFIRM"),i=null;switch(arguments.length){case 1:e=arguments[0];break;case 2:e=arguments[0],"function"==typeof arguments[1]?i=arguments[1]:t=arguments[1];break;case 3:e=arguments[0],t=arguments[1],"function"==typeof arguments[2]?i=arguments[2]:n=arguments[2];break;case 4:e=arguments[0],t=arguments[1],n=arguments[2],i=arguments[3];break;default:throw new Error("Incorrect number of arguments: expected 1-4")}var r=function(){"function"==typeof i&&i(!1)},a=function(){"function"==typeof i&&i(!0)};return c.dialog(e,[{label:t,icon:l.CANCEL,callback:r},{label:n,icon:l.CONFIRM,callback:a}],{onEscape:r})},c.prompt=function(){var e="",n=o("CANCEL"),i=o("CONFIRM"),r=null,a="";switch(arguments.length){case 1:e=arguments[0];break;case 2:e=arguments[0],"function"==typeof arguments[1]?r=arguments[1]:n=arguments[1];break;case 3:e=arguments[0],n=arguments[1],"function"==typeof arguments[2]?r=arguments[2]:i=arguments[2];break;case 4:e=arguments[0],n=arguments[1],i=arguments[2],r=arguments[3];break;case 5:e=arguments[0],n=arguments[1],i=arguments[2],r=arguments[3],a=arguments[4];break;default:throw new Error("Incorrect number of arguments: expected 1-5")}var s=e,u=t("<form></form>");u.append("<input autocomplete=off type=text value='"+a+"' />");var h=function(){"function"==typeof r&&r(null)},d=function(){"function"==typeof r&&r(u.find("input[type=text]").val())},f=c.dialog(u,[{label:n,icon:l.CANCEL,callback:h},{label:i,icon:l.CONFIRM,callback:d}],{header:s,show:!1,onEscape:h});return f.on("shown",function(){u.find("input[type=text]").focus(),u.on("submit",function(e){e.preventDefault(),f.find(".btn-primary").click()})}),f.modal("show"),f},c.dialog=function(o,n,i){var l="",c=[],i=i||{};null==n?n=[]:"undefined"==typeof n.length&&(n=[n]);for(var h=n.length;h--;){var d=null,f=null,p=null,m="",y=null;if("undefined"==typeof n[h].label&&"undefined"==typeof n[h]["class"]&&"undefined"==typeof n[h].callback){var g=0,b=null;for(var w in n[h])if(b=w,++g>1)break;1==g&&"function"==typeof n[h][w]&&(n[h].label=b,n[h].callback=n[h][w])}"function"==typeof n[h].callback&&(y=n[h].callback),n[h]["class"]?p=n[h]["class"]:h==n.length-1&&n.length<=2&&(p="btn-primary"),d=n[h].label?n[h].label:"Option "+(h+1),n[h].icon&&(m="<i class='"+n[h].icon+"'></i> "),f=n[h].href?n[h].href:s,l="<a data-handler='"+h+"' class='btn "+p+"' href='"+f+"'>"+m+d+"</a>"+l,c[h]=y}var v=["<div class='bootbox modal' tabindex='-1' style='overflow:hidden;'>"];if(i.header){var k="";("undefined"==typeof i.headerCloseButton||i.headerCloseButton)&&(k="<a href='"+s+"' class='close'>&times;</a>"),v.push("<div class='modal-header'>"+k+"<h3>"+i.header+"</h3></div>")}v.push("<div class='modal-body'></div>"),l&&v.push("<div class='modal-footer'>"+l+"</div>"),v.push("</div>");var _=t(v.join("\n")),$="undefined"==typeof i.animate?r:i.animate;$&&_.addClass("fade");var C="undefined"==typeof i.classes?u:i.classes;return C&&_.addClass(C),_.find(".modal-body").html(o),_.on("hidden",function(){_.remove()}),_.on("keyup.dismiss.modal",function(e){27==e.which&&i.onEscape&&("function"==typeof i.onEscape&&i.onEscape(),_.modal("hide"))}),_.on("shown",function(){_.find("a.btn-primary:first").focus()}),_.on("click",".modal-footer a, a.close",function(e){var o=t(this).data("handler"),i=c[o],r=null;("undefined"==typeof o||"undefined"==typeof n[o].href)&&(e.preventDefault(),"function"==typeof i&&(r=i()),r!==!1&&_.modal("hide"))}),t("body").append(_),_.modal({backdrop:"undefined"==typeof i.backdrop?a:i.backdrop,keyboard:!1,show:!1}),_.on("show",function(){t(e).off("focusin.modal")}),("undefined"==typeof i.show||i.show===!0)&&_.modal("show"),_},c.modal=function(){var e,o,n,i={onEscape:null,keyboard:!0,backdrop:a};switch(arguments.length){case 1:e=arguments[0];break;case 2:e=arguments[0],"object"==typeof arguments[1]?n=arguments[1]:o=arguments[1];break;case 3:e=arguments[0],o=arguments[1],n=arguments[2];break;default:throw new Error("Incorrect number of arguments: expected 1-3")}return i.header=o,n="object"==typeof n?t.extend(i,n):i,c.dialog(e,[],n)},c.hideAll=function(){t(".bootbox").modal("hide")},c.animate=function(e){r=e},c.backdrop=function(e){a=e},c.classes=function(e){u=e};var h={en:{OK:"OK",CANCEL:"Cancel",CONFIRM:"OK"},fr:{OK:"OK",CANCEL:"Annuler",CONFIRM:"D'accord"},de:{OK:"OK",CANCEL:"Abbrechen",CONFIRM:"Akzeptieren"},es:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Aceptar"},br:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Sim"},nl:{OK:"OK",CANCEL:"Annuleren",CONFIRM:"Accepteren"},ru:{OK:"OK",CANCEL:"Отмена",CONFIRM:"Применить"},it:{OK:"OK",CANCEL:"Annulla",CONFIRM:"Conferma"}};return c}(document,window.jQuery);window.bootbox=n,String.prototype.toTitleCase=function(){var e=/^(a|an|and|as|at|but|by|en|for|if|in|of|on|or|the|to|vs?\.?|via)$/i;return this.replace(/([^\W_]+[^\s-]*) */g,function(t,o,n,i){return n>0&&n+o.length!==i.length&&o.search(e)>-1&&":"!==i.charAt(n-2)&&i.charAt(n-1).search(/[^\s-]/)<0?t.toLowerCase():o.substr(1).search(/[A-Z]|\../)>-1?t:t.charAt(0).toUpperCase()+t.substr(1)})};var i,a,r=[].slice;window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(function(){return e(+new Date)},1e3/60)}),Date.now||(Date.now=function(){return(new Date).valueOf()}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}),window.clone_shallow=function(e){var t,o;o={};for(t in e)o[t]=e[t];return o},RegExp.quote=function(e){return(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},jQuery.fn.disable=function(e){return e=!!e,$(this).each(function(){return $(this).prop("disabled")!==e?$(this).prop("disabled",e):void 0})},function(){var e,t,o,n,i,r,a,s,u,l,c;for(n=null!=(u=window.location.search)?u.substr(1):void 0,r=n.split("&"),o=function(){var o,n,a,s;for(s=[],o=0,n=r.length;n>o;o++)t=r[o],s.push((a=t.split("="),e=a[0],i=a[1],a));return s}(),window.location.query={},c=[],a=0,s=o.length;s>a;a++)l=o[a],e=l[0],i=l[1],c.push(window.location.query[e]=i);return c}(),jQuery.cookie=function(e,t,o){var n,i,r,a,s,u,l,c,h,d;if("undefined"!=typeof t)return o=o||{},null===t&&(t="",o.expires=-1),u="",o.expires&&("number"==typeof o.expires||o.expires.toUTCString)&&("number"==typeof o.expires?(a=new Date,a.setTime(a.getTime()+1e3*60*60*24*o.expires)):a=o.expires,u="; expires="+a.toUTCString()),l=o.path?"; path="+o.path:"",s=o.domain?"; domain="+o.domain:"",c=o.secure?"; secure="+o.secure:"",document.cookie=[e,"=",encodeURIComponent(t),u,l,s,c].join("");if(i=null,document.cookie&&""!==document.cookie)for(r=document.cookie.split(";"),h=0,d=r.length;d>h;h++)if(n=r[h],n=jQuery.trim(n),n.substring(0,e.length+1)===""+e+"="){i=decodeURIComponent(n.substring(e.length+1));break}return i},jQuery.fn.capQueue=function(){var e;return e=$(this).queue("fx"),e&&e.splice(1,e.length),$(this)},jQuery.fn.firework=function(e){var t,o,n,i,r,a,s,u,l,c,h,d,f,p;for(f=this.position(),l=f.top,i=f.left,i+=jQuery(window).width()*Math.random(),l+=jQuery(window).height()*Math.random(),this.dequeue(),p=[],n=d=0;50>d;n=++d)t=6.294*Math.random(),u=Math.min(100,150*Math.random()),c=u*Math.cos(t),h=u*Math.sin(t),r=2*Math.random(),a=5,o=Math.random()*a,s=jQuery("<div>").css({position:"fixed","background-color":e,width:a,height:a,"border-radius":a,top:l,left:i}),"#fff"===e&&s.css("box-shadow","0px 0px 5px #000"),p.push(s.appendTo("body").animate({left:"+="+c*r,top:"+="+h*r,width:o,height:o},{duration:1e3*r,complete:function(){return $(this).remove()}}));return p},jQuery.fn.fireworks=function(e,t){var o,n,i,r,a,s=this;for(null==e&&(e=5),o=0,a=[],i=r=0;e>=0?e>r:r>e;i=e>=0?++r:--r)n=0===i?500:2e3*Math.random(),a.push(this.delay(n).queue(function(){var e;return e=t?t(o):"#"+Math.random().toString(16).slice(2,8),s.firework(e),o++}));return a},$(window).resize(function(){return $(".expando").each(function(){var e,t,o,n,i,r,a,s;for(e=0,s=$(this).find(".add-on, .padd-on"),r=0,a=s.length;a>r;r++)t=s[r],e+=$(t).outerWidth();return i=$(this).width(),o=$(this).find("input, .input"),n=o.hasClass("input")?0:o.outerWidth()-o.width(),Modernizr.csscalc?(o.css("width","-webkit-calc(100% - "+(n+e)+"px)"),o.css("width","-moz-calc(100% - "+(n+e)+"px)"),o.css("width","-o-calc(100% - "+(n+e)+"px)"),o.css("width","calc(100% - "+(n+e)+"px)")):o.width(i-n-e)})}),$(window).resize(),setTimeout(function(){return $(window).resize()},762),setTimeout(function(){return $(window).resize()},2718),setTimeout(function(){return $(window).resize()},6022),function(){var e,t,o;return t=new Date,t.setFullYear(t.getFullYear()+1),t.setHours(0),t.setMonth(0),t.setMinutes(0),t.setSeconds(0),t.setDate(1),o=t-Date.now(),2147483647>o&&setTimeout(function(){return $("body").fireworks(25)},o),e=new Date,e.setHours(16),e.setMinutes(20),e.setSeconds(0),e.setMonth(3),e.setDate(20),o=e-Date.now(),2147483647>o&&o>0&&setTimeout(function(){return Ft("pass the weed, man")},o),e=new Date,e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMonth(8),e.setDate(5),o=e-Date.now(),2147483647>o&&o>0?setTimeout(function(){return j($("<div>").addClass("alert alert-info").html("Today is protobowl developer <b>Ben Vest</b>'s birthday. Send him an email at <code>vestben@gmail.com</code> or something."))},o):void 0}(),a=function(e){var t,o;if(null!=e?e.split:void 0)return o=e.split("."),t=function(){var e,t,n,i,a,s,u,l;for(a=1<=arguments.length?r.call(arguments,0):[],s=0,l=a.length;l>s;s++){for(n=a[s],i=n.split("."),t=0,e=u=0;4>=u;e=++u)"x"!==i[e]&&i[e]!==o[e]&&t++;if(0===t)return!0}return!1},t("129.65.x.x","207.62.x.x","198.188.x.x")?$("a.brand strong").text("Poly"):void 0},i=function(){var e,t,o;return e=new Date,24!==(o=e.getDate())&&25!==o||11!==e.getMonth()?1===e.getMonth()&&0===e.getDay()&&e.getDate()<=7?$("a.brand strong").text("Super"):3===e.getMonth()&&22===e.getDate()?($("body").addClass("earthday"),$("a.brand .motto").text("growing one thing and growing it well")):7===e.getMonth()&&28===e.getDate()?$("a.brand .motto").text("on August 28, 2012, protobowl was first <a href='http://hsquizbowl.org/forums/viewtopic.php?f=123&t=13478'>announced</a>"):5===e.getMonth()&&30===e.getDate()?$("a.brand .motto").text("protobowl's precursor, <a href='https://github.com/polarcuke/its-ac-attack'>its-ac-attack</a> was started June 30, 2012"):6===e.getMonth()&&20===e.getDate()?$("a.brand .motto").text("the first line of protobowl code was written July 20, 2012"):6===e.getMonth()&&4===e.getDate()?($("body").addClass("murrica"),$("a.brand .motto").text("Happy "+(e.getFullYear()-1776)+"th Birthday, America!").click(function(e){return $("body").fireworks(3,function(e){return["#9d0101","#fff","#447ba9"][e]}),e.preventDefault()})):3===e.getMonth()&&1===e.getDate()?($("a.brand").html('<u><b>Quizbowl DB</b></u> <em style="font-size:small">Welcome to Quizbowl DB, the best way to get better at quizbowl!</em>'),$("body").addClass("aprilfools")):(t=new Date,t.setDate(e.getDate()+1),t.setHours(0),t.setMinutes(0),t.setSeconds(0),setTimeout(i,Math.max(100,t-Date.now()))):$("body").addClass("christmas")},i(),("undefined"==typeof console||null===console)&&(window.console={log:function(){return null},warn:function(){return null},debug:function(){return null},time:function(){return null},timeEnd:function(){return null},dir:function(){return null},assert:function(){return null},trace:function(){return null},error:function(){return null}}),Array.prototype.map||(Array.prototype.map=function(e,t){var o,n,i,r,a,s,u;if(i=void 0,o=void 0,r=void 0,"undefined"==typeof this||null===this)throw new TypeError(" this is null or not defined");if(n=Object(this),s=n.length>>>0,"function"!=typeof e)throw new TypeError(e+" is not a function");for(t&&(i=t),o=new Array(s),r=0;s>r;)a=void 0,u=void 0,r in n&&(a=n[r],u=e.call(i,a,r,n),o[r]=u),r++;return o});var s,u,l,h,c;s=null,u=null,l=function(e){var t,o,n,i;e?jQuery.cookie("protoauth",e):"undefined"!=typeof e&&jQuery.cookie("protoauth","");try{i=jQuery.cookie("protoauth").split("&"),n=i[0],t=i[1],u=JSON.parse(decodeURIComponent(t))}catch(r){o=r,u=null}return $("body").toggleClass("authenticated",!!u),$("#userinfo").is(":hidden")||!!u===$("#user").is(":hidden")?$("#userinfo").fadeOut("normal",function(){return u?($("#signin").hide(),$(".user-name").text(u.email),$("#user").show(),$("#userinfo").fadeIn()):($("#signin").show(),$("#user").hide(),$("#userinfo").fadeIn())}):void 0},l(),$(document).ready(function(){var e;return("undefined"!=typeof protobowl_config&&null!==protobowl_config?protobowl_config.auth:void 0)?"undefined"!=typeof navigator&&null!==navigator?null!=(e=navigator.id)?e.watch({loggedInUser:null!=u?u.email:void 0,onlogin:function(e){return s=e,eo()&&ao?co.link({assertion:s,audience:location.protocol+"//"+location.host+"/"}):void 0
},onlogout:function(){return s=null,u&&(Q({verb:"logging out of the current authenticated session"}),c()),l(null)}}):void 0:void 0:void 0}),h=function(e){var t,o;return s=null,t=function(){return Q({verb:"logging in and beginning a new authenticated session"}),"function"==typeof l&&l(e.cookie),c()},"okay"!==(null!=e?e.status:void 0)?(Q({verb:"server rejected login request: "+(null!=e?e.reason:void 0)}),"undefined"!=typeof navigator&&null!==navigator?null!=(o=navigator.id)?o.logout():void 0:void 0):e.cookie?(null!=e?e.exists:void 0)||u||co.score()<100?(u||co.accelerate_cleanup(),t()):n.dialog("<h4>Would you like to transfer your current score to your authenticated account?</h4> <p>This will allow you to play as the same user on multiple computers and allow your score to persist beyond cookie clears. While your score may still be deleted after a period of inactivity in popular rooms, you will be last in line for eviction.<p> <em>Note that if you log out of your current session, you will not be able to play as the current user without logging back in.</em>",[{label:"Don't Transfer","class":"btn",callback:function(){return co.accelerate_cleanup(),t(),!0}},{label:"Transfer to "+e.email,"class":"btn-primary",callback:function(){return co.transfer_account(e.cookie),t(),!0}}]):void 0},c=function(){return vo?(vo.hide_disconnect=!0,vo.socket.disconnect(),wo.users={},vo.socket.reconnect(),vo.hide_disconnect=!1):void 0},$("a[href='#signin']").click(function(e){var t;return"undefined"!=typeof navigator&&null!==navigator&&null!=(t=navigator.id)&&t.request(),e.preventDefault()}),$("a[href='#logout']").click(function(e){var t;return"undefined"!=typeof navigator&&null!==navigator&&null!=(t=navigator.id)&&t.logout(),e.preventDefault()});var d,f=[].indexOf||function(e){for(var t=0,o=this.length;o>t;t++)if(t in this&&this[t]===e)return t;return-1},r=[].slice;d=function(){function e(e,t){this.id=t,this.room=e,this.corrects={},this.wrongs={},this.prompts=0,this.earlyseen=0,this.seen=0,this.streak=0,this.streak_record=0,this.negstreak=0,this.negstreak_record=0,this.history=[],this.time_spent=0,this.last_action=this.room.serverTime(),this.last_session=this.room.serverTime(),this.created=this.room.serverTime(),this.idle=!1,this.times_buzzed=0,this.team="",this.banned=0,this.auth=null,this.moderator=!1,this.bubble=0,this.prefs={typing:!0},this.room.dystopia&&(this.prefs.distraction=!0),this.lock=!1,this.muwave=!1,this.__recent_actions=[],this.__rate_limited=0}return e.prototype.link=function(){return this.room.log("QuizPlayer.link(name) not implemented")},e.prototype.emit=function(){return this.room.log("QuizPlayer.emit(name, data) not implemented")},e.prototype.touch=function(e){var t,o;return this.idle=!1,t=this.room.serverTime(),e||(o=t-this.last_action,6e5>o&&(this.time_spent+=o)),this.last_action=t,this.room.touch(),this.room.check_timeout()},e.prototype.active=function(){return this.online()&&this.room.serverTime()-this.last_action<6e5&&!this.idle},e.prototype.online=function(){return!0},e.prototype.level=function(){var e,t;return e=this.room.acl,"_"===this.id[0]?e.ninja:this.moderator?e.moderator:(null!=(t=this.elect)?t.term:void 0)>this.room.serverTime()?e.elected:this.room.locked()?this.score()>=50?e.fifty:this.score()>0?e.positive:e.baseline:e.unlocked},e.prototype.authorized=function(e){return null==e&&(e=this.room.escalate),"string"==typeof e&&(e=this.room.acl[e]),this.level()>=e},e.prototype.score=function(){var e,t,o,n,i,r;n=0,i=this.room.scoring;for(e in i)r=i[e],o=r[0],t=r[1],n+=(this.corrects[e]||0)*o+(this.wrongs[e]||0)*t;return n},e.prototype.metrics=function(){var e,t,o,n,i,r;return t=.001,n=this.room.scoring,e=function(e){var t,o;o=0;for(t in n)o+=e[t]||0;return o},o={score:this.score(),seen:this.seen,correct:e(this.corrects),wrong:e(this.wrongs)},o.guesses=o.correct+o.wrong,o.precision=o.correct/(o.guesses+t),o.recall=o.correct/(o.seen+t),o.f1=2*o.precision*o.recall/(o.precision+o.recall+t),(null!=(i=this.room)?null!=(r=i.scoring)?r.interrupt:void 0:void 0)&&(o.interrupts=(this.wrongs.interrupt||0)+(this.wrongs.early||0),o.early=this.corrects.early||0),o},e.prototype.reset_score=function(){var e;return e=this.metrics(),this.verb("was reset from "+this.score()+" points ("+e.correct+" correct, "+e.wrong+" wrong, "+e.guesses+" guesses)"),this.negstreak_record=this.negstreak=this.streak_record=this.streak=this.earlyseen=this.seen=0,this.wrongs={},this.corrects={},this.history=[],this.sync(!0)},e.prototype.bookmark=function(e){var t,o;return o=e.value,t=e.id,0},e.prototype.ban=function(){return 1},e.prototype.rate_limited=function(){var e,t,o,n,i,r,a,s,u,l,c,h,d;if(l=function(){var e,t;e=this.room.users,t=[];for(o in e)s=e[o],"_"!==o[0]&&s.active()&&t.push(o);return t}.call(this),e=856,l.length<=2&&(e=612),r=316,u=10,t=this.room.serverTime(),this.__recent_actions=this.__recent_actions.slice(-u),this.__recent_actions.length===u){for(i=0,d=this.__recent_actions,c=0,h=d.length;h>c;c++)a=d[c],i+=a;if(n=t-i/u,u*r/2>n&&this.throttle(),u*e/2>n)return!0}},e.prototype.throttle=function(){var e;return e=this.room.serverTime()+5e3,e-this.__rate_limited>762&&(this.emit("throttle",this.__rate_limited),this.__recent_actions.push(this.room.serverTime())),this.__rate_limited=e},e.prototype.rate_limit=function(){return this.__recent_actions.push(this.room.serverTime()),this.rate_limited()?this.create_tribunal():void 0},e.prototype.reprimand=function(e){var t,o,n;return o=e.user,t=e.reason,this.reprimand_embargo>this.room.serverTime()?(this.notify("can not reprimand anyone for "+Math.ceil((this.reprimand_embargo-this.room.serverTime())/1e3)+" seconds"),void 0):(this.authorized(this.room.acl.moderator)||(this.reprimand_embargo=this.room.serverTime()+6e4,this.sync()),null!=(n=this.room.users[o])?n.emit("reprimand",{trigger:this.id,time:this.room.serverTime(),reason:t}):void 0)},e.prototype.gestapo=function(e){var t,o,n,i;if("string"==typeof e&&this.room.dystopia){for(i=[/ni+gg+e+r/i,/n\s*i\s*g\s*g\s*e\s*r/i,/nigga/i],o=0,n=i.length;n>o;o++)if(t=i[o],e.match(t))return this.ban(3e5),this.sync(!0),!0;return!1}},e.prototype.nominate=function(){var e,t,o,n,i=this;return this.touch(),this.room.escalate>this.room.acl.unlocked?void 0:this.elect_embargo&&this.elect_embargo>this.room.serverTime()?(this.notify("can not run for reelection for another "+Math.ceil((this.elect_embargo-this.room.serverTime())/6e4)+" minutes"),void 0):this.elect?void 0:(e=this.room.serverTime(),n=function(){var e,n;e=this.room.users,n=[];for(t in e)o=e[t],"_"!==t[0]&&o.active()&&!o.prefs.distraction&&n.push(t);return n}.call(this),this.__elect_timeout=setTimeout(function(){return i.verb("got romneyed",!0),i.elect_embargo=i.room.serverTime()+24e4,i.elect=null,i.sync(!0)},6e4),this.elect={votes:[],against:[],time:e,witnesses:n},this.vote_election({user:this.id,position:"elect"}))},e.prototype.create_tribunal=function(e){var t,o,n,i,r,a,s=this;if(null==e&&(e=!1),this.touch(),!this.tribunal){if(t=this.room.serverTime(),i=function(){var e,t;e=this.room.users,t=[];for(o in e)n=e[o],"_"!==o[0]&&n.active()&&!n.prefs.distraction&&t.push(o);return t}.call(this),i.length<=1)return;return this.room.users[null!=(r=this.tribunal)?r.initiator:void 0]&&!this.room.users[null!=(a=this.tribunal)?a.initiator:void 0].authorized("moderator")&&(this.room.users[this.tribunal.initiator].tribunal_embargo=this.room.serverTime()+6e4),this.__tribunal_timeout=setTimeout(function(){var e,t;return s.room.users[null!=(e=s.tribunal)?e.initiator:void 0]&&!s.room.users[null!=(t=s.tribunal)?t.initiator:void 0].authorized("moderator")&&(s.room.users[s.tribunal.initiator].tribunal_embargo=s.room.serverTime()+24e4,s.room.users[s.tribunal.initiator].sync()),s.verb("survived the tribunal",!0),s.tribunal=null,s.sync(!0)},6e4),this.tribunal={votes:[],against:[],time:t,witnesses:i,term:0,initiator:e},this.sync(!0)}},e.prototype.trigger_tribunal=function(e){var t,o;return this.touch(),e&&(null!=(t=this.room)?t.users[e]:void 0)?e===this.id?(this.notify("is somewhat of a masochist"),void 0):this.tribunal_embargo&&this.tribunal_embargo>this.room.serverTime()?(this.notify("can not trigger a ban tribunal for another "+Math.ceil((this.tribunal_embargo-this.room.serverTime())/6e4)+" minutes"),void 0):this.room.users[e].authorized("moderator")?(this.notify("cannot fell a god with a mortal sword"),void 0):(this.verb("created a ban tribunal for !@"+e),null!=(o=this.room.users[e])?o.create_tribunal(this.id):void 0):void 0},e.prototype.ban_user=function(e){var t,o,n;return this.authorized("moderator")?((!(null!=(t=this.room.users[e])?t.banned:void 0)||this.room.serverTime()>(null!=(o=this.room.users[e])?o.banned:void 0))&&this.verb("banned !@"+e+" from /"+this.room.name),null!=(n=this.room.users[e])?n.ban(3e5):void 0):void 0},e.prototype.vote_election=function(e){var t,o,n,i,r,a,s,u,l,c,h,d,p,m,y,g,b,w;if(l=e.user,r=e.position,this.touch(),o=null!=(p=this.room.users[l])?p.elect:void 0){if(!o.term){if(c=o.votes,t=o.against,d=o.witnesses,m=this.id,f.call(d,m)<0)return;if(y=this.id,f.call(c,y)>=0||(g=this.id,f.call(t,g)>=0))return;return"elect"===r?c.push(this.id):"deny"===r?t.push(this.id):this.verb("voted from a diebold machine"),c.length>d.length/2+t.length&&(a=6e4,d=function(){var e,t;e=this.room.users,t=[];for(n in e)s=e[n],"_"!==n[0]&&s.active()&&t.push(n);return t}.call(this),this.room.users[l].elect={impeach:[],witnesses:d,term:this.room.serverTime()+a},this.room.users[l].inaugurate()),u=d.length-t.length-c.length,c.length+u<=d.length/2+t.length&&(this.room.users[l].verb("was not elected",!0),this.room.users[l].elect_embargo=this.room.serverTime()+72e4,this.room.users[l].impeach()),this.room.users[l].sync(!0)}if(o.term>this.room.serverTime()){if(i=o.impeach,d=o.witnesses,b=this.id,f.call(d,b)<0)return;if(w=this.id,f.call(i,w)>=0)return;if("impeach"===r)return i.push(this.id),h=Math.floor(d.length/2+1)-i.length,0>=h?(this.room.users[l].verb("was impeached from office",!0),this.room.users[l].impeach()):this.room.users[l].sync(!0)}}},e.prototype.inaugurate=function(){var e,t=this;if(null!=(e=this.elect)?e.term:void 0)return clearTimeout(this.__elect_timeout),this.__elect_timeout=setTimeout(function(){return t.verb("is no longer commander in chief",!0),t.impeach()},this.elect.term-this.room.serverTime())},e.prototype.impeach=function(){return this.elect=null,clearTimeout(this.__elect_timeout),this.sync(!0)},e.prototype.finish_term=function(){var e;if(null!=(e=this.elect)?e.term:void 0)return this.verb("has finished tenure in office",!0),this.impeach()},e.prototype.vote_tribunal=function(e){var t,o,n,i,r,a,s,u,l,c,h,d,p;if(r=e.user,o=e.position,n=null!=(u=this.room.users[r])?u.tribunal:void 0){if(a=n.votes,t=n.against,s=n.witnesses,l=this.id,f.call(s,l)<0)return;if(c=this.id,f.call(a,c)>=0||(h=this.id,f.call(t,h)>=0))return;return"ban"===o?(a.push(this.id),this.verb("voted to ban !@"+r)):"free"===o?(t.push(this.id),this.verb("voted to free !@"+r)):this.verb("voted with a hanging chad"),a.length>(s.length-1)/2+t.length&&(this.room.users[r].verb("got voted off the island",!0),clearTimeout(this.room.users[r].__tribunal_timeout),this.room.users[r].tribunal=null,this.room.users[r].ban(9e5)),i=s.length-t.length-a.length-1,a.length+i<=(s.length-1)/2+t.length&&(this.room.users[null!=(d=this.room.users[r])?null!=(p=d.tribunal)?p.initiator:void 0:void 0]&&(this.room.users[this.room.users[r].tribunal.initiator].tribunal_embargo=this.room.serverTime()+48e4),this.room.users[r].verb("was freed because of a hung jury",!0),this.room.users[r].tribunal=null,clearTimeout(this.room.users[r].__tribunal_timeout)),this.room.users[r].sync(!0)}},e.prototype.verb=function(e,t){return"_"===this.id.toString()[0]?this.notify(e):(t||this.rate_limit(),this.room.emit("log",{user:this.id,verb:e,time:this.room.serverTime()}))},e.prototype.notify=function(e){return this.emit("log",{user:this.id,verb:e,time:this.room.serverTime(),notify:!0})},e.prototype.disconnect_all=function(){return this.room.log("QuizPlayer::disconnect_all() not implemented")},e.prototype.disconnected=function(){var e;return this.touch(),0===this.sockets.length&&(e=(this.room.serverTime()-this.last_session)/1e3,e>90?this.verb("left the room (logged on "+Math.round(e/60)+" minutes ago)"):e>1?this.verb("left the room (logged on "+Math.round(e)+" seconds ago)"):this.verb("left the room")),this.sync(!0)},e.prototype.echo=function(e,t){return e.avg&&e.std&&e.n&&(this.__latency=[e.avg,e.std,e.n]),t(this.room.serverTime())},e.prototype.buzz=function(e,t){return this.touch(),this.room.qid===e&&this.room.buzz(this.id,t)?this.rate_limit():void 0},e.prototype.guess=function(e){return this.touch(),this.room.guess(this.id,e),this.gestapo(null!=e?e.text:void 0)},e.prototype.command=function(e,t){var o,n;return"auth"===e?(null!=(o=t[0])?o.trim().toLowerCase():void 0)===("function"==typeof this._password?this._password():void 0)?this._apotheify():this.notify("has an invalid password"):"ragequit"===e||"qq"===e||"corgi"===e||"super"===e||"quit"===e||"dog"===e||"cute"===e?this.emit("redirect","http://i.imgur.com/4Dx75Bq.jpg"):"deauth"===e||"unauth"===e?this.cincinnatus():"rename"===e||"name"===e?this.set_name(null!=(n=t[0])?n.trim():void 0):this.notify("no command named `"+e+"` exists")},e.prototype.chat=function(e){var t,o,n,i,a,s,u,l,c,h,d,f,p,m,y;if(h=e.text,n=e.done,i=e.first,c=e.session,this.touch(),"string"==typeof h&&(this.gestapo(h)&&(h="****"),this.authorized(this.room.mute))){if("@$>"===h.substr(0,3)&&n)return p=h.substr(3).trim().split(" "),u=p[0],o=2<=p.length?r.call(p,1):[],this.command(u,o),void 0;if(h=h.slice(0,1e4),a=this.id,"_"===a[0]&&(a="__"+this.name.replace(/\s+/g,"_")),l={text:h,session:c,user:a,first:i,done:n,time:this.room.serverTime()},i){t={};for(s in l)f=l[s],t[s]=f;t.text="(typing)"}if(this.room.serverTime()<this.bubble)return this.emit("chat",l),void 0;if(n||"(typing)"===h)return this.rate_limit(),this.room.emit("chat",l);m=this.room.users,y=[];for(a in m)d=m[a],d.prefs.typing&&!d.muwave?y.push(d.emit("chat",l)):i?y.push(d.emit("chat",t)):y.push(void 0);return y}},e.prototype.skip=function(){return this.touch(),this.room.attempt||this.room.no_skip?void 0:(this.room.new_question(),this.verb("skipped a question"))},e.prototype.next=function(){return this.touch(),this.room.next()},e.prototype.finish=function(){return this.touch(),this.attempt||this.room.no_skip||this.room.time()>=this.room.end_time||this.room.time_freeze?void 0:(this.verb("skipped to the end of a question"),this.room.finish(),this.room.sync())},e.prototype.preempt=function(){return this.touch()},e.prototype.pause=function(){return this.touch(),this.room.no_pause||this.room.time_freeze?void 0:!this.room.attempt&&this.room.time()<this.room.end_time?(this.rate_limit(),this.verb("paused the game"),this.room.freeze(),this.room.sync()):void 0},e.prototype.unpause=function(){var e;return this.touch(),this.room.time_freeze?(this.room.question?this.room.attempt||(e=Math.round((this.room.offsetTime()-this.room.time_freeze)/1e3),e>2?this.verb("resumed the game (paused for "+e+" seconds}"):this.verb("resumed the game"),this.room.unfreeze()):(this.room.new_question(),this.room.unfreeze()),this.room.sync()):void 0},e.prototype.transfer_account=function(){return this.room.log("QuizPlayer.transfer_account(cookie) not implemented")},e.prototype.accelerate_cleanup=function(){return this.score()<=20?this.room.delete_user(this.id):void 0},e.prototype.rtc_signal=function(e){var t;return null!=(t=this.room.users[e.target])?t.emit("rtc",{message:e,source:this.id}):void 0},e.prototype.set_distribution=function(e){var t,o,n,i,r=this;if(this.touch(),this.authorized()&&e){i=[],n=[];for(t in e)o=e[t],0===this.room.distribution[t]&&o>0&&i.push(t),this.room.distribution[t]>0&&0===o&&n.push(t);return this.room.distribution=e,this.room.sync(4),this.room.get_size(function(e){return i.length>0&&r.verb("enabled "+i.join(", ")+" ("+e+" questions)"),n.length>0?r.verb("disabled "+n.join(", ")+" ("+e+" questions)"):void 0})}},e.prototype.set_difficulty=function(e){var t=this;return this.touch(),this.authorized()?(this.room.difficulty=e,this.room.sync(4),this.room.get_size(function(o){return t.verb("set difficulty to "+(e||"everything")+" ("+o+" questions)"),0===o&&t.room.category?t.set_category(""):void 0})):void 0},e.prototype.set_category=function(e){var t=this;return this.touch(),this.authorized()?(this.room.category=e,e||this.room.reset_distribution(),"custom"===e?this.room.sync(4):this.room.sync(1),this.room.get_size(function(o){return"custom"===e?t.verb("enabled a custom category distribution ("+o+" questions)"):t.verb("set category to "+(e.toLowerCase()||"potpourri")+" ("+o+" questions)")})):void 0},e.prototype.set_max_buzz=function(e){return this.touch(),this.authorized()?(this.room.max_buzz!==e&&(e?1===e?this.verb("restricted players and teams to a single buzz per question"):e>1&&this.verb("restricted players and teams to "+e+" buzzes per question"):this.verb("allowed players to buzz multiple times")),this.room.max_buzz=e,this.room.sync(1)):void 0},e.prototype.set_skip=function(e){return this.touch(),this.authorized()?(this.room.no_skip=!e,this.room.sync(1),this.room.no_skip?this.verb("disabled question skipping"):this.verb("enabled question skipping")):void 0},e.prototype.set_pause=function(e){return this.touch(),this.authorized()?(this.unpause(),e?this.verb("enabled pausing questions"):this.verb("disabled pausing questions"),this.room.no_pause=!e,this.room.sync(1)):void 0},e.prototype.set_bonus=function(e){return this.touch(),this.authorized()?(this.room.show_bonus=!!e,this.room.show_bonus?this.verb("enabled showing bonus questions"):this.verb("disabled showing bonus questions"),this.room.sync(1)):void 0},e.prototype.set_speed=function(e){return this.touch(),!this.authorized()||isNaN(e)||0>=e?void 0:(this.room.set_speed(e),this.room.sync(1))},e.prototype.set_duration=function(e){return this.touch(),!this.authorized("ninja")||isNaN(e)||0>=e?void 0:(this.room.answer_duration=e,this.room.set_speed(this.room.rate),this.room.sync(1))},e.prototype.set_prompt_duration=function(e){return this.touch(),!this.authorized("ninja")||isNaN(e)||0>=e?void 0:(this.room.prompt_duration=e,this.room.sync(1))},e.prototype.set_attempt_duration=function(e){return this.touch(),!this.authorized("ninja")||isNaN(e)||0>=e?void 0:(this.room.attempt_duration=e,this.room.sync(1))},e.prototype.set_scoring=function(e){return this.touch(),this.authorized("ninja")?(this.verb("changed scoring matrix"),this.room.scoring=e,this.room.sync(4)):void 0},e.prototype.set_semi=function(e){return this.touch(),this.authorized("ninja")?(e?this.verb("enabled semi-transparent readouts"):this.verb("disabled semi-transparent readouts"),this.room.semi=!!e,this.room.sync(1)):void 0},e.prototype.set_type=function(e){var t=this;return this.touch(),this.authorized("ninja")?"string"!=typeof e?this.notify("error `"+state+"` is not string"):e?(this.room.type=e,this.room.category="",this.room.difficulty="",this.room.sync(4),this.room.get_size(function(o){return t.verb("changed the question type to "+e+" ("+o+" questions)")})):void 0:void 0},e.prototype.set_escalate=function(e){return this.touch(),this.authorized("ninja")?"number"!=typeof e?this.notify("error `"+e+"` is not number"):(this.room.escalate=e,this.room.sync(2),this.verb("changed minimum escalation permission level to `"+e+"`")):void 0},e.prototype.set_mute=function(e){return this.touch(),this.authorized("ninja")?"number"!=typeof e?this.notify("error `"+e+"` is not number"):(this.room.mute=e,this.room.sync(1)):void 0},e.prototype.set_topic=function(e){return this.touch(),this.authorized("ninja")?"string"!=typeof e?this.notify("error `"+state+"` is not string"):(this.room.topic=e,this.room.sync(4)):void 0},e.prototype.set_dystopia=function(e){return this.touch(),this.authorized("ninja")?(this.room.dystopia=e,this.room.sync(4),this.verb("set dystopia mode to "+e)):void 0},e.prototype.pref=function(e,t){return this.touch(),"string"==typeof e&&"toString"!==e&&"toLocaleString"!==e&&"valueOf"!==e&&"hasOwnProperty"!==e&&"isPrototypeOf"!==e&&"propertyIsEnumerable"!==e&&"constructor"!==e?"_"!==e[0]?(this.prefs[e]=t,this.sync(!0)):void 0:void 0},e.prototype.set_team=function(e){return this.touch(),e?this.verb("switched to team "+e):e!==this.name&&this.verb("is playing as an individual"),this.team=e?e.slice(0,100):e,this.sync(!0)},e.prototype.set_idle=function(e){return this.idle=!!e},e.prototype.set_lock=function(e){return this.lock=!!e,this.touch(),this.sync(!0)},e.prototype.set_name=function(e){var t;return this.touch(),this.gestapo(e),(e+"").trim().length>0?(t=140,this.room.dystopia&&(t=30),this.name=e.trim().slice(0,t).replace(/\u202e|\u2606|\u2605|\u269d/g,""),this.sync(!0)):void 0},e.prototype.report_question=function(){return this.verb("QuizPlayer::report_question({id, tags}) not implemented")},e.prototype.tag_question=function(){return this.verb("QuizPlayer::tag_question({id, tags}) not implemented")},e.prototype.change_bold=function(){return this.verb("QuizPlayer::change_bold({id, answer}) not implemented")},e.prototype.report_answer=function(){return this.verb("QuizPlayer::report_answer(data) not implemented")},e.prototype.check_public=function(){return this.verb("QuizPlayer::check_public() not implemented")},e.prototype._apotheify=function(){return this.moderator?void 0:(this.verb("is now an administrator of this room"),this.admin_name=this.name,this.moderator=!0,this.room.sync(2))},e.prototype.cincinnatus=function(){return this.moderator?(this.verb("is no longer an administrator of this room"),this.moderator=!1,this.admin_name="",this.room.sync(2)):void 0},e.prototype.serialize=function(){var e,t,o,n;o={},t=["sockets","room","times_buzzed"];for(e in this)f.call(t,e)<0&&"function"!=(n=typeof this[e])&&"_"!==e[1]&&(o[e]=this[e]);return o},e.prototype.deserialize=function(e){var t,o,n;o=["tribunal","elect","times_buzzed"];for(t in e)n=e[t],"_"!==t[1]&&f.call(o,t)<0&&(this[t]=n);return this.correct||this.interrupts||this.early||this.guesses?(this.verb("was upgraded to the new scoring system"),this.corrects.normal=this.correct,this.wrongs.normal=this.guesses-this.correct,delete this.correct,this.corrects.early=this.early,this.wrongs.early=0,delete this.early,this.corrects.interrupt=0,this.wrongs.interrupt=this.interrupts,delete this.interrupts,delete this.guesses,this.sync(!0)):void 0},e.prototype.update=function(){return 1},e.prototype.sync=function(e){return null==e&&(e=!1),e&&"_"!==this.id[0]?this.room.emit("sync",this.room.sync(this)):this.emit("sync",this.room.sync(this))},e}(),"undefined"!=typeof exports&&null!==exports&&(exports.QuizPlayer=d);var p,m,y,f=[].indexOf||function(e){for(var t=0,o=this.length;o>t;t++)if(t in this&&this[t]===e)return t;return-1};y={category:"$0x40000",difficulty:"segmentation fault",num:"NaN",tournament:"Guru Meditation Cup",question:"This type of event occurs when the queried database returns an invalid question and is frequently indicative of a set of constraints which yields a null set. Certain manifestations of this kind of event lead to significant monetary loss and often result in large public relations campaigns to recover from the damaged brand valuation. This type of event is most common with computer software and hardware, and one way to diagnose this type of event when it happens on the bootstrapping phase of a computer operating system is by looking for the POST information. Kernel varieties of this event which are unrecoverable are referred to as namesake panics in the BSD/Mach hybrid microkernel which powers Mac OS X. The infamous Disk Operating System variety of this type of event is known for its primary color backdrop and continues to plague many of the contemporary descendents of DOS with code names such as Whistler, Longhorn and Chidori. For 10 points, name this event which happened right now.",answer:"error",year:1970,round:"0x080483ba"},m={category:"Mission Accomplished",difficulty:"null",num:"undefined",tournament:"magic smoke",question:"This question has not yet been written.",answer:"failure",year:2003,round:"1"},p=function(){function e(e){null==e&&(e="temporary"),this.name=e,this.type="qb",this.realm=null,this.answer_duration=5e3,this.attempt_duration=8e3,this.prompt_duration=1e4,this.time_offset=0,this.sync_offset=0,this.start_offset=0,this.last_action=0,this.time_spent=0,this.seen=0,this.end_time=0,this.begin_time=0,this.question="",this.value=null,this.answer="",this.info={},this.qid=null,this.timing=[],this.cumulative=[],this.rate=60,this.__timeout={},this.distribution=null,this.freeze(),this.users={},this.difficulty="",this.category="",this.max_buzz=null,this.attempt=null,this.no_skip=!1,this.show_bonus=!1,this.semi=!1,this.no_pause=!1,this.dystopia=0,this.created=this.serverTime(),this.scoring={normal:[10,0],early:[20,-5],interrupt:[10,-5]},this.acl={baseline:100,positive:110,fifty:120,unlocked:200,elected:230,moderator:300,admin:310,ninja:400},this.mute=this.acl.baseline,this.escalate=this.acl.unlocked}return e.prototype.touch=function(){var e,t;return e=this.serverTime(),t=e-this.last_action,18e4>t&&(this.time_spent+=t),this.last_action=e},e.prototype.log=function(e){return this.emit("log",{verb:e})},e.prototype.locked=function(){var e,t,o,n,i,r;if(this.escalate&&this.escalate>this.acl.unlocked)return!0;t=0,o=0,r=this.users;for(e in r)i=r[e],i.active()&&i.active()&&(t++,i.lock&&o++);return n=Math.floor(t/2+1),2>=t?!1:o>=n?!0:!1},e.prototype.admin_online=function(){var e,t,o;o=this.users;for(e in o)if(t=o[e],t.active()&&t.authorized("moderator"))return!0;return!1},e.prototype.active_count=function(){var e,t,o,n;e=0,n=this.users;for(t in n)o=n[t],o.active()&&e++;return e},e.prototype.get_parameters=function(e,t,o){return this.emit("log",{verb:"NOT IMPLEMENTED (async get params)"}),o(["HS","MS"],["Science","Trash"])},e.prototype.count_questions=function(){return this.log("NOT IMPLEMENTED (question counting)")},e.prototype.get_size=function(e,t,o,n){return null==t&&(t=this.type),null==o&&(o=this.difficulty),null==n&&(n=this.category),this.count_questions(t,o,"custom"===n?this.distribution:n,function(t){return e(t)})},e.prototype.get_question=function(e){var t=this;return setTimeout(function(){return"__error_bonus"===t.next_id?e(m):e(y)},10),this.log("NOT IMPLEMENTED (async get question)")},e.prototype.emit=function(){return console.log("room.emit(name, data) not implemented")},e.prototype.reset_distribution=function(){var e,t,o,n=this;return e={},o=function(t){var o,n,i,r,a,s;a={},i=0,n=0,s=0;for(o in e)r=e[o],a[o]=Math.round(r/t),n+=a[o],s+=r,i+=Math.abs(a[o]*t-r);return[a,i/s+n/20]},t=function(){var t,n,i,r,a,s,u,l;a=1/0;for(n in e)s=e[n],a>s&&s>1&&(a=s);return r=a,l=o(r),u=l[0],i=l[1],t=l[2],u},this.get_parameters(this.type,this.difficulty,function(o,i){var r;return r=function(){var o;return o=i.shift(),o?n.count_questions(n.type,n.difficulty,o,function(t){return e[o]=t,r()}):n.distribution=t()},r()})},e.prototype.time=function(){return this.time_freeze?this.time_freeze:this.offsetTime()},e.prototype.offsetTime=function(){return this.serverTime()-this.time_offset},e.prototype.serverTime=function(){return new Date-this.sync_offset},e.prototype.set_time=function(e){return this.time_offset=this.serverTime()-e},e.prototype.freeze=function(){return this.time_freeze=this.time()},e.prototype.unfreeze=function(){return this.time_freeze?(this.set_time(this.time_freeze),this.time_freeze=0):void 0},e.prototype.timeout=function(e,t){return this.clear_timeout(),this.__timeout=setTimeout(t,e)},e.prototype.clear_timeout=function(){return clearTimeout(this.__timeout)},e.prototype.check_timeout=function(){return this.attempt&&this.serverTime()>this.attempt.realTime+this.attempt.duration?(this.clear_timeout(),this.end_buzz(this.attempt.session)):void 0},e.prototype.new_question=function(){var e=this;return this.generating_question=this.serverTime(),this.get_question(function(t){var o,n,i,r,a,s,u,l;t&&t.question&&t.answer||(t=y),delete e.generating_question,e.generated_time=e.serverTime(),e.attempt=null,e.clear_timeout(),e.next_id=t.next||null,e.info={category:t.category,difficulty:t.difficulty,tournament:t.tournament,num:t.num,year:t.year,date:t.date,group:t.group,tags:t.tags,round:t.round},e.value=t.value||null,e.question=t.question.replace(/FTP/g,"For 10 points").replace(/^\[.*?\]/,"").replace(/\n/g," ").replace(/\s+/g," "),e.answer=t.answer.replace(/\<\w\w\>/g,"").replace(/\[\w\w\]/g,""),e.qid=(null!=t?null!=(u=t._id)?u.toString():void 0:void 0)||(null!=t?t.qid:void 0)||(null!=t?t.id:void 0)||"question_id",e.begin_time=e.time()+e.start_offset,r="undefined"!=typeof jo&&null!==jo?jo:require("./lib/syllable").syllables,e.timing=function(){var e,t,o,n;for(o=this.question.split(" "),n=[],e=0,t=o.length;t>e;e++)s=o[e],i=+r(s)||0,s.split(".").length>1&&(i+=s.lenth>2?4:2),s.split(",").length>1&&(i+=2),n.push(1+i);return n}.call(e),e.set_speed(e.rate),o=e.question.indexOf("*")>5,e.seen++,l=e.users;for(n in l)a=l[n],a.times_buzzed=0,a.active()&&(a.seen++,o&&a.earlyseen++),a.history.push(a.score()),a.history=a.history.slice(-30);return e.journal(),e.sync(3)})},e.prototype.set_speed=function(e){var t,o,n,i,r,a,s;if(e)return t=function(e,t){var o,n,i,r,a,s;for(n=0,a=[5].concat(e).slice(0,-1),s=[],i=0,r=a.length;r>i;i++)o=a[i],s.push(n+=Math.round(o*t));return s},a=this.time(),this.cumulative=t(this.timing,this.rate),i=a-this.begin_time,n=this.cumulative[this.cumulative.length-1],o=i/n,s=0,o>1&&(s=i-n,o=1),this.rate=e,this.cumulative=t(this.timing,this.rate),r=this.cumulative[this.cumulative.length-1],this.begin_time=Math.round(a-r*o-s),this.end_time=Math.round(this.begin_time+r+this.answer_duration),isNaN(this.begin_time)&&(this.begin_time=0),isNaN(this.end_time)?this.end_time=0:void 0},e.prototype.finish=function(){return this.emit("finish_question",this.time()),this.set_time(this.end_time)},e.prototype.next=function(){if(!(this.attempt||this.time()<=this.end_time)){if(this.generating_question&&this.serverTime()-this.generating_question>2e3)return delete this.generating_question,void 0;if(!this.generating_question)return this.unfreeze(),this.new_question()}},e.prototype.check_answer=function(){return Math.random()>.8?"prompt":Math.random()>.3},e.prototype.end_buzz=function(e){var t,o,n,i,r,a,s,u,l,c,h,d,f,p,m=this;if((null!=(h=this.attempt)?h.session:void 0)===e){if(l=this.users[null!=(d=this.attempt)?d.user:void 0],!this.attempt||!l)return this.attempt=null,this.sync(),void 0;if(this.attempt.prompt?(this.attempt.done=!0,this.attempt.correct=this.check_answer(this.attempt.text,this.answer,this.question),"prompt"===this.attempt.correct&&(this.attempt.correct=!1),this.sync()):(this.clear_timeout(),this.attempt.done=!0,this.attempt.correct=this.check_answer(this.attempt.text,this.answer,this.question),o=!1,"prompt"===this.attempt.correct&&(o=!0,this.attempt.correct=!1),o===!0&&(this.attempt.correct="prompt",this.sync(),this.attempt.prompt=!0,this.attempt.done=!1,this.attempt.realTime=this.serverTime(),this.attempt.start=this.time(),this.attempt.text=this.attempt.text.trim()+" ",this.attempt.duration=this.prompt_duration,this.timeout(this.attempt.duration,function(){return m.end_buzz(e)}),l.prompts++),this.sync()),this.attempt.done){if(this.unfreeze(),c=this.value,null===c&&(c="normal",this.attempt.interrupt&&(c="interrupt"),this.attempt.early&&(c="early")),c in this.scoring||this.log("Warning: entry `"+c+"` does not exist in the scoring matrix and will not be counted. Please contact info@protobowl.com to resolve this issue."),this.attempt.correct){l.streak++,l.streak_record=Math.max(l.streak,l.streak_record),f=this.users;for(n in f)u=f[n],n!==this.attempt.user&&(u.streak=0);l.negstreak=0,("number"!=typeof l.corrects[c]||isNaN(l.corrects[c]))&&(l.corrects[c]=0),l.corrects[c]++,this.finish()}else{l.streak=0,l.negstreak++,l.negstreak_record=Math.max(l.negstreak,l.negstreak_record),("number"!=typeof l.wrongs[c]||isNaN(l.wrongs[c]))&&(l.wrongs[c]=0),l.wrongs[c]++,t=0,i=0,a={},p=this.users;
for(n in p)u=p[n],"_"!==n[0]&&u.active()&&(a[u.team||n]=a[u.team||n]||0,a[u.team||n]+=u.times_buzzed);for(r in a)s=a[r],s>=this.max_buzz&&this.max_buzz&&t++,i++;this.max_buzz&&t>=i&&this.finish()}return this.journal(),this.attempt=null,this.sync(2)}}},e.prototype.buzz=function(e,t){var o,n,i,r,a,s,u,l=this;if(a=0,!(e in this.users))return!1;s=this.users;for(n in s)i=s[n],(i.team||n)===(this.users[e].team||e)&&(a+=i.times_buzzed);if(this.max_buzz&&this.users[e].times_buzzed>=this.max_buzz)t&&t("THE BUZZES ARE TOO DAMN HIGH"),this.attempt||this.emit("log",{user:e,verb:"has already buzzed"});else if(this.max_buzz&&a>=this.max_buzz)t&&t("THE BUZZES ARE TOO DAMN HIGH"),this.emit("log",{user:e,verb:"is in a team which has already buzzed"});else if(!(null!=(u=this.scoring)?u.interrupt:void 0)&&this.time()<=this.end_time-this.answer_duration)this.emit("log",{user:e,verb:"attempted an illegal interrupt"}),t&&t("THE GAME");else{if(!this.attempt&&this.time()<=this.end_time)return t&&t("http://www.whosawesome.com/"),r=Math.random().toString(36).slice(2),o=this.question.replace(/[^ \*]/g,"").indexOf("*"),this.attempt={user:e,realTime:this.serverTime(),start:this.time(),duration:this.attempt_duration,session:r,text:"",early:-1!==o&&this.time()<this.begin_time+this.cumulative[o],interrupt:this.time()<this.end_time-this.answer_duration,done:!1},this.users[e].times_buzzed++,this.freeze(),this.sync(2),this.timeout(this.attempt.duration,function(){return l.end_buzz(r)}),!0;this.attempt?(this.emit("log",{user:e,verb:"lost the buzzer race"}),t&&t("THE GAME")):(this.emit("log",{user:e,verb:"attempted an invalid buzz"}),t&&t("THE GAME"))}return!1},e.prototype.guess=function(e,t){var o;return(null!=(o=this.attempt)?o.user:void 0)===e?(this.attempt.text=t.text.slice(0,200),t.done?this.end_buzz(this.attempt.session):this.sync(-1)):void 0},e.prototype.sync=function(e){var t,o,n,i,r,a,s,u,l,c,h,d,p,m,y,g,b,w,v=this;for(null==e&&(e=0),n={real_time:this.serverTime()},l=["time_offset","time_freeze","attempt"],c=0,p=l.length;p>c;c++)t=l[c],n[t]=this[t];if(o=["cumulative","users","sync_offset","generating_question"],r=["question","answer","timing","info","generated_time"],a=["realm","created","topic","acl","scoring"],u=["sockets","room"],e.id){s={};for(t in e)f.call(u,t)<0&&"function"!=(g=typeof e[t])&&"_"!==t[0]&&(s[t]=e[t]);return s.online_state=e.online(),n.users=[s],n}if(e>=1)for(t in this)"function"!=typeof this[t]&&f.call(o,t)<0&&f.call(r,t)<0&&f.call(a,t)<0&&"_"!==t[0]&&(n[t]=this[t]);if(e>=2&&(n.users=function(){var e,o;o=[];for(i in this.users)if("_"!==i[0]){s={};for(t in this.users[i])f.call(u,t)<0&&"function"!=(e=typeof this.users[i][t])&&"_"!==t[0]&&(s[t]=this.users[i][t]);s.online_state=this.users[i].online(),o.push(s)}return o}.call(this)),e>=3)for(h=0,m=r.length;m>h;h++)t=r[h],n[t]=this[t];if(e>=4){for(d=0,y=a.length;y>d;d++)t=a[d],n[t]=this[t];return this.distribution||this.reset_distribution(),this.get_parameters(this.type,this.difficulty,function(e,t){var o,i,r,a,s,u;if(n.difficulties=e,n.categories=t,v.difficulty&&(s=v.difficulty,f.call(e,s)<0)&&(v.difficulty=""),v.category&&"custom"!==v.category&&(u=v.category,f.call(t,u)<0&&(v.category="")),v.distribution){for(r=0,a=t.length;a>r;r++)o=t[r],v.distribution[o]=v.distribution[o]||0;for(i in v.distribution)f.call(t,i)<0&&delete v.distribution[i];n.distribution=v.distribution}return v.emit("sync",n)}),this.journal()}if(0>e){b=this.users,w=[];for(i in b)s=b[i],s.muwave||w.push(s.emit("sync",n));return w}return this.emit("sync",n)},e.prototype.journal=function(){return 0},e.prototype.delete_user=function(e){return this.users[e]?("_"!==e[0]&&this.emit("delete_user",e),this.users[e]=null,delete this.users[e]):!1},e.prototype.serialize=function(){var e,t,o,n,i,r;o={},t=["users","attempt","generating_question","acl","_id"];for(e in this)f.call(t,e)<0&&"function"!=(r=typeof this[e])&&"_"!==e[1]&&(o[e]=this[e]);return o.users=function(){var e,t;e=this.users,t=[];for(n in e)i=e[n],t.push(i.serialize());return t}.call(this),o},e}(),"undefined"!=typeof exports&&null!==exports&&(exports.QuizRoom=p);var g=null,w=null,b=null,v=null,k=null,_=null;navigator.mozGetUserMedia?(console.log("This appears to be Firefox"),k="firefox",_=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1],10),g=mozRTCPeerConnection,RTCSessionDescription=mozRTCSessionDescription,RTCIceCandidate=mozRTCIceCandidate,w=navigator.mozGetUserMedia.bind(navigator),createIceServer=function(e,t,o){var n=null,i=e.split(":");if(0===i[0].indexOf("stun"))n={url:e};else if(0===i[0].indexOf("turn"))if(27>_){var r=e.split("?");0===r[1].indexOf("transport=udp")&&(n={url:r[0],credential:o,username:t})}else n={url:e,credential:o,username:t};return n},b=function(e,t){console.log("Attaching media stream"),e.mozSrcObject=t,e.play()},v=function(e,t){console.log("Reattaching media stream"),e.mozSrcObject=t.mozSrcObject,e.play()},MediaStream.prototype.getVideoTracks=function(){return[]},MediaStream.prototype.getAudioTracks=function(){return[]}):navigator.webkitGetUserMedia?(console.log("This appears to be Chrome"),k="chrome",_=parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2],10),createIceServer=function(e,t,o){var n=null,i=e.split(":");return 0===i[0].indexOf("stun")?n={url:e}:0===i[0].indexOf("turn")&&(n={url:e,credential:o,username:t}),n},g=webkitRTCPeerConnection,w=navigator.webkitGetUserMedia.bind(navigator),b=function(e,t){"undefined"!=typeof e.srcObject?e.srcObject=t:"undefined"!=typeof e.mozSrcObject?e.mozSrcObject=t:"undefined"!=typeof e.src?e.src=URL.createObjectURL(t):console.log("Error attaching stream to element.")},v=function(e,t){e.src=t.src}):console.log("Browser does not appear to be WebRTC-capable");var C,x,A,T,D,S,O,I;S=null,I={},$(".webrtc").change(function(){var e,t;if($(".webrtc")[0].checked)D();else if(S){S.stop();for(t in I)e=I[t],e.close();S=null,I={},co.verb("disabled audio chat")}return S?void 0:co.pref("webrtc",!1)}),(window.mozRTCPeerConnection||window.webkitRTCPeerConnection||window.RTCPeerConnection)&&($(".webrtc")[0].checked=!1,$(".checkrtc").slideDown()),x=function(){var e,t,o,n;o=wo.users,n=[];for(e in o)t=o[e],t.prefs.webrtc&&e!==co.id&&(e in I||A(e),n.push(console.log(e,t)));return n},O=function(e,t){var o,n,i,r,a,s,u,l,c;return s=t.session,o=t.candidate,l=t.type,e in I||C(e),r=I[e],"candidate"===l?(console.log("importing ice can",o),o=new RTCIceCandidate(o),r.addIceCandidate(o)):(n=function(e){return console.log("set remote error",e)},i=function(e){return console.log("reply eerrror",e)},("offer"===(c=s.type)||"answer"===c)&&(u=function(){return console.log("set remote woot")},r.setRemoteDescription(new RTCSessionDescription(s),u,n)),"offer"===s.type&&(a=function(t){return r.setLocalDescription(t),co.rtc_signal({target:e,session:t})},r.createAnswer(a,i)),console.log("rtc signal",s,"from",e))},T=function(){var e,t;e=[{url:"stun:stun.l.google.com:19302"}],"firefox"===k&&22>=_||function(){var o,n,i;for(i=[],o=0,n=e.length;n>o;o++)t=e[o],"turn:"===t.url.substr(0,5)&&i.push(1);return i}().length>=1},C=function(e){var t,o,n;return o={iceServers:[{url:"stun:stun.l.google.com:19302"}]},n={optional:[{DtlsSrtpKeyAgreement:!0}]},t=new g(o,n),t.onicecandidate=function(t){var o;if(t.candidate)return o=t.candidate,console.log("icecan",o),co.rtc_signal({target:e,type:"candidate",candidate:{sdpMLineIndex:o.sdpMLineIndex,candidate:o.candidate}})},t.onaddstream=function(e){var t;return console.log("stream add",e.stream),t=document.createElement("audio"),t.autoplay=!0,document.body.appendChild(t),b(t,e.stream)},t.onremovestream=function(){return console.log("remote removed stream")},t.onsignalingstatechange=function(){return console.log("sig cahnge")},t.oniceconnectionstatechange=function(){return console.log("ice state change")},t.addStream(S),I[e]=t},A=function(e){var t,o,n;return o=C(e),n=function(t){return o.setLocalDescription(t),console.log("sess desc",t),co.rtc_signal({target:e,session:t})},t=function(e){return console.log("error creating offer",e)},o.createOffer(n,t)},D=function(){var e,t,o;o=function(e){return S=e,co.pref("webrtc",!0),co.verb("enabled audio chat"),x()},t=function(e){return console.log(e),Q({verb:"error acquiring audio signal from browser"})};try{return w({audio:!0,video:!1},o,t)}catch(n){return e=n,t(e)}};var z,j,N,F,M,q,R,L,U,B,H,P,W,Y,G,K,Q,f=[].indexOf||function(e){for(var t=0,o=this.length;o>t;t++)if(t in this&&this[t]===e)return t;return-1};L=function(e,t,o){var n;return null==o&&(o=5e3),n=$("<div>").addClass("alert").hide(),n.append($("<button>",{"data-dismiss":"alert",type:"button"}).html("&times;").addClass("close")),n.append($("<strong>").text(e)),n.append(" "),n.append(t),setTimeout(function(){return n.slideDown()},10),setTimeout(function(){return n.slideUp().queue(function(){return $(this).dequeue(),$(this).remove()})},o),n},z=function(e,t){var o,n;return null==t&&(t="undefined"!=typeof sync&&null!==sync?sync.name:void 0),$(".bundle .ruling").tooltip("destroy"),n=$(".room-"+(t||"").replace(/[^a-z0-9]/g,"")),0===n.length&&(n=$("#history .bundle.active")),o=n.eq(0).find(".annotations"),0===o.length&&(o=$("#history .annotations").eq(0)),e.prependTo(o),e.hasClass("annoying")&&co.prefs.distraction||e.css("display","none").slideDown(),e},j=function(e){return $(".bundle .ruling").tooltip("destroy"),0!==$("#history .bundle.active .sticky").length?e.css("display","none").prependTo($("#history .bundle.active .sticky")):e.css("display","none").prependTo($("#history .sticky:first")),e.slideDown(),e},K=function(e,t){var o,n,i,r,a,s;return r="undefined"!=typeof wo&&null!==wo?wo.users[e]:void 0,i=$(document.createElement("span")).data("id",e),"__"===e.slice(0,2)?i.text(e.slice(2).replace(/_/g," ")):i.text((null!=r?r.name:void 0)||"[name missing]"),n=function(e){return i.prepend("<i class='icon-"+e+" user-prefix'></i>")},"__"===e.slice(0,2)&&(/ninja/.test(e)?n("magic"):n("bullhorn")),(null!=r?r.banned:void 0)&&r.banned>wo.serverTime()&&n("ban-circle"),(null!=r?r.authorized("moderator"):void 0)&&n("star-empty"),(null!=r?null!=(a=r.prefs)?a.webrtc:void 0:void 0)&&n("microphone"),(null!=r?null!=(s=r.prefs)?s.distraction:void 0:void 0)&&(n("eye-close"),i.attr("title","This user has enabled distraction-free mode.")),(null!=r?r.auth:void 0)&&i.addClass("auth"),(null!=r?r._suffix:void 0)&&(i.append(" "),i.append($('<span style="color: rgb(150, 150, 150)">').text(r._suffix))),o="userhash-"+encodeURIComponent(i.attr("class")+i.html()).replace(/[^a-z0-9]/g,""),i.addClass("username user-"+e),t&&$(".user-"+e+":not(."+o+")").replaceWith(function(){return i.clone()}),i},Y=function(e){var t,o,n,i;return e||($(".tooltip").remove(),$(".banham").each(function(){return Y($(this))})),e&&(o=e.hasClass("full"),n=e.data("uid"),"_"!==n[0]&&eo()&&(e.html(""),wo.users[n]))?(t="",n===co.id?(t="identity",e.append($("<span>",{title:"This post can be used against you",rel:"tooltip"}).addClass("pull-right banhammer").append($("<i>").addClass("icon-legal")))):(co.reprimand_embargo<wo.serverTime()||co.authorized("elected"))&&(t="reprimand"),6e5>(i=Date.now()-wo.users[n].__reprimanded)&&i>1e4&&co.tribunal_embargo<wo.serverTime()&&!wo.admin_online()&&(t="tribunal"),o||co.authorized("moderator")||(wo.users[n].banned>wo.serverTime()?(e.append($("<span>").addClass("pull-right banhammer").css("color","#c83025").append($("<i>").addClass("icon-ban-circle"))),t=""):""===t&&e.append($("<span>").addClass("pull-right banhammer").append($("<i>").addClass("icon-legal")))),("reprimand"===t||o)&&e.append($("<a>",{href:"#",title:"Reprimand this user",rel:"tooltip","data-id":n}).addClass("label label-info pull-right banhammer reprimand").append($("<i>").addClass("icon-thumbs-down"))),("tribunal"===t||o)&&e.append($("<a>",{href:"#",title:"Initiate ban tribunal for this user",rel:"tooltip","data-id":n}).addClass("label label-warning pull-right banhammer make-tribunal").append($("<i>").addClass("icon-legal"))),o||co.authorized("moderator")?e.append($("<a>",{href:"#",title:"Instantly ban this user for 10 minutes",rel:"tooltip","data-id":n}).addClass("label label-important pull-right banhammer instaban").append($("<i>").addClass("icon-ban-circle"))):void 0):void 0},N=function(e,t){var o;return null==t&&(t=!1),o=$("<span>").addClass("banham banham-"+e).attr("data-uid",e),"boolean"==typeof t&&t===!0&&o.addClass("full"),"string"==typeof t&&t&&o.attr("data-reason",t),Y(o),o},U=function(e){var t,o,n,i,r,a,s,u,l,c,h,d,f,p,m,y,g,b,w,v,k,_,C,E;return g=e.session,b=e.text,w=e.user,a=e.done,i=e.correct,l=e.interrupt,s=e.early,f=e.prompt,u=""+w+"-"+g+"-"+(f?"prompt":"guess"),$("#"+u).length>0?c=$("#"+u):(c=$("<p>").attr("id",u).addClass("guess"),f?(p=$("<a>").addClass("label prompt label-info").text("Prompt"),c.append(" "),c.append(p)):(h=$("<span>").addClass("label").text("Buzz"),s||(l?h.addClass("label-important"):h.addClass("label-info")),c.append(h)),c.append(" "),c.append(K(w)),c.append(document.createTextNode(" ")),$("<span>").addClass("comment").appendTo(c),y=$("<a>").addClass("label ruling").hide().attr("href","#").attr("title","Click to Report").data("placement","right"),c.append(" "),c.append(y),t=$("#history .bundle:first .annotations"),0===t.length&&(t=$("#history .annotations:first")),c.css("display","none").prependTo(t),c.slideDown()),a?""===b?c.find(".comment").html("<em>(blank)</em>"):c.find(".comment").text(b):co.muwave?c.find(".comment").html('<em style="color:gray">(typing...)</em>'):c.find(".comment").text(b),a&&(y=c.find(".ruling").css("display","none"),r="","prompt"===i?(y.addClass("label-info").text("Prompt"),r="prompt"):i?(r="correct",y.addClass("label-success").text("Correct"),(null!=(v=wo.users[w])?v.streak:void 0)>3&&wo.active_count()>2&&c.prepend(N(w)),w===co.id&&(d=co.score(),n=function(){var e,t,o,i,r;return o=co.score(),o===d?(setTimeout(n,100),void 0):(e=1e3,t=Math.round(d/e)*e,0!==t?t>0&&t>d&&o>=t&&(null!=(i=wo.scoring)?null!=(r=i.normal)?r[0]:void 0:void 0)<20?($("body").fireworks(10*(t/e)),L("Congratulations","You have over "+t+" points! Here's some fireworks.").addClass("alert-success").insertAfter(y.parents(".bundle").find(".annotations"))):void 0:void 0)},n())):(r="wrong",y.addClass("label-warning").text("Wrong"),(((null!=(k=wo.users[w])?k.negstreak:void 0)>3||(null!=(_=wo.users[w])?_.score():void 0)<0)&&wo.active_count()>2||("function"==typeof Do?Do(b):void 0))&&c.prepend(N(w,"bad language")),w===co.id&&co.id in wo.users&&(d=co.score(),-50>d&&(null!=(C=wo.scoring)?null!=(E=C.normal)?E[0]:void 0:void 0)<20&&L("you suck","like seriously you really really suck. you are a turd.").addClass("alert-info").insertAfter(y.parents(".bundle").find(".annotations")))),y.fadeIn().css("display","inline"),o=wo.answer,m=wo.qid,y.click(function(){return co.report_answer({guess:b,answer:o,ruling:r,qid:m}),L("Reported Answer","You have successfully told me that my algorithm sucks. Thanks, I'll fix it eventually. ").addClass("alert-success").insertAfter(y.parents(".bundle").find(".annotations")),!1}),"guess"===Ct&&Lt("")),c},q=function(e){var o,n,i,r,a,s,u,l,c,h,d,p,m,y,g,b,w,v,k,_,C,E,x;c=e.session,m=e.text,w=e.user,i=e.done,y=e.time,c||(c="auto-"+Math.random().toString(36).slice(3)),s=w+"-"+c,$("#"+s).length>0?u=$("#"+s):(u=$("<p>").attr("id",s).addClass("chat annoying"),u.append($("<span>").addClass("author").append(K(w).attr("title",t(y)))),u.append($("<span>").addClass("timecolon").append(" ("+t(y)+"): ")),u.append(document.createTextNode(" ")),$("<span>").addClass("comment").appendTo(u),z(u,null!=(k=wo.users[w])?null!=(_=k.room)?_.name:void 0:void 0)),v=[],b=/\b((?:https?:\/\/|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/gi,r=m.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(^|\s+)(\/[a-z0-9\-]+\/?[a-z0-9\-]*)(\s+|$)/g,function(e,t,o,n){return t+("<a href='"+o+"'>"+o+"</a>")+n}).replace(b,function(e){var t;return t=e,/:\//.test(e)||(t="http://"+e),/\.(jpe?g|gif|png)$/i.test(e)?"<a href='"+t+"' class='show_image' target='_blank'>"+e+"</a> (click to show) 				<div style='display:none;overflow:hidden' class='chat_image'>					<img src='"+t+"' alt='"+e+"'>				</div>":"<a href='"+t+"' target='_blank'>"+e+"</a>"}).replace(/!@([a-z0-9]+)/g,function(e,t){return v.push(t),K(t).wrap("<span>").parent().addClass("recipient").clone().wrap("<div>").parent().html()}),p={},C=wo.users;for(a in C)g=C[a],p[g.team||"individuals"]=1;d=[];for(h in p)r=r.replace(new RegExp("\\*@("+RegExp.quote(h)+")","g"),function(e,t){return d.push(t),$("<span>").text(t).addClass("team-recipient").wrap("<div>").parent().html()});return i?(u.removeClass("buffer"),E=co.team||"individuals",l=f.call(d,E)>=0||(x=co.id,f.call(v,x)>=0)||"_"===co.id[0]||w===co.id,o="@"!==m[0]||l,l&&u.removeClass("annoying"),""!==m&&o?("@"===m.slice(0,1)&&(d.length>0?u.prepend('<i class="icon-group"></i> '):u.prepend('<i class="icon-user"></i> ')),n="function"==typeof Do?Do(m):void 0,n&&"lobby"===wo.name&&(r=r.replace(/nigger/gi,"******")),u.find(".comment").html(r),w in wo.users&&(n?u.prepend(N(w,"bad language")):m.length>70&&u.prepend(N(w,"spamming")))):(u.find(".comment").html("<em>(no message)</em>"),u.slideUp("normal",function(){return u.remove()}))):$(".livechat")[0].checked&&"(typing)"!==m?(u.removeClass("buffer"),u.find(".comment").html(r)):(u.addClass("buffer"),u.find(".comment").text(" is typing...")),u.toggleClass("typing",!i),u.data("last_update",y)},G=function(e){var t,o,n,i;return n=e.time,i=e.trigger,o=e.reason,setTimeout(function(){return $(".bundle .ruling").tooltip("destroy")},100),t=$("<p>").addClass("log"),t.prepend('<i class="icon-thumbs-down"></i> '),"_"!==(null!=i?i[0]:void 0)&&wo.users[i]?(t.append(K(i)),t.append(" has issued you a warning for "),o?t.append(o):t.append("your behavior"),t.append(" ")):(t.append("your behavior has been reprimanded"),o&&(t.append(" for "),t.append(o))),z(t)},F=function(e){var o,n,i,r,a;return a=e.user,i=e.qid,r=e.time,o=e.answer,setTimeout(function(){return $(".bundle .ruling").tooltip("destroy")},100),n=$("<p>").addClass("log"),n.append(K(a).attr("title",t(r))),n.append(" changed the answer line to "),n.append(o.replace(/\{/g,"<strong>").replace(/\}/g,"</strong>")),$(".bundle.qid-"+i+" .annotations").prepend(n.hide()),n.slideDown()},Q=function(e){var o,n,i,r,a,s,u,l;return s=e.user,u=e.verb,a=e.time,i=e.notify,setTimeout(function(){return $(".bundle .ruling").tooltip("destroy")},100),l="verb-"+s+"-"+u.replace(/[^a-z]/gi," ").split(" ").slice(0,2).join("-"),n=$("<p>").addClass("log annoying"),n.addClass(l),s?(s!==co.id||/skip|pause|resume/.test(u)||n.removeClass("annoying"),i&&n.prepend('<i class="icon-user"></i> '),n.append(K(s).attr("title",t(a))),n.append(" "+u.replace(/!@([a-z0-9]+)/g,function(e,t){return K(t).clone().wrap("<div>").parent().html()}))):n.append(u),(/paused the/.test(u)||/skipped/.test(u)||/category/.test(u)||/difficulty/.test(u)||/ban tribunal/.test(u)||"_"===co.id[0])&&n.prepend(N(s)),o=$(".bundle.active .verb-"+s+"-left-the"),"joined"===u.split(" ")[0]&&o.length>0?(o.slideUp("normal",function(){return $(this).remove()}),Q({user:s,verb:"reloaded the page",time:a}),void 0):(r=$(".bundle.active ."+l),r.length>0?(n.data("count",r.data("count")+1),n.hide(),n.prepend($('<span style="margin-right:5px">').addClass("badge").text(n.data("count")+"x")),r.slideUp("normal",function(){return $(this).remove()}),z(n)):(n.data("count",1),z(n)))},B=function(e){var t;return t=$("<pre>"),t.append(e),$("#history").prepend(t.hide().slideDown())},W=function(){return z($('<iframe width="420" height="315" src="http://www.youtube.com/embed/6bMLrA_0O5I?rel=0" frameborder="0" allowfullscreen></iframe>'))},H=function(){var e,t;return t=$("<span>").html('<b>Like Protobowl?</b> Consider liking us on <a href="https://www.facebook.com/protobowl">Facebook</a>. '),e=$('<iframe src="https://www.facebook.com/plugins/like.php?href=https%3A%2F%2Fwww.facebook.com%2Fprotobowl&amp;send=false&amp;layout=button_count&amp;width=450&amp;show_faces=false&amp;font&amp;colorscheme=light&amp;action=like&amp;height=21&amp;appId=111694105666039" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:150px; height:21px;" allowTransparency="true"></iframe>'),$("body").append(e.css("vertical-align","bottom").hide()),setTimeout(function(){return z($("<p>").append(t).append(e.show()))},1e3)},P=function(){var e;return e=$("<span>").html('<b>Try Protobowl for Mobile!</b> Download the free Protobowl app for <a href="https://itunes.apple.com/us/app/protobowl/id716914125">iOS (iPod Touch, iPhone or iPad)</a> or <a href="https://play.google.com/store/apps/details?id=com.minibit.protobowl">Android</a>.'),setTimeout(function(){return z($("<p>").append(e))},1e3)},M=function(e){var t,o,n,i,r,a,s,u,l,c,h,d,p,m;return n=e.id,u=e.tribunal,l=u.votes,s=u.time,h=u.witnesses,t=u.against,i=u.initiator,d=co.id,f.call(h,d)<0&&"_"!==co.id[0]?void 0:(c=Math.floor((h.length-1)/2+1)-l.length+t.length,r=$("<div>").addClass("alert").addClass("troll-"+n),i&&"_"===i[0]&&(i=""),n===co.id?(i?(r.append(K(i)),r.append(" has complained about your behavior and created a ban tribunal. ")):r.text("Protobowl has detected abnormally high activity from your computer.\n"),r.append(" <strong> Currently "+l.length+" of "+(h.length-1)+" users have voted</strong> ("+c+" more votes are needed to ban you from this room).")):(r.append($("<strong>").append("Is ").append(K(n)).append(" trolling? ")),i?(r.append(K(i)),r.append(" has created a ban tribunal for "),r.append(K(n)),r.append(". ")):(r.append("Protobowl has detected abnormally high rates of activity from "),r.append(K(n)),r.append(". ")),r.append("<br>"),o=$("<button>").addClass("btn btn-small").text("Ban this user"),r.append(o),r.append(" "),a=$("<button>").addClass("btn btn-small").text("Don't ban"),r.append(a),r.append(" <strong> Currently "+l.length+" of "+(h.length-1)+" users have voted</strong> ("+c+" more votes needed)"),o.click(function(){return co.vote_tribunal({user:n,position:"ban"})}),a.click(function(){return co.vote_tribunal({user:n,position:"free"})}),o.add(a).disable((p=co.id,f.call(l,p)>=0||(m=co.id,f.call(t,m)>=0)))),$(".troll-"+n).length>0&&$(".troll-"+n).parents(".active").length>0?$(".troll-"+n).replaceWith(r):($(".troll-"+n).slideUp("normal",function(){return $(this).remove()}),j(r)))},R=function(e){var t,o,n,i,r,a,s,u,l,c,h,d,p,m,y,g,b,w,v;if(i=e.id,o=e.elect,s=$("<div>").addClass("alert alert-info").addClass("elect-"+i),o.term){if(p=o.witnesses,r=o.impeach,y=co.id,f.call(p,y)<0&&"_"!==co.id[0])return;if(d=Math.floor((p.length-1)/2+1)-r.length,wo.serverTime()>o.term)return $(".elect-"+i).slideUp("normal",function(){return $(this).remove()}),void 0;i===co.id?(c=function(){var e;return e=Math.round(Math.max(0,co.elect.term-wo.serverTime())/1e3),$(".term-timeout").text(e),e>0?setTimeout(c,1e3):void 0},s.html("You have access to the settings for <b>the next <span class='term-timeout'>60</span> seconds</b>. \n"),c(),n=$("<button>").addClass("btn btn-small").text("Done"),n.click(function(){return co.finish_term()}),s.append(n)):(a=$("<button>").addClass("btn btn-small").text("Impeach"),a.click(function(){return co.vote_election({user:i,position:"impeach"})}),s.append(a.disable((g=co.id,f.call(r,g)>=0))),s.append(" <strong> "+r.length+" of "+(p.length-1)+" users have voted to impeach </strong>"),s.append(K(i).css("font-weight","bold")),s.append(" ("+d+" more votes needed)"))}else{if(h=o.votes,l=o.time,p=o.witnesses,t=o.against,b=co.id,f.call(p,b)<0&&"_"!==co.id[0])return;d=Math.floor(p.length/2+1)-h.length+t.length,i===co.id?s.append(" <strong>"+h.length+" of "+p.length+" users have voted</strong> ("+d+" more votes are needed)"):(s.append($("<strong>").append("Is ").append(K(i)).append(" trustworthy? ")),s.append("Grant control over the room settings if you believe the motives of "),s.append(K(i)),s.append(" are pure. Elected terms are 1 minute. <br>"),m=$("<button>").addClass("btn btn-small").text("Grant access"),s.append(m),s.append(" "),u=$("<button>").addClass("btn btn-small").text("Deny"),s.append(u),s.append(" <strong> "+h.length+" of "+p.length+" users have voted</strong> ("+d+" more votes needed)"),m.click(function(){return co.vote_election({user:i,position:"elect"})}),u.click(function(){return co.vote_election({user:i,position:"deny"})}),m.add(u).disable((w=co.id,f.call(h,w)>=0||(v=co.id,f.call(t,v)>=0))))}return $(".elect-"+i).length>0?$(".elect-"+i).replaceWith(s):z(s)};var J,V,X,Z,et,tt,ot,nt,it,at,rt,st,ut,lt,ht,ct,dt,ft,pt,mt,yt,gt,wt,bt,vt,kt,_t,$t,Et,f=[].indexOf||function(e){for(var t=0,o=this.length;o>t;t++)if(t in this&&this[t]===e)return t;return-1},r=[].slice;wt=function(){var e,t,o,n,i,r,a,s,u,l,c,h;if($(".custom-category").empty(),wo.distribution){i=0,l=wo.distribution;for(e in l)r=l[e],i+=r;for(c=wo.categories,h=[],s=0,u=c.length;u>s;s++)e=c[s],t=$("<div>").addClass("category-item").appendTo(".custom-category").data("value",e),$("<span>").addClass("name").text(e).appendTo(t),n=$("<div>").addClass("btn-group pull-right dist-picker").appendTo(t),$("<button>").addClass("btn btn-small decrease disabled").append($("<i>").addClass("icon-minus")).appendTo(n),$("<button>").addClass("btn btn-small increase disabled").append($("<i>").addClass("icon-plus")).appendTo(n),$("<a>").attr("href","#").addClass("percentage pull-right").appendTo(t),a=$(t).data("value"),o=wo.distribution[a]/i,$(t).find(".percentage").html(""+Math.round(100*o)+"% &nbsp;").attr("title",wo.distribution[a]+" shares"),$(t).find(".increase").removeClass("disabled"),o>0&&i>1?$(t).find(".decrease").removeClass("disabled"):($(t).find(".decrease").addClass("disabled"),$(t).find(".name").css("font-weight","normal")),o>0?h.push($(t).find(".name").css("font-weight","bold")):h.push(void 0);return h}},st=function(e){var t,o;if(wo.distribution)return t=$(this).parents(".category-item"),o=clone_shallow(wo.distribution),o[e]++,co.set_distribution(o)},at=function(e){var t,o,n,i,r;if(wo.distribution){n=0,r=wo.distribution;for(t in r)i=r[t],n+=i;return o=clone_shallow(wo.distribution),o[e]>0&&n>1?(o[e]--,co.set_distribution(o)):void 0}},$(".category-item .percentage").live("click",function(e){var t,o,n,i,r,a,s,u,l,c;if(wo.distribution){e.preventDefault(),i=$(this).parents(".category-item"),n=$(i).data("value"),s=0,c=wo.distribution;for(o in c)l=c[o],s+=l;if(t=window.prompt("Enter new percentage value for "+n,Math.round(100*wo.distribution[n]/s)),a=parseInt(t,10)/100,!isNaN(a)&&a>=0&&1>=a){if(r=clone_shallow(wo.distribution),r[n]=Math.round(s*a),a>0){u=s-r[n];for(o in r)l=r[o],o!==n&&(r[o]=Math.round(l/s*u))}return co.set_distribution(r)}return alert("invalid value"+t)}}),$(".dist-picker .increase").live("mousedown",function(){var e;return e=$(this).parents(".category-item"),st($(e).data("value"))}),$(".dist-picker .decrease").live("mousedown",function(){var e;return e=$(this).parents(".category-item"),at($(e).data("value"))}),ft=function(){var e,t,o,n,i,r,a,s;for($(".difficulties option").remove(),$(".difficulties")[0].options.add(new Option("Any","")),a=wo.difficulties,o=0,i=a.length;i>o;o++)t=a[o],$(".difficulties")[0].options.add(new Option(t,t));for($(".categories option").remove(),$(".categories")[0].options.add(new Option("Everything","")),$(".categories")[0].options.add(new Option("Custom","custom")),s=wo.categories,n=0,r=s.length;r>n;n++)e=s[n],$(".categories")[0].options.add(new Option(e,e));return wt(),wo.topic?($(".topic .thumbnail").html(wo.topic),$(".topic").slideDown()):$(".topic").slideUp()},yt=function(){var e,t,o;if("custom"===wo.category?(wt(),$(".custom-category").slideDown()):$(".custom-category").slideUp(),$(".categories").val(wo.category),$(".difficulties").val(wo.difficulty),$(".multibuzz").prop("checked",!wo.max_buzz),$(".allowskip").prop("checked",!wo.no_skip),$(".allowpause").prop("checked",!wo.no_pause),$(".adhd").prop("checked",!!co.prefs.distraction),$("body").toggleClass("distraction",!!co.prefs.distraction),$(".settings").is(":hidden")&&($(".settings").slideDown(),$(window).resize()),$(".bundle.active").toggleClass("semi",wo.semi),co.id in wo.users&&"prefs"in wo.users[co.id]&&(!$(".timer-widget").data("hidden")!=!co.prefs.timer_hide&&(co.prefs.timer_hide?($(".timer-widget").data("hidden",!0),$(".timer, .progress").slideUp().queue(function(){return $(this).css("opacity","").dequeue(),$(".expand-timer").fadeIn()})):($(".timer-widget").data("hidden",!1),$(".expand-timer").fadeOut(),$(".timer, .progress").slideDown().animate({opacity:.7}).queue(function(){return $(this).css("opacity","").dequeue()}))),$(".livechat").prop("checked",!!co.prefs.typing),$(".sounds").prop("checked",!!co.prefs.sounds),$(".lock").prop("checked",!!co.lock),$(".teams").val(co.team),$(".microwave").toggle(!co.muwave),co.metrics().guesses>0?$(".reset-score").slideDown():$(".reset-score").slideUp(),co.authorized("moderator")&&!co.authorized("admin")?$(".relinquish-command").slideDown():$(".relinquish-command").slideUp(),e=function(){var e;e=[];for(t in wo.users)e.push(1);return e}().length,e>1?$(".set-team").slideDown():$(".set-team").slideUp()),co.id&&"_"===co.id[0]&&($("a.brand").prop("href","/stalkermode"),$("div.navbar-inner").css("background","rgb(224, 235, 225)"),$(".motto").text("omg did you know im a ninja?")),wo.attempt&&U(wo.attempt),o=Math.round(12e3/wo.rate),(!$(".speed").data("last_update")||new Date-$(".speed").data("last_update")>1337)&&Math.abs($(".speed").val()-o)>1&&$(".speed").val(o),wo.attempt&&wo.attempt.user===co.id){if(wo.attempt.prompt){if("prompt"!==Ct)return Lt("prompt"),$(".prompt_input").val(wo.attempt.text).focus()}else if("guess"!==Ct)return Lt("guess")}else if("guess"===Ct||"prompt"===Ct)return Lt("")},ut=0,pt=function(){var e,t,o;if(!((!wo.time_freeze||wo.attempt)&&wo.time()<wo.end_time&&(requestAnimationFrame(pt),new Date-ut<50)))return ut=+new Date,wo.question?(0!==$(".start-page").length&&$(".start-page").slideUp("normal",function(){return $(this).remove()}),e=$("#history .bundle:first").data("info"),((null!=e?e.generated_time:void 0)!==("undefined"!=typeof wo&&null!==wo?wo.generated_time:void 0)||("undefined"!=typeof wo&&null!==wo?wo.question:void 0)!==(null!=e?e.question:void 0))&&(V(),no(wo.qid,function(e){return An(e)}))):0===$(".start-page").length&&(t=$("<div>").addClass("start-page").hide().prependTo("#history"),o=$("<div>").addClass("well").appendTo(t),$("<button>").addClass("btn btn-success btn-large").text("Start the Question").appendTo(o).click(function(){return co.next()}),t.slideDown()),_t(),mt()},mt=function(){var e,t,o,n,i,r,a,s,u,l,c,h,d;return wo.end_time&&wo.begin_time?$(".timer").removeClass("disabled"):$(".timer").addClass("disabled"),h=Math.max(wo.begin_time,wo.time()),eo()||("undefined"!=typeof vo&&null!==vo?vo.hide_disconnect:void 0)?$(".offline-badge").capQueue().fadeOut():$(".offline-badge").capQueue().fadeIn(),$(".chatbtn").disable(!co.authorized(wo.mute)),wo.time_freeze?($(".buzzbtn").disable(!0),wo.attempt?($(".label.pause").hide(),$(".label.buzz").capQueue().fadeIn()):($(".label.pause").capQueue().fadeIn(),$(".label.buzz").hide(),$(".pausebtn").hasClass("btn-warning")&&($(".pausebtn .resume").show(),$(".pausebtn .pause").hide(),$(".pausebtn").addClass("btn-success").removeClass("btn-warning")))):($(".label.pause").capQueue().fadeOut(),$(".label.buzz").capQueue().fadeOut(),$(".pausebtn").hasClass("btn-success")&&($(".pausebtn .resume").hide(),$(".pausebtn .pause").show(),$(".pausebtn").addClass("btn-warning").removeClass("btn-success"))),h>=wo.end_time&&!wo.time_freeze?$(".label.finished").capQueue().fadeIn():$(".label.finished").capQueue().fadeOut(),h>=wo.end_time?$(".nextbtn").is(":hidden")&&($(".nextbtn").show(),$(".skipbtn").hide()):$(".nextbtn").is(":hidden")||($(".nextbtn").hide(),$(".skipbtn").show()),$(".timer").toggleClass("buzz",!!wo.attempt),$(".primary-bar").toggleClass("bar-warning",!(!wo.time_freeze||wo.attempt)),$(".primary-bar").toggleClass("bar-danger",!!wo.attempt),$(".progress").toggleClass("active",!!wo.attempt),wo.attempt?(o=wo.serverTime()-wo.attempt.realTime,r=wo.attempt.duration-o,s=o/wo.attempt.duration,$(".pausebtn, .buzzbtn, .skipbtn, .nextbtn").disable(!0)):(r=wo.end_time-h,o=h-wo.begin_time,s=o/(wo.end_time-wo.begin_time),$(".skipbtn, .nextbtn").disable(!1),$(".pausebtn").disable(0>r||wo.no_pause),wo.time_freeze||(!(null!=(d=wo.scoring)?d.interrupt:void 0)&&h<wo.end_time-wo.answer_duration?$(".buzzbtn").disable(!0):$(".buzzbtn").disable(0>r||100>o)),0>r&&($(".bundle.active").addClass("revealed"),$t(),u=$(".bundle.active").find(".ruling"),u.data("shown_tooltip")||(u.data("shown_tooltip",!0),t=$(".bundle.active").find(".ruling").first().tooltip({trigger:"manual"}),t.tooltip("show")))),wo.no_skip&&$(".skipbtn").disable(!0),$(".timer-widget").data("hidden")?void 0:(wo.attempt||wo.time_freeze?($(".progress .primary-bar").width(100*s+"%"),$(".progress .aux-bar").width("0%")):(n=100*(1-wo.answer_duration/(wo.end_time-wo.begin_time)),$(".progress .primary-bar").width(Math.min(100*s,n)+"%"),$(".progress .aux-bar").width(Math.min(100-n,Math.max(0,100*s-n))+"%")),r=Math.max(0,r),c="",0>r&&(c="+"),l=Math.abs(r)/1e3,isNaN(l)?($(".timer .face").text("00:00"),$(".timer .fraction").text(".0")):(e=(l%1).toFixed(1).slice(1),$(".timer .fraction").text(e),i=l/60,a=function(e){var t;
for(t=Math.floor(e).toString();t.length<2;)t="0"+t;return t},$(".timer .face").text(c+a(i)+":"+a(l%60))))},rt=function(e){var t,o;return e?(o=0,o=e.members?Vt(function(){var o,n,i,r;for(i=e.members,r=[],o=0,n=i.length;n>o;o++)t=i[o],r.push(rt(t));return r}()):co.prefs.movingwindow?e.score()-[0].concat(e.history).slice(-co.prefs.movingwindow)[0]:e.score(),1335===o?1337:o):0},bt=function(){var e,t,o,n,i,r;o=0,t=0,r=wo.users;for(e in r)i=r[e],i.active()&&i.active()&&(t++,i.lock&&o++);return n=Math.floor(t/2+1),2>=t||wo.escalate>=wo.acl.moderator?$(".lockvote").slideUp():($(".lockvote").slideDown(),n>o?$(".lockvote .electorate").text(""+(n-o)+" needed"):$(".lockvote .electorate").text(""+o+"/"+t+" votes")),$(".lockvote .status_icon").removeClass("icon-lock icon-unlock icon-flag"),$(".request-access button").disable(!!co.elect),$(".globalsettings").toggleClass("escalate",!(wo.escalate>wo.acl.unlocked)),co.authorized()?(wo.locked()?$(".lockvote .status_icon").addClass("icon-flag"):$(".lockvote .status_icon").addClass("icon-unlock"),$(".globalsettings").removeClass("locked"),$(".globalsettings .checkbox, .globalsettings .expando").find("select, input").disable(!1)):($(".lockvote .status_icon").addClass("icon-lock"),$(".globalsettings").addClass("locked"),$(".globalsettings .checkbox, .globalsettings .expando").find("select, input").disable(!0))},gt=function(){var e,t,o,n,i,r,a,s,u,l,c,h,d,p,m,y,g,b,w,v,k,_,C,E,x,T,A,D,S,O,z,I,j,N,F,q,L,U,B,H,P,W,Y,G,Q,J,V;if(wo.users){D={},A="",w={},H=wo.users;for(c in H)O=H[c],w[O.name]||(w[O.name]=[]),w[O.name].push(c);for(b in w)if(h=w[b],h.length>1)for(C=h.sort(function(e,t){return wo.users[e].last_session-wo.users[t].last_session}),v=j=0,P=C.length;P>=0?P>j:j>P;v=P>=0?++j:--j)wo.users[C[v]]._suffix="#"+(v+1);else delete wo.users[h[0]]._suffix;W=wo.users;for(c in W)O=W[c],O.team&&("t-"+O.team in D||(D["t-"+O.team]=[]),D["t-"+O.team].push(O.id),A+=O.team+O.id),K(O.id,!0),O.tribunal?M(O):($(".troll-"+O.id).slideUp("normal",function(){return $(this).remove()}),O.elect?R(O):$(".elect-"+O.id).slideUp("normal",function(){return $(this).remove()}));if(bt(),$(".teams").data("teamhash")!==A){$(".teams").data("teamhash",A),$(".teams").empty(),$(".teams")[0].options.add(new Option("Individual",""));for(x in D)y=D[x],x=x.slice(2),$(".teams")[0].options.add(new Option(""+x+" ("+y.length+")",x));$(".teams")[0].options.add(new Option("Create Team","__create")),co.id in wo.users&&$(".teams").val(wo.users[co.id].team)}if(d=$(".leaderboard tbody"),u=function(e){var t;return t=e.created||e.members[0].created,rt(e)+(wo.serverTime()-t)/1e15},s=function(){var e,t;e=wo.users,t=[];for(c in e)O=e[c],t.push(O);return t}(),z=s.length,T=0,$(".teams").val()||"__"===co.id.slice(0,2)){s=function(){var e;e=[];for(x in D)y=D[x],x=x.slice(2),o={room:wo},T++,o.members=function(){var e,t,o;for(o=[],e=0,t=y.length;t>e;e++)m=y[e],o.push(wo.users[m]);return o}(),o.metrics=function(){var e,t,n,i,r,a,s,u,l,c;for(e={},l=o.members,r=0,s=l.length;s>r;r++)for(n=l[r],c=n.metrics(),i=a=0,u=c.length;u>a;i=++a)t=c[i],e[t]||(e[t]=0),e[t]+=i;return e},o.name=x,o.id="team-"+escape(x).toLowerCase().replace(/[^a-z0-9]/g,""),e.push(o);return e}(),Y=wo.users;for(c in Y)O=Y[c],O.team||s.push(O)}for(s=s.sort(function(e,t){return u(t)-u(e)}),k=1,p=null,I=N=0,L=s.length;L>N;I=++N)O=s[I],s[I-1]&&rt(O)<rt(s[I-1])&&k++,O.rank=k,O.position=I,!p&&(G=wo.users[co.id],f.call(O.members||[O],G)>=0)&&(p=O);for(d.find(".refreshed").removeClass("refreshed"),r=function(e,t){var o,n,i,a,s,l,c,h,p,y,g,w,v;if(null==t&&(t=!1),e){if(i=$(".row-"+e.id),s=i.length>0?i.first().empty():$("<tr>").addClass("row-"+e.id),s.addClass("refreshed").data("entity",e).appendTo(d).click(function(){return 1}),n=$("<span>").addClass("badge pull-right").text(rt(e)),y=wo.users[co.id],f.call(e.members||[e],y)>=0)n.addClass("badge-info").prop("title","You");else{for(a=0,o=0,g=e.members||[e],l=0,h=g.length;h>l;l++)m=g[l],m.online()&&(m.active()?o++:a++);o>0?n.addClass("badge-success").prop("title","Online"):a>0&&n.addClass("badge-warning").prop("title","Idle")}if(t?(s.addClass("subordinate"),$("<td>").addClass("rank").appendTo(s)):$("<td>").addClass("rank").append(e.rank).appendTo(s),$("<td>").addClass("score").append(n).appendTo(s),b=$("<td>").appendTo(s),$("<td>").addClass("negs").text(e.metrics().interrupts).appendTo(s),e.members){for(b.append($("<span>").text(e.name).css("font-weight","bold")).append(" ("+e.members.length+")"),w=e.members.sort(function(e,t){return u(t)-u(e)}),v=[],c=0,p=w.length;p>c;c++)e=w[c],v.push(r(e,!0));return v}return b.append($("<span>").append(K(e.id)))}},t=3,e=2,a=null,_=0,S=t+2*e,l=F=0;t>=0?t>F:F>t;l=t>=0?++F:--F)l<s.length&&(r(s[l]),_++);if(s.length>t&&(a=$("<tr>").addClass("ellipsis refreshed").appendTo(d)),p&&p.position>=t+2*e&&!co.prefs.leaderboard)for(n=Math.min(s.length,p.position+e)-(p.position-e),l=q=Q=p.position-e,J=p.position+e;J>=Q?J>q:q>J;l=J>=Q?++q:--q)l>=0&&l<s.length&&(r(s[l]),_++);else{for(l=U=t;S>=t?S>U:U>S;l=S>=t?++U:--U)l>=0&&l<s.length&&(r(s[l]),_++);if(co.prefs.leaderboard)for(l=B=S,V=s.length;V>=S?V>B:B>V;l=V>=S?++B:--B)r(s[l])}return d.find("tr:not(.refreshed)").remove(),a&&(E="(<b>"+(s.length-_)+"</b> hidden)",co.prefs.leaderboard&&(E="(hide <b>"+(s.length-_)+"</b>)"),g=$("<span>").css("position","relative").html(" <span class='badge badge-success'>"+wo.active_count()+"</span> active <span class='badge'>"+z+"</span> users"),i=$("<td colspan=4>").appendTo(a).append($("<span>").html(E)).append(" ").append(g)),z>1&&(eo()||("undefined"!=typeof vo&&null!==vo?vo.hide_disconnect:void 0))?$(".leaderboard").is(":hidden")&&($(".leaderboard").slideDown(),$(".singleuser").slideUp()):wo.users[co.id]&&($(".singleuser .stats").empty().append(et(wo.users[co.id],!!$(".singleuser").data("full"))),$(".singleuser").is(":hidden")&&($(".leaderboard").slideUp(),$(".singleuser").slideDown())),X()}},lt=0,X=function(){var e,t,o,n;if(eo()&&!co.muwave){e=0,n=wo.users;for(t in n)o=n[t],o.online()&&wo.serverTime()-o.last_action<6e5&&e++;if(1===e){if(Date.now()-lt<6e4)return;return lt=Date.now(),co.check_public("",function(e){var t,o,n,i,r;r=[];for(t in e)n=e[t],n>0&&t!==wo.name&&r.push(t);return r.sort(function(t,o){return e[o]-e[t]}),r.length>0?(i=function(){var n,i,a;for(a=[],n=0,i=r.length;i>n;n++)t=r[n],o=t.replace(/\/lobby$/g,""),a.push(o.link("/"+t)+(" ("+e[t]+") "));return a}(),$(".foreveralone .roomlist").html(i.join(" or ")),$(".foreveralone").slideDown()):$(".foreveralone").slideUp()})}return $(".foreveralone").slideUp()}},et=function(e,t){return e.members?tt(e,t):ot(e,t)},ot=function(t,o){var n,i,a,s,u,l,c;return l=$("<div>").addClass("pseudotable"),u=function(e,t){return $("<div>").addClass("pseudorow").appendTo(l).append($("<span>").addClass("left").text(e)).append($("<span>").addClass("right").append(t))},n=function(){var e;return e=1<=arguments.length?r.call(arguments,0):[],u.apply(null,e).addClass("full").toggle(o)},s=function(e,t){return" <span class='mini-stat' title='"+e+"'> / "+t+"</span>"},a=t.metrics(),u("Score",$("<span>").addClass("badge").text(rt(t))),u("Correct",a.correct+s("Current Streak",t.streak)+s("Streak Record",t.streak_record)),("undefined"!=typeof wo&&null!==wo?null!=(c=wo.scoring)?c.interrupt:void 0:void 0)?(u("Interrupts",a.interrupts+s("Current Streak",t.negstreak)+s("Streak Record",t.negstreak_record)),n("Early",a.early+s("Powermarked Seen",t.earlyseen))):u("Incorrect",a.wrong+s("Current Streak",t.negstreak)+s("Streak Record",t.negstreak_record)),u("Seen",t.seen+s("Guesses",a.guesses)),t.team&&u("Team",t.team),t.admin_name&&u("Auth",t.admin_name),n("ID",t.id.slice(0,10)),n("Last Seen","<span style='font-size:x-small'>"+e(t.last_action)+"</span>"),o&&t.id!==co.id&&co.authorized("moderator")&&(i=$("<span>"),i.append(N(t.id,!0)),u("Admin",i)),l},tt=function(e,t){var o,n,i;return n=$("<div>").addClass("pseudotable"),o=function(e,t){return $("<div>").addClass("pseudorow").appendTo(n).append($("<span>").addClass("left").text(e)).append($("<span>").addClass("right").append(t))},o("Score",$("<span>").addClass("badge").text(rt(e))),o("Correct",Vt(function(){var t,o,n,r;for(n=e.members,r=[],t=0,o=n.length;o>t;t++)i=n[t],r.push(i.metrics().correct);return r}())),wo.interrupts&&(o("Interrupts",Vt(function(){var t,o,n,r;for(n=e.members,r=[],t=0,o=n.length;o>t;t++)i=n[t],r.push(i.metrics().interrupts);return r}())),t&&o("Early",Vt(function(){var t,o,n,r;for(n=e.members,r=[],t=0,o=n.length;o>t;t++)i=n[t],r.push(i.metrics().early);return r}()))),o("Guesses",Vt(function(){var t,o,n,r;for(n=e.members,r=[],t=0,o=n.length;o>t;t++)i=n[t],r.push(i.metrics().guesses);return r}())),o("Members",e.members.length),n},Z=function(){return nt(jQuery.extend(jQuery.extend(!0,{},wo.info),{qid:wo.qid,question:wo.question,generated_time:wo.generated_time,answer:wo.answer}))},V=function(){var e,t,o,n,i,r,a;if(wo.question&&wo.generated_time){if(t=15,Ot()&&(t=1),$(".bundle .ruling").tooltip("destroy"),$("#history .bundle").slice(t).find(".annotations").slideUp("normal",function(){return $(this).remove()}),$("#history .bundle").slice(t).slideUp("normal",function(){return $(this).is(".bookmarked")?($("#bookmarks").prepend($(this).slideDown()),$("#bookmarks .bundle").length?$("#whale").slideDown():void 0):$(this).remove()}),i=$("#history .bundle").first(),$(".bundle").removeClass("active"),i.find(".breadcrumb").click(function(){return 1}),e=Z().width($("#history").width()),e.addClass("active"),$("#history").prepend(e.hide()),kt(),$(".chat.typing").each(function(){var t,o;return t=$(this),wo.serverTime()-t.data("last_update")>2e4?(t.removeClass("typing"),void 0):(o=t.clone().insertBefore(t),t.appendTo(e.find(".annotations")),o.slideUp("normal",function(){return $(this).remove()}))}),e.slideDown("normal").queue(function(){return e.width("auto"),$(this).dequeue()}),i.find(".readout").length>0){for(n=i.find(".readout .well>span"),r=0,a=n.length;a>r;r++)o=n[r],$(o).data("text")&&(o.childNodes[0].nodeValue=$(o).data("text"));i.find(".readout .well").append(n.contents()),n.remove(),i.find(".readout")[0].normalize(),i.queue(function(){return i.find(".readout").slideUp("normal"),$(this).dequeue()})}return $t()}},it=function(e){var t,o,n,i,r,a,s,u,l,c,h,d,f,p,m,y,g,b,w,v,k,_,C,E,x,T,A,D,S,O,z,I,j,N,F,q,M,R,U,B,H,P;for(l=$("<div>").addClass("alert alert-block alert-info report-form"),l.append($("<button>",{"data-dismiss":"alert",type:"button"}).html("&times;").addClass("close")),c=$("<form>"),c.addClass("form-horizontal").appendTo(l),w=$("<div>").addClass("control-group").appendTo(c),w.append($("<label>").addClass("control-label").text("Description")),a=$("<div>").addClass("controls").appendTo(w),R=["Wrong category","Incorrectly bolded","Change tags","Broken question"],D=0,I=R.length;I>D;D++)m=R[D],a.append($("<label>").addClass("radio").append($("<input type=radio name=description>").val(m.split(" ")[1].toLowerCase())).append(m));for(C=$("<button>",{type:"submit"}).addClass("btn btn-primary").text("Submit"),c.find(":radio").change(function(){return"category"===c.find(":radio:checked").val()?(s.slideDown(),$(i).trigger("change")):s.slideUp(),"bolded"===c.find(":radio:checked").val()?(t.slideDown(),C.disable(h())):t.slideUp(),"question"===c.find(":radio:checked").val()?(r.slideDown(),C.disable(!1)):r.slideUp(),"tags"===c.find(":radio:checked").val()?(T.slideDown(),C.disable(!1)):T.slideUp()}),T=$("<div>").addClass("control-group").appendTo(c).hide(),T.append($("<label>").addClass("control-label").text("Tags")),x=$("<select>"),T.append($("<div>").addClass("controls").append(x)),E={Science:["Biology","Chemistry","Physics","Math","Geology","Astronomy"],History:["American","Ancient","European","World"],"Fine Arts":["Art","Music","Other"],Literature:["American","European","Language Arts","World"],"Social Science":["Anthropology","Economics","Geography","Psychology"],Trash:["Film","Sports","Games","TV","Music"]},x.append(new Option("None","")),U=E[e.category]||[],S=0,j=U.length;j>S;S++)n=U[S],x.append(new Option(n));for(s=$("<div>").addClass("control-group").appendTo(c),s.append($("<label>").addClass("control-label").text("Category")),r=$("<div>").addClass("control-group").appendTo(c).hide(),r.append($("<label>").addClass("control-label").text("Comment")),g=$("<input type=text>").attr("placeholder","What needs to be fixed"),r.append($("<div>").addClass("controls").append(g)),t=$("<div>").addClass("control-group").appendTo(c).hide(),t.append($("<label>").addClass("control-label").text("Answer")),p=$("<ul>").addClass("nav nav-pills emboldinator"),t.append($("<div>").addClass("controls").append(p)),k=e.answer.replace(/([\{\}\[\]\(\)\-])/g,"`$1`").replace(/\ +/g," ` ").replace(/\ +/g," ").split("`"),u=!1,y=[],O=0,N=k.length;N>O;O++)v=k[O],"{"===v?u=!0:"}"===v?u=!1:v&&y.push([u,v]);for(h=function(){var t;return t=b(),console.log(t),t===e.answer?!0:-1===t.indexOf("{")?!0:!1},b=function(){return p.find("li a").map(function(){var e,t,o;return $(this).hasClass("bold")?(o=$(this).text(),t=o.match(/^\s*/)[0],e=o.match(/\s*$/)[0],""+t+"{"+o.trim()+"}"+e):$(this).text()}).toArray().join("~").replace(/~/g,"").replace(/\s+/g," ").replace(/\}\s*\{/g," ").replace(/\s([\]\)])/g,"$1").replace(/([\[\(])\s/g,"$1")},z=0,F=y.length;F>z;z++)B=y[z],f=B[0],A=B[1],d=$("<a>").toggleClass("bold",f).appendTo($("<li>").appendTo(p)).text(A).attr("href","#"),"["===(H=A.trim())||"]"===H||";"===H||","===H||"("===H||")"===H||'"'===H||""===H||"”"===H||"“"===H||"-"===H?(" "===A&&d.hide(),d.removeClass("bold").addClass("unboldable").click(function(){return!1})):d.click(function(){var e;return $(this).toggleClass("bold"),e=b(),C.disable(h()),!1});for(i=$("<select>"),s.append($("<div>").addClass("controls").append(i)),P=wo.categories,M=0,q=P.length;q>M;M++)n=P[M],i.append(new Option(n));return $(i).change(function(){return C.disable(i.val()===e.category)}),i.val(e.category),$(i).change(),_=$("<div>").addClass("control-group").appendTo(c),o=$("<button>").addClass("btn").text("Cancel").click(function(e){return l.slideUp("normal",function(){return $(this).remove()}),e.stopPropagation(),e.preventDefault()}),$("<div>").addClass("controls").appendTo(_).append(C).append(" ").append(o),$(c).submit(function(){var t;return t=c.find(":radio:checked").val(),"bolded"===t?co.change_bold({id:e.qid,answer:b()}):"tags"===t?""===$(x).val()?co.tag_question({id:e.qid,tags:[]}):co.tag_question({id:e.qid,tags:[$(x).val()]}):("category"===t&&(e.fixed_category=i.val()),e.describe=t,e.comment=g.val(),co.report_question(e)),L("Reported Question","Protobowl has a new answer checking algorithm (finally!), it takes into account which words are bolded in the answer line to determine what to accept, prompt or reject. Please hit Edit and revise the bolding.").addClass("alert-success").insertAfter(l.parent().find(".annotations")),l.slideUp("normal",function(){return $(this).remove()}),!1}),a.find("input:radio")[0].checked=!0,l},nt=function(e){var t,o,n,i,r,a,s,u,l,c,h,d,f;if(n=$("<div>").addClass("bundle").addClass("qid-"+e.qid),n.toggleClass("semi",wo.semi),n.data("info",e),o=$("<ul>"),u=$("<a>",{href:"#",rel:"tooltip",title:"Bookmark this question"}).addClass("bookmark").click(function(t){return t.stopPropagation(),t.preventDefault(),t.shiftKey?no(e.qid,function(t){return bo(e.qid,t.bookmarked+1)}):n.hasClass("bookmarked")?bo(e.qid,0):bo(e.qid,1)}),"function"==typeof Xt&&Xt(e.qid),u.addClass("icon-star-empty"),o.append($("<li>").addClass("pull-right").append(u)),i=function(e){var t;return o.find("li:not(.pull-right)").last().append($("<span>").addClass("divider").text("/")),t=$("<li>").text(e).appendTo(o)},e.tournament&&e.date?i(e.date):e.tournament&&e.year?i(e.year+" "+e.tournament):e.year?i(e.year):e.tournament&&i(e.tournament),i(e.difficulty),i(e.category),e.group&&i(e.group).css("font-weight","bold"),e.tags)for(f=e.tags,h=0,d=f.length;d>h;h++)l=f[h],i(l);return o.find("li").last().append($("<span>").addClass("divider hidden-phone hidden-offline edit-button").text("/")),o.append($("<li>").addClass("clickable hidden-phone hidden-offline edit-button").text("Edit").click(function(t){return n.find(".report-form").length>0||it(e).insertBefore(n.find(".annotations")).hide().slideDown(),t.stopPropagation(),t.preventDefault()})),t=$("<li>").addClass("pull-right answer"),r=$("<li>").addClass("pull-right answer"),a=vt(e.answer),-1===(e.answer+"").indexOf("{")?(t.text(e.answer).css("font-weight","bold"),r.text(a).css("font-weight","bold")):(t.html(e.answer.replace(/\{/g,'<span class="bold">').replace(/\}/g,"</span>")),r.html(a.replace(/\{/g,'<span class="bold">').replace(/\}/g,"</span>"))),r.data("actual_answer",t),o.append(r),s=$("<div>").addClass("readout"),c=$("<div>").addClass("well").appendTo(s),c.append($("<span>").addClass("unread").text(e.question)),n.append($("<ul>").addClass("breadcrumb").append(o)).append(s).append($("<div>").addClass("sticky")).append($("<div>").addClass("annotations"))},$t=function(){return $(".bundle").not(".active").add(".bundle.revealed").find(".answer").not(".done").replaceWith(function(){return $(this).data("actual_answer").addClass("done")})},ct=null,dt=-1,_t=function(){var e,t,o,n,i,r,a;if(wo.question&&wo.timing&&ct){for(n=wo.time()-wo.begin_time,t=Math.max(0,dt),e=t;n>wo.cumulative[e];)e++;if(t>e)for(i=r=e;t>=e?t>r:r>t;i=t>=e?++r:--r)ct[i].className="unread";for(i=a=t;e>=t?e>a:a>e;i=e>=t?++a:--a)ct[i].className="",o=$(ct[i]).data("text"),o&&(ct[i].childNodes[0].nodeValue=o);return dt=e-1}},Et={},ht={},J=function(){var e,t,o,n,i,r,a;for(o=$("<div>").addClass("well"),t=$("<div>").css("overflow","hidden").css("width",0).css("height",0).appendTo("body").append(o),i=$("<span>").appendTo(o),e=a=33;126>a;e=++a)n=String.fromCharCode(e),i.text(n),r=i.width(),Et[r]=n,ht[n]=r;return t.remove()},vt=function(e){var t,o;return ht.x>0||J(),o=function(){var o,n,i;for(i=[],o=0,n=e.length;n>o;o++)t=e[o],t in ht?i.push(Et[ht[t]]):i.push(t);return i}(),o.join("")},kt=function(){var e,t,o,n,i,r,a,s,u,l,c,h,d,p,m,y,g;if(wo.question&&wo.timing&&(d=wo.question.split(" "),o=wo.question.replace(/[^ \*]/g,"").indexOf("*"),e=$("#history .bundle.active"),l=e.data("starts")||[],c=e.data("stops")||[],u=e.find(".readout .well"),0!==u.length)){for(u.data("spots",l.join(",")),t=u.children(),i=[],r=e.data("finish_point"),a=p=0,y=d.length;y>=0?y>p:p>y;a=y>=0?++p:--p)n=$("<span>").addClass("unread"),-1!==d[a].indexOf("*")?n.append(" <span class='inline-icon'><span class='asterisk'>"+d[a]+"</span><i class='label icon-white icon-asterisk'></i></span> "):(h=d[a],n.data("text",h+" "),wo.semi?n.append(h+" "):n.append(vt(h)+" ")),f.call(l,a)>=0?(s="label-important",a===d.length-1&&(s="label-info"),-1!==o&&o>a&&(s="label"),n.append(" <span class='inline-icon'><i class='label icon-white icon-bell  "+s+"'></i></span> ")):f.call(c,a)>=0?n.append(" <span class='inline-icon'><i class='label icon-white icon-pause label-warning'></i></span> "):r&&a===r&&n.append(" <span class='inline-icon'><i class='label icon-white icon-forward label-info'></i></span> "),i.push(n);for(a=m=0,g=d.length;g>=0?g>m:m>g;a=g>=0?++m:--m)t.eq(a).html()===i[a].html()?t.eq(a).addClass("unread"):t.eq(a).length>0?t.eq(a).replaceWith(i[a]):u.append(i[a]);return ct=u[0].childNodes,dt=-1,_t()}};var Ct,xt,At,Tt,Dt,St,Ot,It,zt,jt,Nt,Ft,Mt,qt,Rt,Lt,Ut,f=[].indexOf||function(e){for(var t=0,o=this.length;o>t;t++)if(t in this&&this[t]===e)return t;return-1};$("#username").keyup(function(e){var t,o;return 13===e.keyCode&&$(this).blur(),t=$(this).val(),t.length>0?(co.set_name(t),o="username"+(("undefined"!=typeof u&&null!==u?u.email:void 0)||""),localStorage[o]=t):void 0}),$(".generate-name").click(function(){return"undefined"!=typeof No&&null!==No?($("#username").val(No()),$("#username").keyup().focus()):void 0}),jQuery(".bundle .breadcrumb").live("click",function(){var e;return $(this).is(jQuery("#history .bundle .breadcrumb").first())?void 0:(e=$(this).parent().find(".readout"),e.width($("#history").width()).slideToggle("normal",function(){return e.width("auto")}))}),$(".new-room").mouseover(function(){return"undefined"!=typeof Fo&&null!==Fo?$(".new-room").attr("href",Fo()):void 0}),Ct="",Lt=function(e){return e!==Ct&&Ct&&$(".prompt_input, .guess_input, .chat_input").blur(),Ct=e,$(".actionbar").toggle(""===e),$(".chat_form").toggle("chat"===e),$(".guess_form").toggle("guess"===e),$(".prompt_form").toggle("prompt"===e),$(window).resize()},$(".chatbtn").click(function(){if(co.prefs.distraction){if($(".distraction-notice").length)return;return L("Distraction Free Mode is Enabled","Chat messages and other messages which are not necessarily important have been disabled. Disable this mode from the settings widget in order to send or receive chat messages.").addClass("alert-error distraction-notice").insertAfter(".buttonbar"),void 0}return $(".chat_input").val(""),zt()}),zt=function(e){if("@$> "===e)$(".chat_input").val(e);else if(!co.authorized(wo.mute)||co.prefs.distraction)return;return"chat"!==Ct&&(Lt("chat"),$(".chat_input").data("input_session",Math.random().toString(36).slice(3)).data("begin_time",+new Date)),$(".chat_input").keyup().focus()},Rt=[0],Mt=0,qt=function(){var e,t,o,n,i,r,a;if("localhost"===location.hostname||"_"===co.id[0]||("undefined"!=typeof protobowl_config&&null!==protobowl_config?protobowl_config.development:void 0))return!1;if(!eo())return!1;for(i=7,t=+new Date,o=[],n=!1,r=0,a=Rt.length;a>r;r++)e=Rt[r],5e3>t-e&&o.push(e);return o.length>=i&&(n=!0),Mt>t&&(n=!0),Rt=o.slice(-10),Rt.push(t),n&&(Mt=t+5e3,L("Rate Limited","You been rate limited for doing too many things in the past five seconds. ").addClass("alert-error").insertAfter(".bundle.active .annotations")),n},Ut=function(){return qt()?void 0:co.skip()},It=function(){return wo.time()>=wo.end_time&&!wo.attempt?co.next():void 0},$(".skipbtn").click(Ut),$(".nextbtn").click(It),$(".buzzbtn").click(function(){var e;if(!$(".buzzbtn").prop("disabled")&&!qt())return Lt("guess"),$(".guess_input").val("").addClass("disabled").focus(),e=+new Date,$(".sounds")[0].checked&&!$(".sounds").data("ding_sound")&&$(".sounds").data("ding_sound",new Audio("/sound/ding.wav")),co.buzz(wo.qid,function(t){if("http://www.whosawesome.com/"===t){if($(".guess_input").removeClass("disabled"),$(".sounds")[0].checked&&$(".sounds").data("ding_sound").play(),window._gaq)return _gaq.push(["_trackEvent","Game","Response Latency","Buzz Accepted",new Date-e])}else if(Lt(""),window._gaq)return _gaq.push(["_trackEvent","Game","Response Latency","Buzz Rejected",new Date-e])})}),$(".reset-score .btn").click(function(){return co.score()>50?n.confirm("Are you sure you want to reset your score?",function(e){return e?co.reset_score():void 0}):co.reset_score()}),$(".lose-command").click(function(){return co.cincinnatus()}),$(".pausebtn").click(function(){return qt()?void 0:wo.time_freeze?co.unpause():co.pause()}),$(".chat_input").keydown(function(e){var t,o;return 47!==(t=e.keyCode)&&111!==t&&191!==t||0!==$(this).val().length||e.shiftKey||e.preventDefault(),27===(o=e.keyCode)?($(".chat_input").val(""),$(".chat_form").submit()):void 0}),$("input").keydown(function(e){return e.stopPropagation(),$(this).hasClass("disabled")?e.preventDefault():void 0});try{$(".chat_input").typeahead({source:function(){return St(this.query)},matcher:function(e){return"@"===this.query[0]&&0===e.toLowerCase().indexOf(this.query.toLowerCase())}})}catch(Bt){}St=function(e){var t,o,n,i,r,a,s,u,l,c,h,d,p;a="@"+e.slice(1).split(",").slice(0,-1).join(","),t=function(){var t,o,n,i;for(n=e.slice(1).split(",").slice(0,-1),i=[],t=0,o=n.length;o>t;t++)r=n[t],i.push($.trim(r));return i}(),a.length>1&&(a+=", "),i=["individuals"],c=wo.users;for(o in c)s=c[o],h=s.name,f.call(i,h)<0&&i.push(s.name),s.team&&(d=s.team,f.call(i,d)<0)&&i.push(s.team);for(p=[],u=0,l=i.length;l>u;u++)n=i[u],f.call(t,n)<0&&p.push(""+a+n);return p},At=function(e){var t,o,n,i,r,a,s,u,l;a="@",t=!0,o={},u=wo.users;for(n in u)l=u[n],r=l.name,s=l.team,o[r]="!@"+n+", ",s||(s="individuals"),o[s]="*@"+s+", ";for(;t===!0;){t=!1,e=e.replace(/^[@\s,]*/g,"");for(r in o)if(i=o[r],e.slice(0,r.length)===r){a+=i,e=e.slice(r.length),t=!0;break}}for(r in o)if(i=o[r],e.slice(0,r.length)===r&&e.length>0){a+=i,e=e.slice(r.length);break}return[a.replace(/[\s,]*$/g,""),e]},jt=!1,Nt="",Dt="",Ft=function(e){var t,o,n;return t=0,o=Math.random().toString(36).slice(2),n=function(){return++t<=e.length?(q({text:e.slice(0,t),session:o,user:"__protobot",done:t===e.length,time:wo.serverTime()}),setTimeout(n,1e4/(80+50*Math.random()))):void 0},n()},xt=function(e,t){var o,n,i,r,a,s;return e=e.slice(0,1e3),("lobby"===(s=wo.name)||"b"===s)&&(e=e.slice(0,140)),e.length<15&&/lonely/i.test(e)&&/re |m /i.test(e)&&!/you/i.test(e)&&!jt?(jt=!0,Nt=$(".chat_input").data("input_session"),Ft("I'm lonely too. Plz talk to meeeee")):jt&&(i=function(e){return e[Math.floor(e.length*Math.random())]},t&&/stahp|stop|not lonely/i.test(e)?(Ft("Protobot disengaged. Prepare to languish in your solitude."),jt=!1):"undefined"!=typeof omeglebot_replies&&null!==omeglebot_replies&&Nt!==$(".chat_input").data("input_session")&&(e.replace(/[^a-z]/g,"")in omeglebot_replies&&Math.random()>.3?(Ft(i(omeglebot_replies[e.replace(/[^a-z]/g,"")])),Nt=$(".chat_input").data("input_session")):t&&(Math.random()<.1&&wo.active_count()>1?Ft('Looks like some other people exist. Just say "stahp" if you want me to die in a hole, or if you want to stop sounding schizophrenic.'):(a=i(Object.keys(omeglebot_replies)),a=i(omeglebot_replies[a]),Ft(a))))),"@"===e.slice(0,1)&&"@$>"!==e.slice(0,3)&&(r=At(e),"@"===r[0]?e="@"+r[1]:(n=e.trim().slice(0,e.trim().length-r[1].trim().length).trim(),n!=="@"+(co.team||"individuals")&&(Dt=n+" "),e=r.join(" "))),o=!1,$(".chat_input").data("cached_session")!==$(".chat_input").data("input_session")&&($(".chat_input").data("cached_session",$(".chat_input").data("input_session")),o=!0),co.chat({text:e,session:$(".chat_input").data("input_session"),first:o,done:t})},$(".chat_input").keyup(function(e){var t;if(13!==e.keyCode)return t=$(".chat_input").val(),$(".livechat")[0].checked&&!co.muwave&&"@"!==t.slice(0,1)?($(".chat_input").data("sent_typing",""),xt(t,!1)):$(".chat_input").data("sent_typing")!==$(".chat_input").data("input_session")?("@$>"!==t.slice(0,3)&&xt("(typing)",!1),$(".chat_input").data("sent_typing",$(".chat_input").data("input_session"))):void 0}),$(".chat_form").submit(function(e){var t;return Lt(""),xt($(".chat_input").val(),!0),e.preventDefault(),t=new Date-$(".chat_input").data("begin_time"),window._gaq?_gaq.push(["_trackEvent","Chat","Typing Time","Posted Message",t]):void 0}),$(".guess_input").keyup(function(e){return 13!==e.keyCode?co.guess({text:$(".guess_input").val().slice(0,100),done:!1}):void 0}),$(".guess_form").submit(function(e){return Lt(""),co.guess({text:$(".guess_input").val().slice(0,100),done:!0}),e.preventDefault()}),$(".prompt_input").keyup(function(e){return 13!==e.keyCode?co.guess({text:$(".prompt_input").val().slice(0,140),done:!1}):void 0}),$(".prompt_form").submit(function(e){return Lt(""),co.guess({text:$(".prompt_input").val().slice(0,140),done:!0}),e.preventDefault()}),$(".textbar-submit").click(function(){return $(this).parents("form").submit()}),Tt=!0,$("body").keyup(function(e){var t;return 83===(t=e.keyCode)?Tt=!0:void 0}),$("body").keydown(function(e){var t,o,n,i,r,a,s,u,l,c,h,d,f,p;return"chat"===Ct?$(".chat_input").focus():"guess"===Ct?$(".guess_input").focus():(50===e.keyCode&&e.shiftKey&&($(".chatbtn").click(),$(".chat_input").focus()),190===e.keyCode&&(e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)&&(e.preventDefault(),zt("@$> ")),$(document.activeElement).is(":input")||e.shiftKey||e.ctrlKey||e.metaKey?void 0:(32===e.keyCode?(e.preventDefault(),1===$(".start-page").length?$(".nextbtn").click():$(".buzzbtn").click()):83===(t=e.keyCode)?Tt&&(Tt=!1,Ut()):78===(o=e.keyCode)||74===o?It():72===(s=e.keyCode)?$("#bookmarks .pager .previous a").click():76===(u=e.keyCode)?$("#bookmarks .pager .next a").click():75===(l=e.keyCode)?$(".bundle:not(.active):first .readout").slideToggle():80===(c=e.keyCode)||82===c?$(".pausebtn").click():47===(h=e.keyCode)||111===h||191===h||67===h||65===h||13===h?(e.preventDefault(),$(".chatbtn").click()):87===(d=e.keyCode)||222===d?(e.preventDefault(),$(".chat_input").val(Dt||"@"),zt()):84===(f=e.keyCode)?(e.preventDefault(),$(".chat_input").val("@"+(co.team||"individuals")+" "),zt()):70===(p=e.keyCode)?co.finish():66===(n=e.keyCode)&&$(".bundle.active .bookmark").click(),("localhost"===location.hostname||"_"===(null!=(i=co.id)?i[0]:void 0)||"dev"in location.query)&&(68===(r=e.keyCode)?(co.buzz(wo.qid),co.guess({text:wo.answer.replace(/(\(|\[).*/,"").replace(/\{|\}/g,""),done:!0})):69===(a=e.keyCode)&&(co.buzz(wo.qid),co.guess({text:"",done:!0}))),("undefined"!=typeof protobowl_config&&null!==protobowl_config?protobowl_config.development:void 0)?console.log(e.keyCode):void 0))}),$(".speed").change(function(){var e;return $(".speed").not(this).val($(this).val()),$(".speed").data("last_update",+new Date),e=12e3/Math.round($(this).val()),+$(".speed").val()>$(".speed").prop("max")-10?co.set_speed(.1):co.set_speed(e)}),$(".categories").change(function(){return co.set_category($(".categories").val())}),$(".difficulties").change(function(){return co.set_difficulty($(".difficulties").val())}),$("#make_button").click(function(){return"__create"===$("#team_input").val()&&($("#team_input").val("Boxxy"),W()),co.set_team($("#team_input").val()),$("#team_modal").data("set_team",!0).modal("hide"),$("#team_input").blur()}),$("#team_modal").on("hidden",function(){return $("#team_modal").data("set_team")?void 0:co.set_team(co.team)}),$("#team_modal").on("shown",function(){return $("#team_input").focus()}),$("#team_modal form").submit(function(e){return e.preventDefault(),$("#make_button").click()}),$(".teams").change(function(){return"__create"===$(".teams").val()?$("#team_modal").modal("show").data("set_team",!1).find("input").val(co.team):co.set_team($(".teams").val())}),$(".multibuzz").change(function(){return co.set_max_buzz($(".multibuzz")[0].checked?null:1)}),$(".allowskip").change(function(){return co.set_skip($(".allowskip")[0].checked)}),$(".allowpause").change(function(){return co.set_pause($(".allowpause")[0].checked)}),$(".showbonus").change(function(){return co.set_bonus($(".showbonus")[0].checked)}),$(".livechat").change(function(){return co.pref("typing",$(".livechat")[0].checked)}),$(".lock").change(function(){return co.set_lock($(".lock")[0].checked)}),$(".adhd").change(function(){return co.prefs.distraction=$(".adhd")[0].checked,co.pref("distraction",co.prefs.distraction),co.prefs.distraction?($("p.annoying").removeClass("annoying").slideUp("normal",function(){return $(this).addClass("annoying")}),$("body").addClass("distraction"),co.prefs.timer_hide?void 0:setTimeout(function(){return $(".timer-widget").addClass("pulse"),setTimeout(function(){return $(".timer-widget").removeClass("pulse")},1500)},500)):($("body").removeClass("distraction"),$("p.annoying").hide().slideDown())}),$(".request-access").click(function(){return co.nominate()}),$(".movingwindow").change(function(){return $(".movingwindow")[0].checked?co.pref("movingwindow",20):co.pref("movingwindow",!1)}),$(".sounds").change(function(){return co.pref("sounds",$(".sounds")[0].checked),$(".sounds").data("ding_sound",new Audio("/sound/ding.wav"))}),Ot=function(){return window.matchMedia?matchMedia("(max-width: 768px)").matches:!1},Modernizr.touch||Ot()||($(".actionbar button").tooltip(),$(".actionbar button").click(function(){return $(".actionbar button").tooltip("hide")}),$("#history, .settings").tooltip({selector:"[rel=tooltip]",placement:function(){return Ot()?"error":"left"}})),$("body").click(function(e){return $(".bundle .ruling").tooltip("destroy"),0===$(e.target).parents(".leaderboard, .popover").length?($(".leaderboard tbody tr").popover("destroy"),$(".popover").remove()):void 0}),$(".singleuser").click(function(){var e;return e=!$(".singleuser").data("full"),$(".singleuser").data("full",e),$(".singleuser .stats .full").slideToggle(e)
}),$(".show_image").live("click",function(e){return e.preventDefault(),$(this).parent().find(".chat_image").slideToggle()}),$(".username").live("click",function(e){var t;t=wo.users[$(this).data("id")],t&&(e.shiftKey||e.ctrlKey||e.metaKey)&&(e.preventDefault(),"chat"===Ct&&"@"===$(".chat_input").val()[0]?-1===$(".chat_input").val().indexOf(t.name)&&$(".chat_input").val($(".chat_input").val().replace("@","@"+t.name+", ")):$(".chat_input").val("@"+t.name+" "),zt())}),$(".banhammer.make-tribunal").live("click",function(e){return e.preventDefault(),co.trigger_tribunal($(this).data("id"))}),$(".banhammer.instaban").live("click",function(e){return e.preventDefault(),co.ban_user($(this).data("id"))}),$(".banhammer.reprimand").live("click",function(e){return e.preventDefault(),co.reprimand({user:$(this).data("id"),reason:$(this).parents(".banham").data("reason")}),wo.users[$(this).data("id")].__reprimanded=Date.now(),setTimeout(function(){return Y()},15e3)}),$(".timer-widget").click(function(){return co.prefs.timer_hide=!$(".timer-widget").data("hidden"),yt(),co.pref("timer_hide",co.prefs.timer_hide)}),$(".leaderboard tbody tr").live("click",function(e){var t,o,n,i;return $(this).is(".ellipsis")?(co.prefs.leaderboard=!co.prefs.leaderboard,co.pref("leaderboard",co.prefs.leaderboard),gt(),void 0):(n=$(this).data("entity"),e.shiftKey||e.ctrlKey||e.metaKey?(e.preventDefault(),"chat"===Ct&&"@"===$(".chat_input").val()[0]?-1===$(".chat_input").val().indexOf(n.name)&&$(".chat_input").val($(".chat_input").val().replace("@","@"+n.name+", ")):$(".chat_input").val("@"+n.name+" "),zt(),void 0):(o=null!=(i=$(this).data("popover"))?i.enabled:void 0,t=$(".leaderboard tbody tr").map(function(){var e;return null!=(e=$(this).data("popover"))?e.$tip[0]:void 0}),$(".popover").not(t).fadeOut("fast",function(){return $(this).remove()}),$(".leaderboard tbody tr").popover("destroy"),o?void 0:($(this).popover({placement:Ot()?"top":"left",trigger:"manual",title:""+n.name,content:function(){return et(n,!0)}}),$(this).popover("toggle"))))}),Modernizr.touch?($(".show-keyboard").hide(),$(".show-touch").show()):($(".show-keyboard").show(),$(".show-touch").hide()),$(".show-sidebar").click(function(e){return $(".sidebar").toggleClass("shown"),$(".sidebar").hasClass("shown")?($(".show-sidebar i").removeClass("icon-circle-arrow-right"),$(".show-sidebar i").addClass("icon-circle-arrow-left")):($(".show-sidebar i").removeClass("icon-circle-arrow-left"),$(".show-sidebar i").addClass("icon-circle-arrow-right")),e.preventDefault()}),$("body").live("swiperight",function(){return $(".sidebar").addClass("shown")}),$("body").live("swipeleft",function(){return $(".sidebar").removeClass("shown")});var Ht,Pt,Wt,Yt,Gt,Kt,Qt,Jt,Vt,Xt,Zt,eo,to,oo,no,ao,ro,so,uo,lo,ho,co,fo,po,mo,yo,go,wo,bo,vo,ko,_o,$o,Eo,Co,f=[].indexOf||function(e){for(var t=0,o=this.length;o>t;t++)if(t in this&&this[t]===e)return t;return-1},xo={}.hasOwnProperty,Ao=function(e,t){function o(){this.constructor=e}for(var n in t)xo.call(t,n)&&(e[n]=t[n]);return o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype,e},r=[].slice;!function(){return"anachron"in location.query?window.WebSocket=function(){return 0}:void 0}(),function(){var e,t,o,n;try{o=new Date(protobowl_app_build),$("#version").text(""+(o.getMonth()+1)+"/"+o.getDate()+"/"+o.getFullYear()%100+" "+o.getHours()+":"+(o.getMinutes()/100).toFixed(2).slice(2))}catch(i){}try{return t=new Date(protobowl_app_build),e=new Date(protobowl_html_build),n=Math.abs(t-e)}catch(i){}}(),so=function(e){var t;return null==e&&(e=function(){}),so.initialized?e():(so.initialized=!0,t=(("undefined"!=typeof protobowl_config&&null!==protobowl_config?protobowl_config["static"]:void 0)||"/")+"offline.js",("undefined"!=typeof protobowl_config&&null!==protobowl_config?protobowl_config.cache_breaker:void 0)&&(t+="?"+(new Date(protobowl_html_build)-0)),$.ajax({url:t,cache:!0,dataType:"script",success:e}))},fo=function(){return so(function(){var e,t,o,n,i,r;if(e="offline",localStorage.hasOwnProperty("room-"+wo.name))try{t=JSON.parse(localStorage["room-"+wo.name]),"temporary"!==t.me_id?(e=t.me_id,wo.deserialize(t)):t=null}catch(a){}if(co.__listeners.joined({id:e,name:"offline user"}),null!=t?t.users:void 0)try{for(r=t.users,n=0,i=r.length;i>n;n++)o=r[n],o.id===e&&co.deserialize(o)}catch(a){}return wo.sync(5),co.verb("joined the room"),"undefined"!=typeof wn&&null!==wn?wn():void 0})},setTimeout(function(){return wo.active_count()<=1&&Math.random()<.001?q({text:'Feeling lonely? Just say "I\'m Lonely" and talk to me!',user:"__protobot",done:!0}):void 0},3e4),setTimeout(function(){return navigator.onLine?H():void 0},6e5),setTimeout(function(){return navigator.onLine?P():void 0},3e5),ro=function(){var e;return e=$("<div>").addClass("alert alert-info"),e.append($("<div>").append("A  ",$('<span class="label label-info">').text("server restart")," will happen momentarily. This may result in a message indicating that you have been disconnected from the server. However, don't panic as a new connection will automatically be established shortly afterwards. ")),j($("<div>").addClass("log doom-notice").append(e))},oo=function(){var e,t;return"undefined"!=typeof wn&&null!==wn&&wn(),$("#reload, #disconnect, #reconnect").hide(),$("#reconnect").show(),(null!=(t=wo.attempt)?t.user:void 0)!==co.id&&(wo.attempt=null),e=$("<div>").addClass("alert alert-error"),e.append($("<p>").append("You were ",$('<span class="label label-important">').text("disconnected")," from the server for some reason. ",$("<em>").text(new Date))),e.append($("<div>").append("This may be due to a drop in the network 			connectivity or a malfunction in the server. The client will automatically 			attempt to reconnect to the server and in the mean time, the app has automatically transitioned			into <b>offline mode</b>. You can continue playing alone with a limited offline set			of questions without interruption. However, you might want to try <a href=''>reloading</a>.")),j($("<div>").addClass("log disconnect-notice").append(e)),$.getJSON("https://api.github.com/gists/4272390?callback=?",function(e){var t,o,n,i,r,a;return t=e.data,n=e.meta,"Nothing"!==(i=null!=t?null!=(r=t.files)?null!=(a=r["protobowl-status.html"])?a.content:void 0:void 0:void 0)&&null!==i?(o=$("<div>").addClass("emergency-message"),o.append($("<div>").addClass("alert alert-info").html(t.files["protobowl-status.html"].content)),$(".emergency-message").remove(),$("#history").before(o)):void 0}),gt(),mt()},ao=!1,vo=null,ko=0,to=null,po=function(){var e,t,o,n,i,r,a,s,u,l,c,h,d,p;n=5e3,d="undefined"!=typeof protobowl_config&&null!==protobowl_config?protobowl_config.sockets[ko]:void 0,l=null,r=null,a=d[0],c=d[1],"sock"in location.query&&(a=location.query.sock),u=function(){var e,t,o,n,i,r,a,s;i=null;try{i=localStorage.protocookie}catch(u){}if(t=location.query.id||jQuery.cookie("protocookie")||i,e=null,("undefined"!=typeof protobowl_config&&null!==protobowl_config?protobowl_config.auth:void 0)&&(e=jQuery.cookie("protoauth")),"ninja"in location.query&&(a=new XMLHttpRequest,a.open("get",protobowl_config.sockets[0][0]+"stalkermode/ninjacode",!1),a.send(),e=a.responseText),!t){o="",t="PB4CL"+function(){var e,t;for(t=[],n=e=0;8>=e;n=++e)t.push(Math.random().toString(36).slice(2,6));return t}().join(""),jQuery.cookie("protocookie",t);try{localStorage.protocookie=t}catch(u){}}try{r=JSON.parse(localStorage.referrers||"[]")||[],document.referrer&&(s=document.referrer,f.call(r,s)<0)&&r.push(document.referrer),localStorage.referrers=JSON.stringify(r)}catch(u){}return vo.emit("join",{cookie:t,auth:e,question_type:wo.type,room_name:wo.name,muwave:"muwave"in location.query,custom_id:location.query.id,agent:"M4/Web",agent_version:""+protobowl_app_build,referrers:r,version:8}),$(".disconnect-notice, .doom-notice").slideUp(),$("#reload, #disconnect, #reconnect").hide(),$("#disconnect").show()},h=function(e){var t,o,n;vo&&vo!==e&&vo.disconnect(),vo&&vo.removeAllListeners(),vo=e,vo===l?(Q({verb:"established a connection to the secure server"}),to=c):(to=a,vo.socket.options.secure?Q({verb:"established a connection to the server (secure)"}):Q({verb:"established a connection to the server"})),vo.on("disconnect",function(){return(null!=vo?vo.hide_disconnect:void 0)?void 0:oo()}),n=co.__listeners;for(o in n)t=n[o],vo.on(o,t);return u()},e=function(e){return $("#load_error").remove(),vo?vo===e?u():setTimeout(function(){return vo.socket.connected===!0?(e.disconnect(),e.removeAllListeners()):h(e)},2718):h(e)},t=function(e){return e.socket.transport||console.log("ran out of options sir"),console.log("connect fail",e)},p=0,s=0,o=function(){var e;return s++,s===p?("undefined"!=typeof protobowl_config&&null!==protobowl_config?null!=(e=protobowl_config.sockets)?e.length:void 0:void 0)>ko+1?(ko++,po()):(console.log("errythings failed capn"),fo()):void 0};try{p++,r=io.connect(a||location.hostname,{"connect timeout":n,"force new connection":!0}),r.on("connect",function(){return e(r)}),r.on("connect_failed",function(){return t(r)}),r.on("error",o)}catch(m){i=m,o()}if("http:"===location.protocol&&c)try{return p++,l=io.connect(c,{port:443,"connect timeout":n,"force new connection":!0,secure:!0}),l.on("connect",function(){return e(l)}),l.on("connect_failed",function(){return t(l)}),l.on("error",o)}catch(m){return i=m,o()}},eo=function(){return null!=vo&&vo.socket.connected},Gt=function(e){function t(){return Co=t.__super__.constructor.apply(this,arguments)}return Ao(t,e),t.prototype.online=function(){return this.online_state},t.prototype.emit=function(){var e;return e=1<=arguments.length?r.call(arguments,0):[],this.id===co.id?co.emit.apply(co,e):void 0},t}(d),Kt=function(e){function t(e,o){var n,i,r;t.__super__.constructor.call(this,e,o),this.__listeners={},n=["envelop_action","level","score","metrics","online","active","authorized","emit","pref"];for(r in this)i=this[r],"function"==typeof i&&(f.call(n,r)<0?this[r]=this.envelop_action(r):this["remote_"+r]=this.envelop_action(r))}return Ao(t,e),t.prototype.emit=function(e,t){return"undefined"!=typeof tn&&null!==tn&&tn()?en(e,t):this.__listeners[e](t)},t.prototype.authorized=function(e){return eo()?t.__super__.authorized.call(this,e):!0},t.prototype.envelop_action=function(e){return function(t,o){var n;return eo()?vo.emit(e,t,o):"undefined"!=typeof tn&&null!==tn&&tn()?on(e,t,o):null!=(n=wo.users[co.id])?"function"==typeof n[e]?n[e](t,o):void 0:void 0}},t.prototype.pref=function(e,t){return this.prefs[e]=t,this.id===co.id&&(co.prefs[e]=t),this.remote_pref(e,t)},t}(Gt),Qt=function(e){function t(e){t.__super__.constructor.call(this,e)}return Ao(t,e),t.prototype.emit=function(){var e;return e=1<=arguments.length?r.call(arguments,0):[],co.emit.apply(co,e)},t.prototype.load_questions=function(e){var t=this;return"undefined"!=typeof bn&&null!==bn?bn(e):setTimeout(function(){return t.load_questions(e)},100)},t.prototype.check_answer=function(e,t,o){return checkAnswer(e,t,o)},t.prototype.get_parameters=function(e,t,o){return this.load_questions(function(){return ln(e,t,o)})},t.prototype.count_questions=function(e,t,o,n){return this.load_questions(function(){return Xo(e,t,o,n)})},t.prototype.get_question=function(e){var t=this;return this.load_questions(function(){var o;return o="custom"===t.category?t.distribution:t.category,hn(t.type,t.difficulty,o,function(t){return e(t||y)})})},t.prototype.deserialize=function(e){var t,o,n,i;o=["users","attempt","generating_question","acl"],i=[];for(t in e)n=e[t],f.call(o,t)<0&&i.push(this[t]=n);return i},t}(p),wo=new Qt(location.pathname.replace(/^\/*/g,"").toLowerCase()||"temporary"),wo.type=2===wo.name.split("/").length?wo.name.split("/")[0]:"qb",co=new Kt(wo,"temporary"),function(){var e;return document.title=""+wo.name+" - Protobowl",e={qb:"Quizbowl",jeopardy:"Jeopardy!",scibowl:"Science Bowl"},wo.name.split("/").length>1?$("<span>").addClass("label label-info").text(e[wo.type]||wo.type.toTitleCase()).insertAfter(".logo").after(" "):void 0}(),ho=function(e,t){return co.__listeners[e]=t},ho("echo",function(e,t){return t("alive")}),ho("application_update",function(){return"function"==typeof Ko?Ko():void 0}),ho("force_application_update",function(){return"function"==typeof Ko?Ko():void 0}),ho("impending_doom",function(){return ro()}),ho("redirect",function(e){return wo._redirected=!0,window.location=e}),ho("alert",function(e){return window.alert(e)}),ho("chat",function(e){return q(e)}),ho("log",function(e){return Q(e)}),ho("bold",function(e){return F(e)}),ho("reprimand",function(e){return G(e)}),ho("debug",function(e){return B(e)}),ho("sync",function(e){return $o(e)}),ho("rtc",function(e){var t,o;return t=e.message,o=e.source,O(o,t)}),ho("throttle",function(){return L("Throttled","The server is ignoring you for a while because you've been doing too many things too quickly. ").addClass("alert-error").insertAfter(".bundle.active .annotations")}),ho("verify",function(e){return"function"==typeof h?h(e):void 0}),ho("rename_user",function(e){var t,o;return o=e.old_id,t=e.new_id,co.id===o&&(co.id=t,wo.users[co.id]=wo.users[o]),$(".user-"+o).removeClass("user-"+o).addClass("user-"+t),delete wo.users[o]}),ho("delete_user",function(e){return delete wo.users[e],gt()}),ho("joined",function(e){var t;if("undefined"!=typeof s&&null!==s&&s&&co.link(s),ao=!0,$("#slow").slideUp(),$(".disconnect-notice").slideUp(),co.id=e.id,co.ip=e.ip,"function"==typeof a&&a(e.ip),wo.users[co.id]=new Gt(wo,co.id),co.name=e.name,"_"!==co.id[0]&&"temporary"!==co.id){t="username"+(("undefined"!=typeof u&&null!==u?u.email:void 0)||"");try{localStorage[t]?e.existing||setTimeout(function(){return co.name=localStorage[t],co.set_name(co.name),$("#username").val(co.name)},137):localStorage[t]=e.name}catch(o){}}return e.muwave&&e.muwave<=34&&(window.WebSocket||$(".no-websocket").show(),$("#polling").slideDown()),$(".actionbar button").disable(!1),$("#username").val(co.name),$("#username").disable(!1),setTimeout(so,100)}),_o=[],lo=[],uo=-1,$o=function(e){var t,o,n,i,r,a,s,u,l,c,h,d,p,m,y,g;o=["real_time","users"],_o.push(+new Date-e.real_time),Zt(),"realm"in e&&e.realm&&f.call(e.realm,to)<0&&(null!=(p=e.realm)?p.join(";"):void 0)!==(null!=(m=wo.realm)?m.join(";"):void 0)&&j($("<div>").html("<strong>Warning</strong> You are currently connected to a server which is not registered as this room's proper realm.").addClass("alert"));for(t in e)l=e[t],f.call(o,t)<0&&(wo[t]=l);if(eo()&&("timing"in e||wo.__last_rate!==wo.rate)&&(n=function(e,t){var o,n,i,r,a,s;for(n=0,a=[5].concat(e).slice(0,-1),s=[],i=0,r=a.length;r>i;i++)o=a[i],s.push(n+=Math.round(o*t));return s},wo.cumulative=n(wo.timing,wo.rate),wo.__last_rate=wo.rate),"users"in e)for(u=["id"],y=e.users,h=0,d=y.length;d>h;h++){s=y[h],s.id in wo.users||(wo.users[s.id]=new Gt(wo,s.id));for(t in s)l=s[t],f.call(u,t)<0&&(wo.users[s.id][t]=l);if(s.id===co.id)for(t in s)l=s[t],f.call(u,t)<0&&(co[t]=l)}if($("body").toggleClass("offline",!eo()),"difficulties"in e&&ft(),yt(),pt(),Y(),uo!==wo.time_freeze){for(uo=wo.time_freeze,c=wo.attempt?"starts":"stops",i=wo.time_freeze-wo.begin_time,r=0;i>wo.cumulative[r];)r++;a=$(".bundle.active").data(c)||[],g=r-1,f.call(a,g)<0&&a.push(r-1),$(".bundle.active").data(c,a),kt()}return"users"in e?gt():void 0},ho("finish_question",function(e){var t,o;for(t=e-wo.begin_time,o=0;t>wo.cumulative[o];)o++;return $(".bundle.active").data("finish_point",o-1),kt()}),Ht=function(e){return Vt(e)/e.length},Vt=function(e){var t,o,n,i;for(o=0,n=0,i=e.length;i>n;n++)t=e[n],o+=t;return o},Jt=function(e){var t,o;return o=Ht(e),Math.sqrt(Ht(function(){var n,i,r;for(r=[],n=0,i=e.length;i>n;n++)t=e[n],r.push((t-o)*(t-o));return r}()))},Yt=function(e){var t;return t=e.sort(function(e,t){return e-t}),t[Math.floor(t.length/2)]||0},Pt=function(e){var t;return t=e.sort(function(e,t){return e-t}),t[~~(.75*t.length)]-t[~~(.25*t.length)]||0},Wt=function(e){var t,o;return o=e.sort(function(e,t){return e-t}),Yt(function(){var e,n,i;for(i=[],e=0,n=o.length;n>e;e++)t=o[e],i.push(Math.abs(t-mu));return i}())},Zt=function(){var e,t,o,n;return _o=_o.slice(-20),n=Ht(_o),e=function(){var e,o,i;for(i=[],e=0,o=_o.length;o>e;e++)t=_o[e],n>=t&&i.push(t);return i}(),o=Ht(e),n=Ht(e),e=function(){var e,o,i;for(i=[],e=0,o=_o.length;o>e;e++)t=_o[e],n>=t&&i.push(t);return i}(),wo.sync_offset=Ht(e),$("#sync_offset").text(wo.sync_offset.toFixed(1)+"±"+Jt(e).toFixed(1)+" ("+_o.length+")")},$(window).unload(function(){var e;return wo._redirected?delete localStorage["room-"+wo.name]:(e=wo.serialize(),e.me_id=co.id,e.archive_time=Date.now(),localStorage["room-"+wo.name]=JSON.stringify(e))}),mo=Date.now(),Eo=function(){var e,t;if(eo())return e=36e5,wo.serverTime()-co.last_action>e&&Date.now()-mo>e&&(vo.disconnect(),n.dialog("<h4>Disconnected for Inactivity</h4> <p>You have been disconnected from the server for an extended period of inactivity.</p> <p>Simply press <span class='label label-info'>Reconnect</span> if you wish to reestablish a connection to the server to resume from the previous state, or press <span class='label'>Cancel</span> if you would like to continue using protobowl offline.</p> ",[{label:"Cancel"},{label:"Reconnect","class":"btn-primary",callback:function(){return vo.socket.reconnect(),mo=Date.now()}}])),t=+new Date,vo.emit("echo",{},function(e){var o,n;return n=+new Date,o=n-t,lo.push(o),_o.push(n-e),vo.emit("echo",{avg:Ht(lo.slice(-10)),std:Jt(lo.slice(-10)),n:lo.length},function(t){var o,i,r;return r=+new Date,o=r-n,i=t-e,_o.push(r-t),lo.push(i),lo.push(o),Zt(),lo.length>0?$("#latency").text(Ht(lo).toFixed(1)+"±"+Jt(lo).toFixed(1)+(" ("+lo.length+")")):void 0})})},setTimeout(function(){var e;return e=function(){var t;return Eo(),t=3e4,co.muwave&&(t=18e4),setTimeout(e,t)},e()},8e3),go=[],no=function(e,t){return go.push([e,t]),"function"==typeof Zo?Zo():void 0},bo=function(e,t){return console.log("setting book",e,t),no(e,function(o){return o?(o.bookmarked=t,o.modified=Date.now(),Ho.put(o,function(){return Xt(e),"function"==typeof Tn?Tn():void 0},cn)):console.log("question not found (set bookmark)",e)})},Xt=function(e){return no(e,function(t){var o,n;return t?(o=t.bookmarked,n=$(".qid-"+e).toggleClass("bookmarked",!!o).toggleClass("bookmark-2",2===o).toggleClass("bookmark-3",3===o).toggleClass("bookmark-4",o>=4),n.find(".bookmark").toggleClass("icon-star-empty",!o).toggleClass("icon-star",!!o)):void 0})},yo=function(e,t){var o;return null==t&&(t={}),o=document.getElementById("_"+e),o||(o=$("<div>").attr("id","_"+e)),$(o).empty().append(jade[e](t))},function(){var e,t;return null!=document.hidden?(t="hidden",e="visibilitychange"):null!=document.mozHidden?(t="mozHidden",e="mozvisibilitychange"):null!=document.msHidden?(t="msHidden",e="msvisibilitychange"):null!=document.webkitHidden&&(t="webkitHidden",e="webkitvisibilitychange"),t?document.addEventListener(e,function(){return co.muwave?void 0:co.set_idle(document[t])},!1):void 0}(),"onLine"in navigator&&navigator.onLine===!1||"undefined"==typeof io||null===io||("undefined"!=typeof protobowl_config&&null!==protobowl_config?protobowl_config.offline:void 0)?fo():(po(),setTimeout(function(){return ao?void 0:$("#slow").slideDown()},3e3),setTimeout(so,2e3)),$("#load_error").remove(),$("#disconnect").click(function(e){return vo.disconnect(),e.preventDefault()}),$("#reconnect").click(function(e){return vo.socket.reconnect(),e.preventDefault()});